"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/reagraph";
exports.ids = ["vendor-chunks/reagraph"];
exports.modules = {

/***/ "(ssr)/./node_modules/reagraph/dist/index.js":
/*!*********************************************!*\
  !*** ./node_modules/reagraph/dist/index.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Arrow: () => (/* binding */ Arrow),\n/* harmony export */   CameraControls: () => (/* binding */ CameraControls),\n/* harmony export */   CameraControlsContext: () => (/* binding */ CameraControlsContext),\n/* harmony export */   Cluster: () => (/* binding */ Cluster),\n/* harmony export */   Edge: () => (/* binding */ Edge$1),\n/* harmony export */   Edges: () => (/* binding */ Edges),\n/* harmony export */   FORCE_LAYOUTS: () => (/* binding */ FORCE_LAYOUTS),\n/* harmony export */   GraphCanvas: () => (/* binding */ GraphCanvas),\n/* harmony export */   GraphScene: () => (/* binding */ GraphScene),\n/* harmony export */   Icon: () => (/* binding */ Icon),\n/* harmony export */   Label: () => (/* binding */ Label),\n/* harmony export */   Lasso: () => (/* binding */ Lasso),\n/* harmony export */   Line: () => (/* binding */ Line),\n/* harmony export */   Node: () => (/* binding */ Node),\n/* harmony export */   RadialMenu: () => (/* binding */ RadialMenu),\n/* harmony export */   RadialSlice: () => (/* binding */ RadialSlice),\n/* harmony export */   Ring: () => (/* binding */ Ring$1),\n/* harmony export */   Sphere: () => (/* binding */ Sphere),\n/* harmony export */   SphereWithIcon: () => (/* binding */ SphereWithIcon),\n/* harmony export */   SphereWithSvg: () => (/* binding */ SphereWithSvg),\n/* harmony export */   Svg: () => (/* binding */ Svg),\n/* harmony export */   animationConfig: () => (/* binding */ animationConfig),\n/* harmony export */   attributeSizing: () => (/* binding */ attributeSizing),\n/* harmony export */   buildClusterGroups: () => (/* binding */ buildClusterGroups),\n/* harmony export */   buildGraph: () => (/* binding */ buildGraph),\n/* harmony export */   buildNodeEdges: () => (/* binding */ buildNodeEdges),\n/* harmony export */   calcLabelVisibility: () => (/* binding */ calcLabelVisibility),\n/* harmony export */   calculateClusters: () => (/* binding */ calculateClusters),\n/* harmony export */   calculateEdgeCurveOffset: () => (/* binding */ calculateEdgeCurveOffset),\n/* harmony export */   centralitySizing: () => (/* binding */ centralitySizing),\n/* harmony export */   circular2d: () => (/* binding */ circular2d),\n/* harmony export */   createElement: () => (/* binding */ createElement),\n/* harmony export */   custom: () => (/* binding */ custom),\n/* harmony export */   darkTheme: () => (/* binding */ darkTheme),\n/* harmony export */   findPath: () => (/* binding */ findPath),\n/* harmony export */   forceAtlas2: () => (/* binding */ forceAtlas2),\n/* harmony export */   forceDirected: () => (/* binding */ forceDirected),\n/* harmony export */   forceRadial: () => (/* binding */ forceRadial),\n/* harmony export */   getAdjacents: () => (/* binding */ getAdjacents),\n/* harmony export */   getArrowSize: () => (/* binding */ getArrowSize),\n/* harmony export */   getArrowVectors: () => (/* binding */ getArrowVectors),\n/* harmony export */   getClosestAxis: () => (/* binding */ getClosestAxis),\n/* harmony export */   getCurve: () => (/* binding */ getCurve),\n/* harmony export */   getCurvePoints: () => (/* binding */ getCurvePoints),\n/* harmony export */   getDegreesToClosest2dAxis: () => (/* binding */ getDegreesToClosest2dAxis),\n/* harmony export */   getExpandPath: () => (/* binding */ getExpandPath),\n/* harmony export */   getLabelOffsetByType: () => (/* binding */ getLabelOffsetByType),\n/* harmony export */   getLayoutCenter: () => (/* binding */ getLayoutCenter),\n/* harmony export */   getMidPoint: () => (/* binding */ getMidPoint),\n/* harmony export */   getNodeDepth: () => (/* binding */ getNodeDepth),\n/* harmony export */   getVector: () => (/* binding */ getVector),\n/* harmony export */   getVisibleEntities: () => (/* binding */ getVisibleEntities),\n/* harmony export */   isNodeInView: () => (/* binding */ isNodeInView),\n/* harmony export */   layoutProvider: () => (/* binding */ layoutProvider),\n/* harmony export */   lightTheme: () => (/* binding */ lightTheme),\n/* harmony export */   nodeSizeProvider: () => (/* binding */ nodeSizeProvider),\n/* harmony export */   nooverlap: () => (/* binding */ nooverlap),\n/* harmony export */   pageRankSizing: () => (/* binding */ pageRankSizing),\n/* harmony export */   prepareRay: () => (/* binding */ prepareRay),\n/* harmony export */   recommendLayout: () => (/* binding */ recommendLayout),\n/* harmony export */   tick: () => (/* binding */ tick),\n/* harmony export */   transformGraph: () => (/* binding */ transformGraph),\n/* harmony export */   updateNodePosition: () => (/* binding */ updateNodePosition),\n/* harmony export */   useCameraControls: () => (/* binding */ useCameraControls),\n/* harmony export */   useCenterGraph: () => (/* binding */ useCenterGraph),\n/* harmony export */   useCollapse: () => (/* binding */ useCollapse),\n/* harmony export */   useDrag: () => (/* binding */ useDrag),\n/* harmony export */   useGraph: () => (/* binding */ useGraph),\n/* harmony export */   useHoverIntent: () => (/* binding */ useHoverIntent),\n/* harmony export */   useSelection: () => (/* binding */ useSelection)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/index-27578f8f.esm.js\");\n/* harmony import */ var _react_three_fiber__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! @react-three/fiber */ \"(ssr)/./node_modules/@react-three/fiber/dist/react-three-fiber.esm.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/radial.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/simulation.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/x.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/y.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/collide.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/manyBody.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/link.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/center.js\");\n/* harmony import */ var d3_force_3d__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! d3-force-3d */ \"(ssr)/./node_modules/d3-force-3d/src/z.js\");\n/* harmony import */ var d3_hierarchy__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! d3-hierarchy */ \"(ssr)/./node_modules/d3-hierarchy/src/treemap/index.js\");\n/* harmony import */ var d3_hierarchy__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! d3-hierarchy */ \"(ssr)/./node_modules/d3-hierarchy/src/hierarchy/index.js\");\n/* harmony import */ var d3_hierarchy__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! d3-hierarchy */ \"(ssr)/./node_modules/d3-hierarchy/src/stratify.js\");\n/* harmony import */ var d3_hierarchy__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! d3-hierarchy */ \"(ssr)/./node_modules/d3-hierarchy/src/tree.js\");\n/* harmony import */ var graphology_layout_circular_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! graphology-layout/circular.js */ \"(ssr)/./node_modules/graphology-layout/circular.js\");\n/* harmony import */ var graphology_layout_noverlap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! graphology-layout-noverlap */ \"(ssr)/./node_modules/graphology-layout-noverlap/index.js\");\n/* harmony import */ var graphology_layout_forceatlas2__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! graphology-layout-forceatlas2 */ \"(ssr)/./node_modules/graphology-layout-forceatlas2/index.js\");\n/* harmony import */ var graphology_layout_random_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! graphology-layout/random.js */ \"(ssr)/./node_modules/graphology-layout/random.js\");\n/* harmony import */ var graphology_metrics_centrality_pagerank_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! graphology-metrics/centrality/pagerank.js */ \"(ssr)/./node_modules/graphology-metrics/centrality/pagerank.js\");\n/* harmony import */ var graphology_metrics_centrality_degree_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! graphology-metrics/centrality/degree.js */ \"(ssr)/./node_modules/graphology-metrics/centrality/degree.js\");\n/* harmony import */ var d3_scale__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! d3-scale */ \"(ssr)/./node_modules/d3-scale/src/linear.js\");\n/* harmony import */ var zustand__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! zustand */ \"(ssr)/./node_modules/zustand/esm/index.mjs\");\n/* harmony import */ var zustand_context__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! zustand/context */ \"(ssr)/./node_modules/zustand/esm/context.mjs\");\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! three */ \"(ssr)/./node_modules/three/build/three.module.js\");\n/* harmony import */ var _use_gesture_react__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! @use-gesture/react */ \"(ssr)/./node_modules/@use-gesture/react/dist/use-gesture-react.esm.js\");\n/* harmony import */ var graphology_shortest_path__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! graphology-shortest-path */ \"(ssr)/./node_modules/graphology-shortest-path/index.js\");\n/* harmony import */ var graphology__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! graphology */ \"(ssr)/./node_modules/graphology/dist/graphology.esm.js\");\n/* harmony import */ var glodrei__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! glodrei */ \"(ssr)/./node_modules/glodrei/core/Billboard.js\");\n/* harmony import */ var glodrei__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! glodrei */ \"(ssr)/./node_modules/glodrei/core/Text.js\");\n/* harmony import */ var glodrei__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! glodrei */ \"(ssr)/./node_modules/glodrei/core/Svg.js\");\n/* harmony import */ var glodrei__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! glodrei */ \"(ssr)/./node_modules/glodrei/web/useCursor.js\");\n/* harmony import */ var glodrei__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! glodrei */ \"(ssr)/./node_modules/glodrei/web/Html.js\");\n/* harmony import */ var ellipsize__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ellipsize */ \"(ssr)/./node_modules/ellipsize/src/index.js\");\n/* harmony import */ var _react_spring_three__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @react-spring/three */ \"(ssr)/./node_modules/@react-spring/three/dist/react-spring-three.esm.js\");\n/* harmony import */ var camera_controls__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! camera-controls */ \"(ssr)/./node_modules/camera-controls/dist/camera-controls.module.js\");\n/* harmony import */ var reakeys__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! reakeys */ \"(ssr)/./node_modules/reakeys/dist/index.js\");\n/* harmony import */ var hold_event__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! hold-event */ \"(ssr)/./node_modules/hold-event/dist/hold-event.module.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/utils/BufferGeometryUtils.js\");\n/* harmony import */ var three_stdlib__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! three-stdlib */ \"(ssr)/./node_modules/three-stdlib/interactive/SelectionBox.js\");\n/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! classnames */ \"(ssr)/./node_modules/classnames/index.js\");\n(function() {\n  \"use strict\";\n  try {\n    if (typeof document != \"undefined\") {\n      var elementStyle = document.createElement(\"style\");\n      elementStyle.appendChild(document.createTextNode(\"._canvas_670zp_1 {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n._container_155l7_1 {\\n  transform-origin: bottom right;\\n  overflow: hidden;\\n  position: absolute;\\n  border: solid 1px var(--radial-menu-border);\\n}\\n\\n  ._container_155l7_1._disabled_155l7_7 {\\n    opacity: 0.6;\\n  }\\n\\n  ._container_155l7_1._disabled_155l7_7 ._contentContainer_155l7_10 {\\n      cursor: not-allowed;\\n    }\\n\\n  ._container_155l7_1:not(._disabled_155l7_7) ._contentContainer_155l7_10 {\\n      cursor: pointer;\\n    }\\n\\n  ._container_155l7_1:not(._disabled_155l7_7) ._contentContainer_155l7_10:hover {\\n        color: var(--radial-menu-active-color);\\n        background: var(--radial-menu-active-background);\\n      }\\n\\n  ._container_155l7_1 ._contentContainer_155l7_10 {\\n    width: 200%;\\n    height: 200%;\\n    transform-origin: 50% 50%;\\n    border-radius: 50%;\\n    outline: none;\\n    transition: background 150ms ease-in-out;\\n    color: var(--radial-menu-color);\\n  }\\n\\n  ._container_155l7_1 ._contentContainer_155l7_10 ._contentInner_155l7_35 {\\n      position: absolute;\\n      width: 100%;\\n      text-align: center;\\n    }\\n\\n  ._container_155l7_1 ._contentContainer_155l7_10 ._contentInner_155l7_35 ._content_155l7_10 {\\n        display: inline-block;\\n      }\\n\\n  ._container_155l7_1 svg {\\n    margin: 0 auto;\\n    fill: var(--radial-menu-active-color);\\n    height: 25px;\\n    width: 25px;\\n    display: block;\\n  }\\n._container_x9hyx_1 {\\n  border-radius: 50%;\\n  z-index: 9;\\n  position: relative;\\n  height: 175px;\\n  width: 175px;\\n  border: solid 5px var(--radial-menu-border);\\n  overflow: hidden;\\n  background: var(--radial-menu-background);\\n}\\n\\n  ._container_x9hyx_1:before {\\n    content: ' ';\\n    background: var(--radial-menu-border);\\n    border-radius: 50%;\\n    height: 25px;\\n    width: 25px;\\n    position: absolute;\\n    z-index: 9;\\n    top: 50%;\\n    left: 50%;\\n    transform: translate(-50%, -50%);\\n  }\"));\n      document.head.appendChild(elementStyle);\n    }\n  } catch (e) {\n    console.error(\"vite-plugin-css-injected-by-js\", e);\n  }\n})();\nvar _a, _b;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction traverseGraph(nodes, nodeStack = []) {\n  const currentDepth = nodeStack.length;\n  for (const node of nodes) {\n    const idx = nodeStack.indexOf(node);\n    if (idx > -1) {\n      const loop = [...nodeStack.slice(idx), node].map((d) => d.data.id);\n      throw new Error(\n        `Invalid Graph: Circular node path detected: ${loop.join(\" -> \")}.`\n      );\n    }\n    if (currentDepth > node.depth) {\n      node.depth = currentDepth;\n      traverseGraph(node.out, [...nodeStack, node]);\n    }\n  }\n}\nfunction getNodeDepth(nodes, links) {\n  let invalid = false;\n  const graph = nodes.reduce(\n    (acc, cur) => ({\n      ...acc,\n      [cur.id]: {\n        data: cur,\n        out: [],\n        depth: -1,\n        ins: []\n      }\n    }),\n    {}\n  );\n  try {\n    for (const link of links) {\n      const from = link.source;\n      const to = link.target;\n      if (!graph.hasOwnProperty(from)) {\n        throw new Error(`Missing source Node ${from}`);\n      }\n      if (!graph.hasOwnProperty(to)) {\n        throw new Error(`Missing target Node ${to}`);\n      }\n      const sourceNode = graph[from];\n      const targetNode = graph[to];\n      targetNode.ins.push(sourceNode);\n      sourceNode.out.push(targetNode);\n    }\n    traverseGraph(Object.values(graph));\n  } catch (e) {\n    invalid = true;\n  }\n  const allDepths = Object.keys(graph).map((id) => graph[id].depth);\n  const maxDepth = Math.max(...allDepths);\n  return {\n    invalid,\n    depths: graph,\n    maxDepth: maxDepth || 1\n  };\n}\nconst RADIALS = [\"radialin\", \"radialout\"];\nfunction forceRadial({\n  nodes,\n  edges,\n  mode = \"lr\",\n  nodeLevelRatio = 2\n}) {\n  const { depths, maxDepth, invalid } = getNodeDepth(nodes, edges);\n  if (invalid) {\n    return null;\n  }\n  const modeDistance = RADIALS.includes(mode) ? 1 : 5;\n  const dagLevelDistance = nodes.length / maxDepth * nodeLevelRatio * modeDistance;\n  if (mode) {\n    const getFFn = (fix, invert) => (node) => !fix ? void 0 : (depths[node.id].depth - maxDepth / 2) * dagLevelDistance * (invert ? -1 : 1);\n    const fxFn = getFFn([\"lr\", \"rl\"].includes(mode), mode === \"rl\");\n    const fyFn = getFFn([\"td\", \"bu\"].includes(mode), mode === \"td\");\n    const fzFn = getFFn([\"zin\", \"zout\"].includes(mode), mode === \"zout\");\n    nodes.forEach((node) => {\n      node.fx = fxFn(node);\n      node.fy = fyFn(node);\n      node.fz = fzFn(node);\n    });\n  }\n  return RADIALS.includes(mode) ? (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_16__[\"default\"])((node) => {\n    const nodeDepth = depths[node.id];\n    const depth = mode === \"radialin\" ? maxDepth - nodeDepth.depth : nodeDepth.depth;\n    return depth * dagLevelDistance;\n  }).strength(1) : null;\n}\nfunction tick(layout) {\n  return new Promise((resolve, _reject) => {\n    let stable;\n    function run() {\n      if (!stable) {\n        stable = layout.step();\n        run();\n      } else {\n        resolve(stable);\n      }\n    }\n    run();\n  });\n}\nfunction buildNodeEdges(graph) {\n  const nodes = [];\n  const edges = [];\n  graph.forEachNode((id, n) => {\n    nodes.push({\n      ...n,\n      id,\n      // This is for the clustering\n      radius: n.size || 1\n    });\n  });\n  graph.forEachEdge((id, l) => {\n    edges.push({ ...l, id });\n  });\n  return { nodes, edges };\n}\nfunction forceInABox() {\n  const constant = (_) => () => _;\n  const index = (d) => d.index;\n  let id = index;\n  let nodes = [];\n  let links = [];\n  let clusters;\n  let tree2;\n  let size = [100, 100];\n  let forceNodeSize = constant(1);\n  let forceCharge = constant(-1);\n  let forceLinkDistance = constant(100);\n  let forceLinkStrength = constant(0.1);\n  let foci = {};\n  let linkStrengthIntraCluster = 0.1;\n  let linkStrengthInterCluster = 1e-3;\n  let templateNodes = [];\n  let offset = [0, 0];\n  let templateForce;\n  let groupBy = (d) => d.cluster;\n  let template = \"treemap\";\n  let enableGrouping = true;\n  let strength = 0.1;\n  function force(alpha) {\n    if (!enableGrouping) {\n      return force;\n    }\n    if (template === \"force\") {\n      templateForce.tick();\n      getFocisFromTemplate();\n    }\n    for (let i = 0, n = nodes.length, node, k = alpha * strength; i < n; ++i) {\n      node = nodes[i];\n      node.vx += (foci[groupBy(node)].x - node.x) * k;\n      node.vy += (foci[groupBy(node)].y - node.y) * k;\n    }\n  }\n  function initialize() {\n    if (!nodes) {\n      return;\n    }\n    if (template === \"treemap\") {\n      initializeWithTreemap();\n    } else {\n      initializeWithForce();\n    }\n  }\n  force.initialize = function(_) {\n    nodes = _;\n    initialize();\n  };\n  function getLinkKey(l) {\n    let sourceID = groupBy(l.source), targetID = groupBy(l.target);\n    return sourceID <= targetID ? sourceID + \"~\" + targetID : targetID + \"~\" + sourceID;\n  }\n  function computeClustersNodeCounts(nodes2) {\n    let clustersCounts = /* @__PURE__ */ new Map(), tmpCount = {};\n    nodes2.forEach(function(d) {\n      if (!clustersCounts.has(groupBy(d))) {\n        clustersCounts.set(groupBy(d), { count: 0, sumforceNodeSize: 0 });\n      }\n    });\n    nodes2.forEach(function(d) {\n      tmpCount = clustersCounts.get(groupBy(d));\n      tmpCount.count = tmpCount.count + 1;\n      tmpCount.sumforceNodeSize = tmpCount.sumforceNodeSize + // @ts-ignore\n      Math.PI * (forceNodeSize(d) * forceNodeSize(d)) * 1.3;\n      clustersCounts.set(groupBy(d), tmpCount);\n    });\n    return clustersCounts;\n  }\n  function computeClustersLinkCounts(links2) {\n    let dClusterLinks = /* @__PURE__ */ new Map(), clusterLinks = [];\n    links2.forEach(function(l) {\n      let key = getLinkKey(l), count;\n      if (dClusterLinks.has(key)) {\n        count = dClusterLinks.get(key);\n      } else {\n        count = 0;\n      }\n      count += 1;\n      dClusterLinks.set(key, count);\n    });\n    dClusterLinks.forEach(function(value, key) {\n      let source, target;\n      source = key.split(\"~\")[0];\n      target = key.split(\"~\")[1];\n      if (source !== void 0 && target !== void 0) {\n        clusterLinks.push({\n          source,\n          target,\n          count: value\n        });\n      }\n    });\n    return clusterLinks;\n  }\n  function getGroupsGraph() {\n    let gnodes = [];\n    let glinks = [];\n    let dNodes = /* @__PURE__ */ new Map();\n    let c;\n    let i;\n    let cc;\n    let clustersCounts;\n    let clustersLinks;\n    clustersCounts = computeClustersNodeCounts(nodes);\n    clustersLinks = computeClustersLinkCounts(links);\n    for (c of clustersCounts.keys()) {\n      cc = clustersCounts.get(c);\n      gnodes.push({\n        id: c,\n        size: cc.count,\n        r: Math.sqrt(cc.sumforceNodeSize / Math.PI)\n      });\n      dNodes.set(c, i);\n    }\n    clustersLinks.forEach(function(l) {\n      let source = dNodes.get(l.source), target = dNodes.get(l.target);\n      if (source !== void 0 && target !== void 0) {\n        glinks.push({\n          source,\n          target,\n          count: l.count\n        });\n      }\n    });\n    return { nodes: gnodes, links: glinks };\n  }\n  function getGroupsTree() {\n    let children = [];\n    let c;\n    let cc;\n    let clustersCounts;\n    clustersCounts = computeClustersNodeCounts(force.nodes());\n    for (c of clustersCounts.keys()) {\n      cc = clustersCounts.get(c);\n      children.push({ id: c, size: cc.count });\n    }\n    return { id: \"clustersTree\", children };\n  }\n  function getFocisFromTemplate() {\n    foci.none = { x: 0, y: 0 };\n    templateNodes.forEach(function(d) {\n      if (template === \"treemap\") {\n        foci[d.data.id] = {\n          x: d.x0 + (d.x1 - d.x0) / 2 - offset[0],\n          y: d.y0 + (d.y1 - d.y0) / 2 - offset[1]\n        };\n      } else {\n        foci[d.id] = {\n          x: d.x - offset[0],\n          y: d.y - offset[1]\n        };\n      }\n    });\n    return foci;\n  }\n  function initializeWithTreemap() {\n    let sim = (0,d3_hierarchy__WEBPACK_IMPORTED_MODULE_17__[\"default\"])().size(force.size());\n    tree2 = (0,d3_hierarchy__WEBPACK_IMPORTED_MODULE_18__[\"default\"])(getGroupsTree()).sum((d) => d.radius).sort(function(a2, b) {\n      return b.height - a2.height || b.value - a2.value;\n    });\n    templateNodes = sim(tree2).leaves();\n    getFocisFromTemplate();\n  }\n  function checkLinksAsObjects() {\n    let linkCount = 0;\n    if (nodes.length === 0)\n      return;\n    links.forEach(function(link) {\n      let source, target;\n      if (!nodes) {\n        return;\n      }\n      source = link.source;\n      target = link.target;\n      if (typeof link.source !== \"object\") {\n        source = nodes.find((n) => n.id === link.source);\n      }\n      if (typeof link.target !== \"object\") {\n        target = nodes.find((n) => n.id === link.target);\n      }\n      if (source === void 0 || target === void 0) {\n        throw Error(\n          \"Error setting links, couldnt find nodes for a link (see it on the console)\"\n        );\n      }\n      link.source = source;\n      link.target = target;\n      link.index = linkCount++;\n    });\n  }\n  function initializeWithForce() {\n    let net;\n    if (!nodes || !nodes.length) {\n      return;\n    }\n    checkLinksAsObjects();\n    net = getGroupsGraph();\n    if (clusters.size > 0) {\n      net.nodes.forEach((n) => {\n        var _a2, _b2, _c, _d;\n        n.fx = (_b2 = (_a2 = clusters.get(n.id)) == null ? void 0 : _a2.position) == null ? void 0 : _b2.x;\n        n.fy = (_d = (_c = clusters.get(n.id)) == null ? void 0 : _c.position) == null ? void 0 : _d.y;\n      });\n    }\n    templateForce = (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_19__[\"default\"])(net.nodes).force(\"x\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_20__[\"default\"])(size[0] / 2).strength(0.1)).force(\"y\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_21__[\"default\"])(size[1] / 2).strength(0.1)).force(\"collide\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_22__[\"default\"])((d) => d.r).iterations(4)).force(\"charge\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_23__[\"default\"])().strength(forceCharge)).force(\n      \"links\",\n      (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_24__[\"default\"])(net.nodes.length ? net.links : []).distance(forceLinkDistance).strength(forceLinkStrength)\n    );\n    templateNodes = templateForce.nodes();\n    getFocisFromTemplate();\n  }\n  force.template = function(x) {\n    if (!arguments.length) {\n      return template;\n    }\n    template = x;\n    initialize();\n    return force;\n  };\n  force.groupBy = function(x) {\n    if (!arguments.length) {\n      return groupBy;\n    }\n    if (typeof x === \"string\") {\n      groupBy = function(d) {\n        return d[x];\n      };\n      return force;\n    }\n    groupBy = x;\n    return force;\n  };\n  force.enableGrouping = function(x) {\n    if (!arguments.length) {\n      return enableGrouping;\n    }\n    enableGrouping = x;\n    return force;\n  };\n  force.strength = function(x) {\n    if (!arguments.length) {\n      return strength;\n    }\n    strength = x;\n    return force;\n  };\n  force.getLinkStrength = function(e) {\n    if (enableGrouping) {\n      if (groupBy(e.source) === groupBy(e.target)) {\n        if (typeof linkStrengthIntraCluster === \"function\") {\n          return linkStrengthIntraCluster(e);\n        } else {\n          return linkStrengthIntraCluster;\n        }\n      } else {\n        if (typeof linkStrengthInterCluster === \"function\") {\n          return linkStrengthInterCluster(e);\n        } else {\n          return linkStrengthInterCluster;\n        }\n      }\n    } else {\n      if (typeof linkStrengthIntraCluster === \"function\") {\n        return linkStrengthIntraCluster(e);\n      } else {\n        return linkStrengthIntraCluster;\n      }\n    }\n  };\n  force.id = function(_) {\n    return arguments.length ? (id = _, force) : id;\n  };\n  force.size = function(_) {\n    return arguments.length ? (size = _, force) : size;\n  };\n  force.linkStrengthInterCluster = function(_) {\n    return arguments.length ? (linkStrengthInterCluster = _, force) : linkStrengthInterCluster;\n  };\n  force.linkStrengthIntraCluster = function(_) {\n    return arguments.length ? (linkStrengthIntraCluster = _, force) : linkStrengthIntraCluster;\n  };\n  force.nodes = function(_) {\n    return arguments.length ? (nodes = _, force) : nodes;\n  };\n  force.links = function(_) {\n    if (!arguments.length) {\n      return links;\n    }\n    if (_ === null) {\n      links = [];\n    } else {\n      links = _;\n    }\n    initialize();\n    return force;\n  };\n  force.template = function(x) {\n    if (!arguments.length) {\n      return template;\n    }\n    template = x;\n    initialize();\n    return force;\n  };\n  force.forceNodeSize = function(_) {\n    return arguments.length ? (forceNodeSize = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : forceNodeSize;\n  };\n  force.nodeSize = force.forceNodeSize;\n  force.forceCharge = function(_) {\n    return arguments.length ? (forceCharge = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : forceCharge;\n  };\n  force.forceLinkDistance = function(_) {\n    return arguments.length ? (forceLinkDistance = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : forceLinkDistance;\n  };\n  force.forceLinkStrength = function(_) {\n    return arguments.length ? (forceLinkStrength = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : forceLinkStrength;\n  };\n  force.offset = function(_) {\n    return arguments.length ? (offset = typeof _ === \"function\" ? _ : constant(+_), force) : offset;\n  };\n  force.getFocis = getFocisFromTemplate;\n  force.setClusters = function(value) {\n    clusters = value;\n    return force;\n  };\n  return force;\n}\nfunction forceDirected({\n  graph,\n  nodeLevelRatio = 2,\n  mode = null,\n  dimensions = 2,\n  nodeStrength = -250,\n  linkDistance = 50,\n  clusterStrength = 0.5,\n  linkStrengthInterCluster = 0.01,\n  linkStrengthIntraCluster = 0.5,\n  forceLinkDistance = 100,\n  forceLinkStrength = 0.1,\n  clusterType = \"force\",\n  forceCharge = -700,\n  getNodePosition,\n  drags,\n  clusters,\n  clusterAttribute,\n  forceLayout\n}) {\n  const { nodes, edges } = buildNodeEdges(graph);\n  const is2d = dimensions === 2;\n  const nodeStrengthAdjustment = is2d && edges.length > 25 ? nodeStrength * 2 : nodeStrength;\n  let forceX$1;\n  let forceY$1;\n  if (forceLayout === \"forceDirected2d\") {\n    forceX$1 = (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_20__[\"default\"])();\n    forceY$1 = (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_21__[\"default\"])();\n  } else {\n    forceX$1 = (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_20__[\"default\"])(600).strength(0.05);\n    forceY$1 = (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_21__[\"default\"])(600).strength(0.05);\n  }\n  const sim = (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_19__[\"default\"])().force(\"center\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_25__[\"default\"])(0, 0)).force(\"link\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_24__[\"default\"])()).force(\"charge\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_23__[\"default\"])().strength(nodeStrengthAdjustment)).force(\"x\", forceX$1).force(\"y\", forceY$1).force(\"z\", (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_26__[\"default\"])()).force(\n    \"collide\",\n    (0,d3_force_3d__WEBPACK_IMPORTED_MODULE_22__[\"default\"])((d) => d.radius + 10)\n  ).force(\n    \"dagRadial\",\n    forceRadial({\n      nodes,\n      edges,\n      mode,\n      nodeLevelRatio\n    })\n  ).stop();\n  let groupingForce;\n  if (clusterAttribute) {\n    let forceChargeAdjustment = forceCharge;\n    if (nodes == null ? void 0 : nodes.length) {\n      const adjustmentFactor = Math.ceil(nodes.length / 200);\n      forceChargeAdjustment = forceCharge * adjustmentFactor;\n    }\n    groupingForce = forceInABox().setClusters(clusters).strength(clusterStrength).template(clusterType).groupBy((d) => d.data[clusterAttribute]).links(edges).size([100, 100]).linkStrengthInterCluster(linkStrengthInterCluster).linkStrengthIntraCluster(linkStrengthIntraCluster).forceLinkDistance(forceLinkDistance).forceLinkStrength(forceLinkStrength).forceCharge(forceChargeAdjustment).forceNodeSize((d) => d.radius);\n  }\n  let layout = sim.numDimensions(dimensions).nodes(nodes);\n  if (groupingForce) {\n    layout = layout.force(\"group\", groupingForce);\n  }\n  if (linkDistance) {\n    let linkForce = layout.force(\"link\");\n    if (linkForce) {\n      linkForce.id((d) => d.id).links(edges).distance(linkDistance);\n      if (groupingForce) {\n        linkForce = linkForce.strength((groupingForce == null ? void 0 : groupingForce.getLinkStrength) ?? 0.1);\n      }\n    }\n  }\n  const nodeMap = new Map(nodes.map((n) => [n.id, n]));\n  return {\n    step() {\n      while (sim.alpha() > 0.01) {\n        sim.tick();\n      }\n      return true;\n    },\n    getNodePosition(id) {\n      var _a2, _b2;\n      if (getNodePosition) {\n        const pos = getNodePosition(id, { graph, drags, nodes, edges });\n        if (pos) {\n          return pos;\n        }\n      }\n      if ((_a2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _a2.position) {\n        return (_b2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _b2.position;\n      }\n      return nodeMap.get(id);\n    }\n  };\n}\nfunction circular2d({\n  graph,\n  radius,\n  drags,\n  getNodePosition\n}) {\n  const layout = graphology_layout_circular_js__WEBPACK_IMPORTED_MODULE_2__(graph, {\n    scale: radius\n  });\n  const { nodes, edges } = buildNodeEdges(graph);\n  return {\n    step() {\n      return true;\n    },\n    getNodePosition(id) {\n      var _a2, _b2;\n      if (getNodePosition) {\n        const pos = getNodePosition(id, { graph, drags, nodes, edges });\n        if (pos) {\n          return pos;\n        }\n      }\n      if ((_a2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _a2.position) {\n        return (_b2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _b2.position;\n      }\n      return layout == null ? void 0 : layout[id];\n    }\n  };\n}\nconst DIRECTION_MAP = {\n  td: {\n    x: \"x\",\n    y: \"y\",\n    factor: -1\n  },\n  lr: {\n    x: \"y\",\n    y: \"x\",\n    factor: 1\n  }\n};\nfunction hierarchical({\n  graph,\n  drags,\n  mode = \"td\",\n  nodeSeparation = 1,\n  nodeSize = [50, 50],\n  getNodePosition\n}) {\n  const { nodes, edges } = buildNodeEdges(graph);\n  const { depths } = getNodeDepth(nodes, edges);\n  const rootNodes = Object.keys(depths).map((d) => depths[d]);\n  const root = (0,d3_hierarchy__WEBPACK_IMPORTED_MODULE_27__[\"default\"])().id((d) => d.data.id).parentId((d) => {\n    var _a2, _b2, _c;\n    return (_c = (_b2 = (_a2 = d.ins) == null ? void 0 : _a2[0]) == null ? void 0 : _b2.data) == null ? void 0 : _c.id;\n  })(rootNodes);\n  const treeRoot = (0,d3_hierarchy__WEBPACK_IMPORTED_MODULE_28__[\"default\"])().separation(() => nodeSeparation).nodeSize(nodeSize)((0,d3_hierarchy__WEBPACK_IMPORTED_MODULE_18__[\"default\"])(root));\n  const treeNodes = treeRoot.descendants();\n  const path = DIRECTION_MAP[mode];\n  const mappedNodes = new Map(\n    nodes.map((n) => {\n      const { x, y } = treeNodes.find((t) => t.data.id === n.id);\n      return [\n        n.id,\n        {\n          ...n,\n          [path.x]: x * path.factor,\n          [path.y]: y * path.factor,\n          z: 0\n        }\n      ];\n    })\n  );\n  return {\n    step() {\n      return true;\n    },\n    getNodePosition(id) {\n      var _a2, _b2;\n      if (getNodePosition) {\n        const pos = getNodePosition(id, { graph, drags, nodes, edges });\n        if (pos) {\n          return pos;\n        }\n      }\n      if ((_a2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _a2.position) {\n        return (_b2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _b2.position;\n      }\n      return mappedNodes.get(id);\n    }\n  };\n}\nfunction nooverlap({\n  graph,\n  margin,\n  drags,\n  getNodePosition,\n  ratio,\n  gridSize,\n  maxIterations\n}) {\n  const { nodes, edges } = buildNodeEdges(graph);\n  const layout = graphology_layout_noverlap__WEBPACK_IMPORTED_MODULE_3__(graph, {\n    maxIterations,\n    inputReducer: (_key, attr) => ({\n      ...attr,\n      // Have to specify defaults for the engine\n      x: attr.x || 0,\n      y: attr.y || 0\n    }),\n    settings: {\n      ratio,\n      margin,\n      gridSize\n    }\n  });\n  return {\n    step() {\n      return true;\n    },\n    getNodePosition(id) {\n      var _a2, _b2;\n      if (getNodePosition) {\n        const pos = getNodePosition(id, { graph, drags, nodes, edges });\n        if (pos) {\n          return pos;\n        }\n      }\n      if ((_a2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _a2.position) {\n        return (_b2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _b2.position;\n      }\n      return layout == null ? void 0 : layout[id];\n    }\n  };\n}\nfunction forceAtlas2({\n  graph,\n  drags,\n  iterations,\n  ...rest\n}) {\n  graphology_layout_random_js__WEBPACK_IMPORTED_MODULE_5__.assign(graph);\n  const layout = graphology_layout_forceatlas2__WEBPACK_IMPORTED_MODULE_4__(graph, {\n    iterations,\n    settings: rest\n  });\n  return {\n    step() {\n      return true;\n    },\n    getNodePosition(id) {\n      var _a2;\n      return ((_a2 = drags == null ? void 0 : drags[id]) == null ? void 0 : _a2.position) || (layout == null ? void 0 : layout[id]);\n    }\n  };\n}\nfunction custom({ graph, drags, getNodePosition }) {\n  const { nodes, edges } = buildNodeEdges(graph);\n  return {\n    step() {\n      return true;\n    },\n    getNodePosition(id) {\n      return getNodePosition(id, { graph, drags, nodes, edges });\n    }\n  };\n}\nconst FORCE_LAYOUTS = [\n  \"forceDirected2d\",\n  \"treeTd2d\",\n  \"treeLr2d\",\n  \"radialOut2d\",\n  \"treeTd3d\",\n  \"treeLr3d\",\n  \"radialOut3d\",\n  \"forceDirected3d\"\n];\nfunction layoutProvider({\n  type,\n  ...rest\n}) {\n  if (FORCE_LAYOUTS.includes(type)) {\n    const { nodeStrength, linkDistance, nodeLevelRatio } = rest;\n    if (type === \"forceDirected2d\") {\n      return forceDirected({\n        ...rest,\n        dimensions: 2,\n        nodeLevelRatio: nodeLevelRatio || 2,\n        nodeStrength: nodeStrength || -250,\n        linkDistance,\n        forceLayout: type\n      });\n    } else if (type === \"treeTd2d\") {\n      return forceDirected({\n        ...rest,\n        mode: \"td\",\n        dimensions: 2,\n        nodeLevelRatio: nodeLevelRatio || 5,\n        nodeStrength: nodeStrength || -250,\n        linkDistance: linkDistance || 50,\n        forceLayout: type\n      });\n    } else if (type === \"treeLr2d\") {\n      return forceDirected({\n        ...rest,\n        mode: \"lr\",\n        dimensions: 2,\n        nodeLevelRatio: nodeLevelRatio || 5,\n        nodeStrength: nodeStrength || -250,\n        linkDistance: linkDistance || 50,\n        forceLayout: type\n      });\n    } else if (type === \"radialOut2d\") {\n      return forceDirected({\n        ...rest,\n        mode: \"radialout\",\n        dimensions: 2,\n        nodeLevelRatio: nodeLevelRatio || 5,\n        nodeStrength: nodeStrength || -500,\n        linkDistance: linkDistance || 100,\n        forceLayout: type\n      });\n    } else if (type === \"treeTd3d\") {\n      return forceDirected({\n        ...rest,\n        mode: \"td\",\n        dimensions: 3,\n        nodeLevelRatio: nodeLevelRatio || 2,\n        nodeStrength: nodeStrength || -500,\n        linkDistance: linkDistance || 50\n      });\n    } else if (type === \"treeLr3d\") {\n      return forceDirected({\n        ...rest,\n        mode: \"lr\",\n        dimensions: 3,\n        nodeLevelRatio: nodeLevelRatio || 2,\n        nodeStrength: nodeStrength || -500,\n        linkDistance: linkDistance || 50,\n        forceLayout: type\n      });\n    } else if (type === \"radialOut3d\") {\n      return forceDirected({\n        ...rest,\n        mode: \"radialout\",\n        dimensions: 3,\n        nodeLevelRatio: nodeLevelRatio || 2,\n        nodeStrength: nodeStrength || -500,\n        linkDistance: linkDistance || 100,\n        forceLayout: type\n      });\n    } else if (type === \"forceDirected3d\") {\n      return forceDirected({\n        ...rest,\n        dimensions: 3,\n        nodeLevelRatio: nodeLevelRatio || 2,\n        nodeStrength: nodeStrength || -250,\n        linkDistance,\n        forceLayout: type\n      });\n    }\n  } else if (type === \"circular2d\") {\n    const { radius } = rest;\n    return circular2d({\n      ...rest,\n      radius: radius || 300\n    });\n  } else if (type === \"hierarchicalTd\") {\n    return hierarchical({ ...rest, mode: \"td\" });\n  } else if (type === \"hierarchicalLr\") {\n    return hierarchical({ ...rest, mode: \"lr\" });\n  } else if (type === \"nooverlap\") {\n    const { graph, maxIterations, ratio, margin, gridSize, ...settings } = rest;\n    return nooverlap({\n      type: \"nooverlap\",\n      graph,\n      margin: margin || 10,\n      maxIterations: maxIterations || 50,\n      ratio: ratio || 10,\n      gridSize: gridSize || 20,\n      ...settings\n    });\n  } else if (type === \"forceatlas2\") {\n    const { graph, iterations, gravity, scalingRatio, ...settings } = rest;\n    return forceAtlas2({\n      type: \"forceatlas2\",\n      graph,\n      ...settings,\n      scalingRatio: scalingRatio || 100,\n      gravity: gravity || 10,\n      iterations: iterations || 50\n    });\n  } else if (type === \"custom\") {\n    return custom({\n      type: \"custom\",\n      ...rest\n    });\n  }\n  throw new Error(`Layout ${type} not found.`);\n}\nfunction recommendLayout(nodes, edges) {\n  const { invalid } = getNodeDepth(nodes, edges);\n  const nodeCount = nodes.length;\n  if (!invalid) {\n    if (nodeCount > 100) {\n      return \"radialOut2d\";\n    } else {\n      return \"treeTd2d\";\n    }\n  }\n  return \"forceDirected2d\";\n}\nfunction calcLabelVisibility({\n  nodeCount,\n  nodePosition,\n  labelType,\n  camera\n}) {\n  return (shape, size) => {\n    var _a2;\n    if (camera && nodePosition && ((_a2 = camera == null ? void 0 : camera.position) == null ? void 0 : _a2.z) / (camera == null ? void 0 : camera.zoom) - (nodePosition == null ? void 0 : nodePosition.z) > 6e3) {\n      return false;\n    }\n    if (labelType === \"all\") {\n      return true;\n    } else if (labelType === \"nodes\" && shape === \"node\") {\n      return true;\n    } else if (labelType === \"edges\" && shape === \"edge\") {\n      return true;\n    } else if (labelType === \"auto\" && shape === \"node\") {\n      if (size > 7) {\n        return true;\n      } else if (camera && nodePosition && camera.position.z / camera.zoom - nodePosition.z < 3e3) {\n        return true;\n      }\n    }\n    return false;\n  };\n}\nfunction getLabelOffsetByType(offset, position) {\n  switch (position) {\n    case \"above\":\n      return offset;\n    case \"below\":\n      return -offset;\n    case \"inline\":\n    case \"natural\":\n    default:\n      return 0;\n  }\n}\nfunction pageRankSizing({\n  graph\n}) {\n  const ranks = graphology_metrics_centrality_pagerank_js__WEBPACK_IMPORTED_MODULE_6__(graph);\n  return {\n    ranks,\n    getSizeForNode: (nodeID) => ranks[nodeID] * 80\n  };\n}\nfunction centralitySizing({\n  graph\n}) {\n  const ranks = (0,graphology_metrics_centrality_degree_js__WEBPACK_IMPORTED_MODULE_7__.degreeCentrality)(graph);\n  return {\n    ranks,\n    getSizeForNode: (nodeID) => ranks[nodeID] * 20\n  };\n}\nfunction attributeSizing({\n  graph,\n  attribute,\n  defaultSize\n}) {\n  const map = /* @__PURE__ */ new Map();\n  if (attribute) {\n    graph.forEachNode((id, node) => {\n      var _a2;\n      const size = (_a2 = node.data) == null ? void 0 : _a2[attribute];\n      if (isNaN(size)) {\n        console.warn(`Attribute ${size} is not a number for node ${node.id}`);\n      }\n      map.set(id, size || 0);\n    });\n  } else {\n    console.warn(\"Attribute sizing configured but no attribute provided\");\n  }\n  return {\n    getSizeForNode: (nodeId) => {\n      if (!attribute || !map) {\n        return defaultSize;\n      }\n      return map.get(nodeId);\n    }\n  };\n}\nconst providers = {\n  pagerank: pageRankSizing,\n  centrality: centralitySizing,\n  attribute: attributeSizing,\n  none: ({ defaultSize }) => ({\n    getSizeForNode: (_id) => defaultSize\n  })\n};\nfunction nodeSizeProvider({ type, ...rest }) {\n  var _a2;\n  const provider = (_a2 = providers[type]) == null ? void 0 : _a2.call(providers, rest);\n  if (!provider && type !== \"default\") {\n    throw new Error(`Unknown sizing strategy: ${type}`);\n  }\n  const { graph, minSize, maxSize } = rest;\n  const sizes = /* @__PURE__ */ new Map();\n  let min;\n  let max;\n  graph.forEachNode((id, node) => {\n    let size;\n    if (type === \"default\") {\n      size = node.size || rest.defaultSize;\n    } else {\n      size = provider.getSizeForNode(id);\n    }\n    if (min === void 0 || size < min) {\n      min = size;\n    }\n    if (max === void 0 || size > max) {\n      max = size;\n    }\n    sizes.set(id, size);\n  });\n  if (type !== \"none\") {\n    const scale = (0,d3_scale__WEBPACK_IMPORTED_MODULE_29__[\"default\"])().domain([min, max]).rangeRound([minSize, maxSize]);\n    for (const [nodeId, size] of sizes) {\n      sizes.set(nodeId, scale(size));\n    }\n  }\n  return sizes;\n}\nfunction buildGraph(graph, nodes, edges) {\n  graph.clear();\n  for (const node of nodes) {\n    try {\n      graph.addNode(node.id, node);\n    } catch ({ message }) {\n      console.error(`[Graph] ${message}`);\n    }\n  }\n  for (const edge of edges) {\n    try {\n      graph.addEdge(edge.source, edge.target, edge);\n    } catch ({ message }) {\n      console.error(`[Graph] ${message}`);\n    }\n  }\n  return graph;\n}\nfunction transformGraph({\n  graph,\n  layout,\n  sizingType,\n  labelType,\n  sizingAttribute,\n  defaultNodeSize,\n  minNodeSize,\n  maxNodeSize,\n  clusterAttribute\n}) {\n  const nodes = [];\n  const edges = [];\n  const map = /* @__PURE__ */ new Map();\n  const sizes = nodeSizeProvider({\n    graph,\n    type: sizingType,\n    attribute: sizingAttribute,\n    minSize: minNodeSize,\n    maxSize: maxNodeSize,\n    defaultSize: defaultNodeSize\n  });\n  const nodeCount = graph.nodes().length;\n  const checkVisibility = calcLabelVisibility({ nodeCount, labelType });\n  graph.forEachNode((id, node) => {\n    const position = layout.getNodePosition(id);\n    const { data, fill, icon, label, size, ...rest } = node;\n    const nodeSize = sizes.get(node.id);\n    const labelVisible = checkVisibility(\"node\", nodeSize);\n    const nodeLinks = graph.inboundNeighbors(node.id) || [];\n    const parents = nodeLinks.map((n2) => graph.getNodeAttributes(n2));\n    const n = {\n      ...node,\n      size: nodeSize,\n      labelVisible,\n      label,\n      icon,\n      fill,\n      cluster: clusterAttribute ? data[clusterAttribute] : void 0,\n      parents,\n      data: {\n        ...rest,\n        ...data ?? {}\n      },\n      position: {\n        ...position,\n        x: position.x || 0,\n        y: position.y || 0,\n        z: position.z || 1\n      }\n    };\n    map.set(node.id, n);\n    nodes.push(n);\n  });\n  graph.forEachEdge((_id, link) => {\n    const from = map.get(link.source);\n    const to = map.get(link.target);\n    if (from && to) {\n      const { data, id, label, size, ...rest } = link;\n      const labelVisible = checkVisibility(\"edge\", size);\n      edges.push({\n        ...link,\n        id,\n        label,\n        labelVisible,\n        size,\n        data: {\n          ...rest,\n          id,\n          ...data || {}\n        }\n      });\n    }\n  });\n  return {\n    nodes,\n    edges\n  };\n}\nconst animationConfig = {\n  mass: 10,\n  tension: 1e3,\n  friction: 300,\n  // Decreasing precision to improve performance from 0.00001\n  precision: 0.1\n};\nfunction getArrowVectors(placement, curve, arrowLength) {\n  const curveLength = curve.getLength();\n  const absSize = placement === \"end\" ? curveLength : curveLength / 2;\n  const offset = placement === \"end\" ? arrowLength / 2 : 0;\n  const u = (absSize - offset) / curveLength;\n  const position = curve.getPointAt(u);\n  const rotation = curve.getTangentAt(u);\n  return [position, rotation];\n}\nfunction getArrowSize(size) {\n  return [size + 6, 2 + size / 1.5];\n}\nconst MULTI_EDGE_OFFSET_FACTOR = 0.7;\nfunction getMidPoint(from, to, offset = 0) {\n  const fromVector = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(from.x, from.y || 0, from.z || 0);\n  const toVector = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(to.x, to.y || 0, to.z || 0);\n  const midVector = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3().addVectors(fromVector, toVector).divideScalar(2);\n  return midVector.setLength(midVector.length() + offset);\n}\nfunction getCurvePoints(from, to, offset = -1) {\n  const fromVector = from.clone();\n  const toVector = to.clone();\n  const v = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3().subVectors(toVector, fromVector);\n  const vlen = v.length();\n  const vn = v.clone().normalize();\n  const vv = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3().subVectors(toVector, fromVector).divideScalar(2);\n  const k = Math.abs(vn.x) % 1;\n  const b = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(-vn.y, vn.x - k * vn.z, k * vn.y).normalize();\n  const vm = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3().add(fromVector).add(vv).add(b.multiplyScalar(vlen / 4).multiplyScalar(offset));\n  return [from, vm, to];\n}\nfunction getCurve(from, fromOffset, to, toOffset, curved, curveOffset) {\n  const offsetFrom = getPointBetween(from, to, fromOffset);\n  const offsetTo = getPointBetween(to, from, toOffset);\n  return curved ? new three__WEBPACK_IMPORTED_MODULE_30__.QuadraticBezierCurve3(\n    ...getCurvePoints(offsetFrom, offsetTo, curveOffset)\n  ) : new three__WEBPACK_IMPORTED_MODULE_30__.LineCurve3(offsetFrom, offsetTo);\n}\nfunction getVector(node) {\n  return new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(node.position.x, node.position.y, node.position.z || 0);\n}\nfunction getPointBetween(from, to, offset) {\n  const distance = from.distanceTo(to);\n  return from.clone().add(\n    to.clone().sub(from).multiplyScalar(offset / distance)\n  );\n}\nfunction updateNodePosition(node, offset) {\n  return {\n    ...node,\n    position: {\n      ...node.position,\n      x: node.position.x + offset.x,\n      y: node.position.y + offset.y,\n      z: node.position.z + offset.z\n    }\n  };\n}\nfunction calculateEdgeCurveOffset({ edge, edges, curved }) {\n  let updatedCurved = curved;\n  let curveOffset;\n  const parallelEdges = edges.filter((e) => e.target === edge.target && e.source === edge.source).map((e) => e.id);\n  if (parallelEdges.length > 1) {\n    updatedCurved = true;\n    const edgeIndex = parallelEdges.indexOf(edge.id);\n    if (parallelEdges.length === 2) {\n      curveOffset = edgeIndex === 0 ? MULTI_EDGE_OFFSET_FACTOR : -MULTI_EDGE_OFFSET_FACTOR;\n    } else {\n      curveOffset = (edgeIndex - Math.floor(parallelEdges.length / 2)) * MULTI_EDGE_OFFSET_FACTOR;\n    }\n  }\n  return { curved: updatedCurved, curveOffset };\n}\nfunction getLayoutCenter(nodes) {\n  let minX = Number.POSITIVE_INFINITY;\n  let maxX = Number.NEGATIVE_INFINITY;\n  let minY = Number.POSITIVE_INFINITY;\n  let maxY = Number.NEGATIVE_INFINITY;\n  let minZ = Number.POSITIVE_INFINITY;\n  let maxZ = Number.NEGATIVE_INFINITY;\n  for (let node of nodes) {\n    minX = Math.min(minX, node.position.x);\n    maxX = Math.max(maxX, node.position.x);\n    minY = Math.min(minY, node.position.y);\n    maxY = Math.max(maxY, node.position.y);\n    minZ = Math.min(minZ, node.position.z);\n    maxZ = Math.max(maxZ, node.position.z);\n  }\n  return {\n    height: maxY - minY,\n    width: maxX - minX,\n    minX,\n    maxX,\n    minY,\n    maxY,\n    minZ,\n    maxZ,\n    x: (maxX + minX) / 2,\n    y: (maxY + minY) / 2,\n    z: (maxZ + minZ) / 2\n  };\n}\nfunction buildClusterGroups(nodes, clusterAttribute) {\n  if (!clusterAttribute) {\n    return /* @__PURE__ */ new Map();\n  }\n  return nodes.reduce((entryMap, e) => {\n    const val = e.data[clusterAttribute];\n    if (val) {\n      entryMap.set(val, [...entryMap.get(val) || [], e]);\n    }\n    return entryMap;\n  }, /* @__PURE__ */ new Map());\n}\nfunction calculateClusters({\n  nodes,\n  clusterAttribute\n}) {\n  const result = /* @__PURE__ */ new Map();\n  if (clusterAttribute) {\n    const groups = buildClusterGroups(nodes, clusterAttribute);\n    for (const [key, nodes2] of groups) {\n      const position = getLayoutCenter(nodes2);\n      result.set(key, {\n        label: key,\n        nodes: nodes2,\n        position\n      });\n    }\n  }\n  return result;\n}\nconst useHoverIntent = ({\n  sensitivity = 7,\n  interval = 50,\n  timeout = 0,\n  disabled: disabled2,\n  onPointerOver,\n  onPointerOut\n}) => {\n  const mouseOver = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const timer = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const state = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n  const coords = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)({\n    x: null,\n    y: null,\n    px: null,\n    py: null\n  });\n  const onMouseMove = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((event) => {\n    coords.current.x = event.clientX;\n    coords.current.y = event.clientY;\n  }, []);\n  const comparePosition = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (event) => {\n      timer.current = clearTimeout(timer.current);\n      const { px, x, py, y } = coords.current;\n      if (Math.abs(px - x) + Math.abs(py - y) < sensitivity) {\n        state.current = 1;\n        onPointerOver(event);\n      } else {\n        coords.current.px = x;\n        coords.current.py = y;\n        timer.current = setTimeout(() => comparePosition(event), interval);\n      }\n    },\n    [interval, onPointerOver, sensitivity]\n  );\n  const cleanup = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    clearTimeout(timer.current);\n    if (typeof window !== \"undefined\") {\n      document.removeEventListener(\"mousemove\", onMouseMove, false);\n    }\n  }, [onMouseMove]);\n  const pointerOver = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (event) => {\n      if (!disabled2) {\n        mouseOver.current = true;\n        cleanup();\n        if (state.current !== 1) {\n          coords.current.px = event.pointer.x;\n          coords.current.py = event.pointer.y;\n          if (typeof window !== \"undefined\") {\n            document.addEventListener(\"mousemove\", onMouseMove, false);\n          }\n          timer.current = setTimeout(() => comparePosition(event), timeout);\n        }\n      }\n    },\n    [cleanup, comparePosition, disabled2, onMouseMove, timeout]\n  );\n  const delay = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (event) => {\n      timer.current = clearTimeout(timer.current);\n      state.current = 0;\n      onPointerOut(event);\n    },\n    [onPointerOut]\n  );\n  const pointerOut = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (event) => {\n      mouseOver.current = false;\n      cleanup();\n      if (state.current === 1) {\n        timer.current = setTimeout(() => delay(event), timeout);\n      }\n    },\n    [cleanup, delay, timeout]\n  );\n  return {\n    pointerOver,\n    pointerOut\n  };\n};\nconst useDrag = ({\n  draggable,\n  set,\n  position,\n  bounds,\n  onDragStart,\n  onDragEnd\n}) => {\n  const camera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.camera);\n  const raycaster = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.raycaster);\n  const size = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.size);\n  const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.gl);\n  const { mouse2D, mouse3D, offset, normal, plane } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => ({\n      // Normalized 2D screen space mouse coords\n      mouse2D: new three__WEBPACK_IMPORTED_MODULE_30__.Vector2(),\n      // 3D world space mouse coords\n      mouse3D: new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(),\n      // Drag point offset from object origin\n      offset: new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(),\n      // Normal of the drag plane\n      normal: new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(),\n      // Drag plane\n      plane: new three__WEBPACK_IMPORTED_MODULE_30__.Plane()\n    }),\n    []\n  );\n  const clientRect = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => gl.domElement.getBoundingClientRect(),\n    [gl.domElement]\n  );\n  return (0,_use_gesture_react__WEBPACK_IMPORTED_MODULE_32__.useGesture)(\n    {\n      onDragStart: ({ event }) => {\n        const { eventObject, point } = event;\n        eventObject.getWorldPosition(offset).sub(point);\n        mouse3D.copy(point);\n        onDragStart();\n      },\n      onDrag: ({ xy, buttons, cancel }) => {\n        if (buttons !== 1) {\n          cancel();\n          return;\n        }\n        const nx = (xy[0] - ((clientRect == null ? void 0 : clientRect.left) ?? 0)) / size.width * 2 - 1;\n        const ny = -((xy[1] - ((clientRect == null ? void 0 : clientRect.top) ?? 0)) / size.height) * 2 + 1;\n        mouse2D.set(nx, ny);\n        raycaster.setFromCamera(mouse2D, camera);\n        camera.getWorldDirection(normal).negate();\n        plane.setFromNormalAndCoplanarPoint(normal, mouse3D);\n        raycaster.ray.intersectPlane(plane, mouse3D);\n        const updated = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(position.x, position.y, position.z).copy(mouse3D).add(offset);\n        if (bounds) {\n          const center = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(\n            (bounds.minX + bounds.maxX) / 2,\n            (bounds.minY + bounds.maxY) / 2,\n            (bounds.minZ + bounds.maxZ) / 2\n          );\n          const radius = (bounds.maxX - bounds.minX) / 2;\n          const direction = updated.clone().sub(center);\n          const distance = direction.length();\n          if (distance > radius) {\n            direction.normalize().multiplyScalar(radius);\n            updated.copy(center).add(direction);\n          }\n        }\n        return set(updated);\n      },\n      onDragEnd\n    },\n    { drag: { enabled: draggable, threshold: 10 } }\n  );\n};\nfunction findPath(graph, source, target) {\n  return (0,graphology_shortest_path__WEBPACK_IMPORTED_MODULE_8__.bidirectional)(graph, source, target);\n}\nconst { Provider, useStore } = (0,zustand_context__WEBPACK_IMPORTED_MODULE_33__[\"default\"])();\nconst createStore = ({\n  actives = [],\n  selections = [],\n  collapsedNodeIds = [],\n  theme\n}) => (0,zustand__WEBPACK_IMPORTED_MODULE_34__.create)((set) => ({\n  theme: {\n    ...theme,\n    edge: {\n      ...theme.edge,\n      label: {\n        ...theme.edge.label,\n        fontSize: theme.edge.label.fontSize ?? 6\n      }\n    }\n  },\n  edges: [],\n  nodes: [],\n  collapsedNodeIds,\n  clusters: /* @__PURE__ */ new Map(),\n  panning: false,\n  draggingIds: [],\n  actives,\n  edgeContextMenus: /* @__PURE__ */ new Set(),\n  edgeMeshes: [],\n  selections,\n  hoveredNodeId: null,\n  drags: {},\n  graph: new graphology__WEBPACK_IMPORTED_MODULE_9__[\"default\"]({ multi: true }),\n  setTheme: (theme2) => set((state) => ({ ...state, theme: theme2 })),\n  setClusters: (clusters) => set((state) => ({ ...state, clusters })),\n  setEdgeContextMenus: (edgeContextMenus) => set((state) => ({\n    ...state,\n    edgeContextMenus\n  })),\n  setEdgeMeshes: (edgeMeshes) => set((state) => ({ ...state, edgeMeshes })),\n  setPanning: (panning) => set((state) => ({ ...state, panning })),\n  setDrags: (drags) => set((state) => ({ ...state, drags })),\n  addDraggingId: (id) => set((state) => ({ ...state, draggingIds: [...state.draggingIds, id] })),\n  removeDraggingId: (id) => set((state) => ({\n    ...state,\n    draggingIds: state.draggingIds.filter((drag) => drag !== id)\n  })),\n  setActives: (actives2) => set((state) => ({ ...state, actives: actives2 })),\n  setSelections: (selections2) => set((state) => ({ ...state, selections: selections2 })),\n  setHoveredNodeId: (hoveredNodeId) => set((state) => ({ ...state, hoveredNodeId })),\n  setNodes: (nodes) => set((state) => ({\n    ...state,\n    nodes,\n    centerPosition: getLayoutCenter(nodes)\n  })),\n  setEdges: (edges) => set((state) => ({ ...state, edges })),\n  setNodePosition: (id, position) => set((state) => {\n    var _a2, _b2;\n    const node = state.nodes.find((n) => n.id === id);\n    const originalVector = getVector(node);\n    const newVector = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(position.x, position.y, position.z);\n    const offset = newVector.sub(originalVector);\n    const nodes = [...state.nodes];\n    if ((_a2 = state.selections) == null ? void 0 : _a2.includes(id)) {\n      (_b2 = state.selections) == null ? void 0 : _b2.forEach((id2) => {\n        const node2 = state.nodes.find((n) => n.id === id2);\n        if (node2) {\n          const nodeIndex = state.nodes.indexOf(node2);\n          nodes[nodeIndex] = updateNodePosition(node2, offset);\n        }\n      });\n    } else {\n      const nodeIndex = state.nodes.indexOf(node);\n      nodes[nodeIndex] = updateNodePosition(node, offset);\n    }\n    return {\n      ...state,\n      drags: {\n        ...state.drags,\n        [id]: node\n      },\n      nodes\n    };\n  }),\n  setCollapsedNodeIds: (nodeIds = []) => set((state) => ({ ...state, collapsedNodeIds: nodeIds })),\n  // Update the position of a cluster with nodes inside it\n  setClusterPosition: (id, position) => set((state) => {\n    const clusters = new Map(state.clusters);\n    const cluster = clusters.get(id);\n    if (cluster) {\n      const oldPos = cluster.position;\n      const offset = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(\n        position.x - oldPos.x,\n        position.y - oldPos.y,\n        position.z - (oldPos.z ?? 0)\n      );\n      const nodes = [...state.nodes];\n      const drags = { ...state.drags };\n      nodes.forEach((node, index) => {\n        if (node.cluster === id) {\n          nodes[index] = {\n            ...node,\n            position: {\n              ...node.position,\n              x: node.position.x + offset.x,\n              y: node.position.y + offset.y,\n              z: node.position.z + (offset.z ?? 0)\n            }\n          };\n          drags[node.id] = node;\n        }\n      });\n      const clusterNodes = nodes.filter(\n        (node) => node.cluster === id\n      );\n      const newClusterPosition = getLayoutCenter(clusterNodes);\n      clusters.set(id, {\n        ...cluster,\n        position: newClusterPosition\n      });\n      return {\n        ...state,\n        drags: {\n          ...drags,\n          [id]: cluster\n        },\n        clusters,\n        nodes\n      };\n    }\n    return state;\n  })\n}));\nfunction getHiddenChildren({\n  nodeId,\n  nodes,\n  edges,\n  currentHiddenNodes,\n  currentHiddenEdges\n}) {\n  const hiddenNodes = [];\n  const hiddenEdges = [];\n  const curHiddenNodeIds = currentHiddenNodes.map((n) => n.id);\n  const curHiddenEdgeIds = currentHiddenEdges.map((e) => e.id);\n  const outboundEdges = edges.filter((l) => l.source === nodeId);\n  const outboundEdgeNodeIds = outboundEdges.map((l) => l.target);\n  hiddenEdges.push(...outboundEdges);\n  for (const outboundEdgeNodeId of outboundEdgeNodeIds) {\n    const incomingEdges = edges.filter(\n      (l) => l.target === outboundEdgeNodeId && l.source !== nodeId\n    );\n    let hideNode = false;\n    if (incomingEdges.length === 0) {\n      hideNode = true;\n    } else if (incomingEdges.length > 0 && !curHiddenNodeIds.includes(outboundEdgeNodeId)) {\n      const inboundNodeLinkIds = incomingEdges.map((l) => l.id);\n      if (inboundNodeLinkIds.every((i) => curHiddenEdgeIds.includes(i))) {\n        hideNode = true;\n      }\n    }\n    if (hideNode) {\n      const node = nodes.find((n) => n.id === outboundEdgeNodeId);\n      if (node) {\n        hiddenNodes.push(node);\n      }\n      const nested = getHiddenChildren({\n        nodeId: outboundEdgeNodeId,\n        nodes,\n        edges,\n        currentHiddenEdges: hiddenEdges,\n        currentHiddenNodes: hiddenNodes\n      });\n      hiddenEdges.push(...nested.hiddenEdges);\n      hiddenNodes.push(...nested.hiddenNodes);\n    }\n  }\n  const uniqueEdges = Object.values(\n    hiddenEdges.reduce(\n      (acc, next) => ({\n        ...acc,\n        [next.id]: next\n      }),\n      {}\n    )\n  );\n  const uniqueNodes = Object.values(\n    hiddenNodes.reduce(\n      (acc, next) => ({\n        ...acc,\n        [next.id]: next\n      }),\n      {}\n    )\n  );\n  return {\n    hiddenEdges: uniqueEdges,\n    hiddenNodes: uniqueNodes\n  };\n}\nconst getVisibleEntities = ({\n  collapsedIds,\n  nodes,\n  edges\n}) => {\n  const curHiddenNodes = [];\n  const curHiddenEdges = [];\n  for (const collapsedId of collapsedIds) {\n    const { hiddenEdges, hiddenNodes } = getHiddenChildren({\n      nodeId: collapsedId,\n      nodes,\n      edges,\n      currentHiddenEdges: curHiddenEdges,\n      currentHiddenNodes: curHiddenNodes\n    });\n    curHiddenNodes.push(...hiddenNodes);\n    curHiddenEdges.push(...hiddenEdges);\n  }\n  const hiddenNodeIds = curHiddenNodes.map((n) => n.id);\n  const hiddenEdgeIds = curHiddenEdges.map((e) => e.id);\n  const visibleNodes = nodes.filter((n) => !hiddenNodeIds.includes(n.id));\n  const visibleEdges = edges.filter((e) => !hiddenEdgeIds.includes(e.id));\n  return {\n    visibleNodes,\n    visibleEdges\n  };\n};\nconst getExpandPath = ({\n  nodeId,\n  edges,\n  visibleEdgeIds\n}) => {\n  const parentIds = [];\n  const inboundEdges = edges.filter((l) => l.target === nodeId);\n  const inboundEdgeIds = inboundEdges.map((e) => e.id);\n  const hasVisibleInboundEdge = inboundEdgeIds.some(\n    (id) => visibleEdgeIds.includes(id)\n  );\n  if (hasVisibleInboundEdge) {\n    return parentIds;\n  }\n  const inboundEdgeNodeIds = inboundEdges.map((l) => l.source);\n  let addedParent = false;\n  for (const inboundNodeId of inboundEdgeNodeIds) {\n    if (!addedParent) {\n      parentIds.push(\n        ...[\n          inboundNodeId,\n          ...getExpandPath({ nodeId: inboundNodeId, edges, visibleEdgeIds })\n        ]\n      );\n      addedParent = true;\n    }\n  }\n  return parentIds;\n};\nconst useCollapse = ({\n  collapsedNodeIds = [],\n  nodes = [],\n  edges = []\n}) => {\n  const getIsCollapsed = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nodeId) => {\n      const { visibleNodes } = getVisibleEntities({\n        nodes,\n        edges,\n        collapsedIds: collapsedNodeIds\n      });\n      const visibleNodeIds = visibleNodes.map((n) => n.id);\n      return !visibleNodeIds.includes(nodeId);\n    },\n    [collapsedNodeIds, edges, nodes]\n  );\n  const getExpandPathIds = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nodeId) => {\n      const { visibleEdges } = getVisibleEntities({\n        nodes,\n        edges,\n        collapsedIds: collapsedNodeIds\n      });\n      const visibleEdgeIds = visibleEdges.map((e) => e.id);\n      return getExpandPath({ nodeId, edges, visibleEdgeIds });\n    },\n    [collapsedNodeIds, edges, nodes]\n  );\n  return {\n    getIsCollapsed,\n    getExpandPathIds\n  };\n};\nconst useGraph = ({\n  layoutType,\n  sizingType,\n  labelType,\n  sizingAttribute,\n  clusterAttribute,\n  selections,\n  nodes,\n  edges,\n  actives,\n  collapsedNodeIds,\n  defaultNodeSize,\n  maxNodeSize,\n  minNodeSize,\n  layoutOverrides,\n  constrainDragging\n}) => {\n  const graph = useStore((state) => state.graph);\n  const clusters = useStore((state) => state.clusters);\n  const storedNodes = useStore((state) => state.nodes);\n  const setClusters = useStore((state) => state.setClusters);\n  const stateCollapsedNodeIds = useStore((state) => state.collapsedNodeIds);\n  const setEdges = useStore((state) => state.setEdges);\n  const stateNodes = useStore((state) => state.nodes);\n  const setNodes = useStore((state) => state.setNodes);\n  const setSelections = useStore((state) => state.setSelections);\n  const setActives = useStore((state) => state.setActives);\n  const drags = useStore((state) => state.drags);\n  const setDrags = useStore((state) => state.setDrags);\n  const setCollapsedNodeIds = useStore((state) => state.setCollapsedNodeIds);\n  const layoutMounted = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const layout = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const camera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.camera);\n  const dragRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(drags);\n  const clustersRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)([]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    var _a2;\n    if (!clusterAttribute) {\n      return;\n    }\n    const existedNodesIds = storedNodes.map((n) => n.id);\n    const newNode = nodes.find((n) => !existedNodesIds.includes(n.id));\n    if (newNode) {\n      const clusterName = newNode.data[clusterAttribute];\n      const cluster = clusters.get(clusterName);\n      const drags2 = { ...dragRef.current };\n      (_a2 = cluster == null ? void 0 : cluster.nodes) == null ? void 0 : _a2.forEach((node) => drags2[node.id] = void 0);\n      dragRef.current = drags2;\n      setDrags(drags2);\n    }\n  }, [storedNodes, nodes, clusterAttribute, clusters, setDrags]);\n  const { visibleEdges, visibleNodes } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => getVisibleEntities({\n      collapsedIds: stateCollapsedNodeIds,\n      nodes,\n      edges\n    }),\n    [stateCollapsedNodeIds, nodes, edges]\n  );\n  const updateDrags = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nodes2) => {\n      const drags2 = { ...dragRef.current };\n      nodes2.forEach((node) => drags2[node.id] = node);\n      dragRef.current = drags2;\n      setDrags(drags2);\n    },\n    [setDrags]\n  );\n  const updateLayout = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    async (curLayout) => {\n      layout.current = curLayout || layoutProvider({\n        ...layoutOverrides,\n        type: layoutType,\n        graph,\n        drags: dragRef.current,\n        clusters: clustersRef == null ? void 0 : clustersRef.current,\n        clusterAttribute\n      });\n      await tick(layout.current);\n      const result = transformGraph({\n        graph,\n        layout: layout.current,\n        sizingType,\n        labelType,\n        sizingAttribute,\n        maxNodeSize,\n        minNodeSize,\n        defaultNodeSize,\n        clusterAttribute\n      });\n      const newClusters = calculateClusters({\n        nodes: result.nodes,\n        clusterAttribute\n      });\n      if (constrainDragging) {\n        newClusters.forEach((cluster) => {\n          var _a2, _b2;\n          const prevCluster = clustersRef.current.get(cluster.label);\n          if ((prevCluster == null ? void 0 : prevCluster.nodes.length) === cluster.nodes.length) {\n            cluster.position = ((_b2 = (_a2 = clustersRef.current) == null ? void 0 : _a2.get(cluster.label)) == null ? void 0 : _b2.position) ?? cluster.position;\n          }\n        });\n      }\n      setEdges(result.edges);\n      setNodes(result.nodes);\n      setClusters(newClusters);\n      if (clusterAttribute) {\n        updateDrags(result.nodes);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      layoutOverrides,\n      layoutType,\n      clusterAttribute,\n      sizingType,\n      labelType,\n      sizingAttribute,\n      maxNodeSize,\n      minNodeSize,\n      defaultNodeSize,\n      setEdges,\n      setNodes,\n      setClusters\n    ]\n  );\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    dragRef.current = drags;\n  }, [drags, clusterAttribute, updateLayout]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    clustersRef.current = clusters;\n  }, [clusters]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const nodes2 = stateNodes.map((node) => ({\n      ...node,\n      labelVisible: calcLabelVisibility({\n        nodeCount: stateNodes == null ? void 0 : stateNodes.length,\n        labelType,\n        camera,\n        nodePosition: node == null ? void 0 : node.position\n      })(\"node\", node == null ? void 0 : node.size)\n    }));\n    const isVisibilityUpdated = nodes2.some(\n      (node, i) => node.labelVisible !== stateNodes[i].labelVisible\n    );\n    if (isVisibilityUpdated) {\n      setNodes(nodes2);\n    }\n  }, [camera, camera.zoom, camera.position.z, setNodes, stateNodes, labelType]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (layoutMounted.current) {\n      setSelections(selections);\n    }\n  }, [selections, setSelections]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (layoutMounted.current) {\n      setActives(actives);\n    }\n  }, [actives, setActives]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    async function update() {\n      layoutMounted.current = false;\n      buildGraph(graph, visibleNodes, visibleEdges);\n      await updateLayout();\n      requestAnimationFrame(() => layoutMounted.current = true);\n    }\n    update();\n  }, [visibleNodes, visibleEdges]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (layoutMounted.current) {\n      setCollapsedNodeIds(collapsedNodeIds);\n    }\n  }, [collapsedNodeIds, setCollapsedNodeIds]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (layoutMounted.current) {\n      dragRef.current = {};\n      setDrags({});\n      updateLayout();\n    }\n  }, [layoutType, updateLayout, setDrags]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (layoutMounted.current) {\n      updateLayout(layout.current);\n    }\n  }, [sizingType, sizingAttribute, labelType, updateLayout]);\n  return {\n    updateLayout\n  };\n};\nconst Label = ({\n  text,\n  fontSize = 7,\n  fontUrl,\n  color = \"#2A6475\",\n  opacity = 1,\n  stroke,\n  active,\n  ellipsis = 75,\n  rotation\n}) => {\n  const shortText = ellipsis && !active ? ellipsize__WEBPACK_IMPORTED_MODULE_10__(text, ellipsis) : text;\n  const normalizedColor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new three__WEBPACK_IMPORTED_MODULE_30__.Color(color), [color]);\n  const normalizedStroke = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => stroke ? new three__WEBPACK_IMPORTED_MODULE_30__.Color(stroke) : void 0,\n    [stroke]\n  );\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(glodrei__WEBPACK_IMPORTED_MODULE_35__.Billboard, { position: [0, 0, 1], children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    glodrei__WEBPACK_IMPORTED_MODULE_36__.Text,\n    {\n      font: fontUrl,\n      fontSize,\n      color: normalizedColor,\n      fillOpacity: opacity,\n      textAlign: \"center\",\n      outlineWidth: stroke ? 1 : 0,\n      outlineColor: normalizedStroke,\n      depthOffset: 0,\n      maxWidth: 100,\n      overflowWrap: \"break-word\",\n      rotation,\n      children: shortText\n    }\n  ) });\n};\nconst Ring$1 = ({\n  color = \"#D8E6EA\",\n  size = 1,\n  opacity = 0.5,\n  animated,\n  strokeWidth = 5,\n  innerRadius = 4,\n  segments = 25\n}) => {\n  const normalizedColor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new three__WEBPACK_IMPORTED_MODULE_30__.Color(color), [color]);\n  const { ringSize, ringOpacity } = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)({\n    from: {\n      ringOpacity: 0,\n      ringSize: [1e-5, 1e-5, 1e-5]\n    },\n    to: {\n      ringOpacity: opacity,\n      ringSize: [size / 2, size / 2, 1]\n    },\n    config: {\n      ...animationConfig,\n      duration: animated ? void 0 : 0\n    }\n  });\n  const strokeWidthFraction = strokeWidth / 10;\n  const outerRadius = innerRadius + strokeWidthFraction;\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(glodrei__WEBPACK_IMPORTED_MODULE_35__.Billboard, { position: [0, 0, 1], children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.mesh, { scale: ringSize, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      \"ringGeometry\",\n      {\n        attach: \"geometry\",\n        args: [innerRadius, outerRadius, segments]\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n      {\n        attach: \"material\",\n        color: normalizedColor,\n        transparent: true,\n        depthTest: false,\n        opacity: ringOpacity,\n        side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n        fog: true\n      }\n    )\n  ] }) });\n};\nconst Sphere = ({\n  color,\n  id,\n  size,\n  selected,\n  opacity = 1,\n  animated\n}) => {\n  const { scale, nodeOpacity } = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)({\n    from: {\n      // Note: This prevents incorrect scaling w/ 0\n      scale: [1e-5, 1e-5, 1e-5],\n      nodeOpacity: 0\n    },\n    to: {\n      scale: [size, size, size],\n      nodeOpacity: opacity\n    },\n    config: {\n      ...animationConfig,\n      duration: animated ? void 0 : 0\n    }\n  });\n  const normalizedColor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new three__WEBPACK_IMPORTED_MODULE_30__.Color(color), [color]);\n  const theme = useStore((state) => state.theme);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.mesh, { userData: { id, type: \"node\" }, scale, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"sphereGeometry\", { attach: \"geometry\", args: [1, 25, 25] }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshPhongMaterial,\n        {\n          attach: \"material\",\n          side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n          transparent: true,\n          fog: true,\n          opacity: nodeOpacity,\n          color: normalizedColor\n        }\n      )\n    ] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      Ring$1,\n      {\n        opacity: selected ? 0.5 : 0,\n        size,\n        animated,\n        color: selected ? theme.ring.activeFill : theme.ring.fill\n      }\n    )\n  ] });\n};\nconst CameraControlsContext = (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)({\n  controls: null,\n  resetControls: () => void 0,\n  zoomIn: () => void 0,\n  zoomOut: () => void 0,\n  dollyIn: () => void 0,\n  dollyOut: () => void 0,\n  panLeft: () => void 0,\n  panRight: () => void 0,\n  panUp: () => void 0,\n  panDown: () => void 0,\n  freeze: () => void 0,\n  unFreeze: () => void 0\n});\nconst useCameraControls = () => {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(CameraControlsContext);\n  if (context === void 0) {\n    throw new Error(\n      \"`useCameraControls` hook must be used within a `ControlsProvider` component\"\n    );\n  }\n  return context;\n};\ncamera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].install({\n  THREE: {\n    MOUSE: three__WEBPACK_IMPORTED_MODULE_30__.MOUSE,\n    Vector2: three__WEBPACK_IMPORTED_MODULE_30__.Vector2,\n    Vector3: three__WEBPACK_IMPORTED_MODULE_30__.Vector3,\n    Vector4: three__WEBPACK_IMPORTED_MODULE_30__.Vector4,\n    Quaternion: three__WEBPACK_IMPORTED_MODULE_30__.Quaternion,\n    Matrix4: three__WEBPACK_IMPORTED_MODULE_30__.Matrix4,\n    Spherical: three__WEBPACK_IMPORTED_MODULE_30__.Spherical,\n    Box3: three__WEBPACK_IMPORTED_MODULE_30__.Box3,\n    Sphere: three__WEBPACK_IMPORTED_MODULE_30__.Sphere,\n    Raycaster: three__WEBPACK_IMPORTED_MODULE_30__.Raycaster,\n    MathUtils: {\n      DEG2RAD: (_a = three__WEBPACK_IMPORTED_MODULE_30__.MathUtils) == null ? void 0 : _a.DEG2RAD,\n      clamp: (_b = three__WEBPACK_IMPORTED_MODULE_30__.MathUtils) == null ? void 0 : _b.clamp\n    }\n  }\n});\n(0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.e)({ ThreeCameraControls: camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"] });\nconst KEY_CODES = {\n  ARROW_LEFT: 37,\n  ARROW_UP: 38,\n  ARROW_RIGHT: 39,\n  ARROW_DOWN: 40\n};\nconst leftKey = new hold_event__WEBPACK_IMPORTED_MODULE_14__.KeyboardKeyHold(KEY_CODES.ARROW_LEFT, 100);\nconst rightKey = new hold_event__WEBPACK_IMPORTED_MODULE_14__.KeyboardKeyHold(KEY_CODES.ARROW_RIGHT, 100);\nconst upKey = new hold_event__WEBPACK_IMPORTED_MODULE_14__.KeyboardKeyHold(KEY_CODES.ARROW_UP, 100);\nconst downKey = new hold_event__WEBPACK_IMPORTED_MODULE_14__.KeyboardKeyHold(KEY_CODES.ARROW_DOWN, 100);\nconst CameraControls = (0,react__WEBPACK_IMPORTED_MODULE_1__.forwardRef)(\n  ({\n    mode = \"rotate\",\n    children,\n    animated,\n    disabled: disabled2,\n    minDistance = 1e3,\n    maxDistance = 5e4\n  }, ref) => {\n    const cameraRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const camera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.camera);\n    const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.gl);\n    const isOrbiting = mode === \"orbit\";\n    const setPanning = useStore((state) => state.setPanning);\n    const isDragging = useStore((state) => state.draggingIds.length > 0);\n    const cameraSpeedRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.A)((_state, delta) => {\n      var _a2, _b2;\n      if ((_a2 = cameraRef.current) == null ? void 0 : _a2.enabled) {\n        (_b2 = cameraRef.current) == null ? void 0 : _b2.update(delta);\n      }\n      if (isOrbiting) {\n        cameraRef.current.azimuthAngle += 20 * delta * three__WEBPACK_IMPORTED_MODULE_30__.MathUtils.DEG2RAD;\n      }\n    }, -1);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => () => {\n      var _a2;\n      return (_a2 = cameraRef.current) == null ? void 0 : _a2.dispose();\n    }, []);\n    const zoomIn = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n      var _a2;\n      (_a2 = cameraRef.current) == null ? void 0 : _a2.zoom(camera.zoom / 2, animated);\n    }, [animated, camera.zoom]);\n    const zoomOut = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n      var _a2;\n      (_a2 = cameraRef.current) == null ? void 0 : _a2.zoom(-camera.zoom / 2, animated);\n    }, [animated, camera.zoom]);\n    const dollyIn = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (distance) => {\n        var _a2;\n        (_a2 = cameraRef.current) == null ? void 0 : _a2.dolly(distance, animated);\n      },\n      [animated]\n    );\n    const dollyOut = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (distance) => {\n        var _a2;\n        (_a2 = cameraRef.current) == null ? void 0 : _a2.dolly(distance, animated);\n      },\n      [animated]\n    );\n    const panRight = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (event) => {\n        var _a2;\n        if (!isOrbiting) {\n          (_a2 = cameraRef.current) == null ? void 0 : _a2.truck(-0.03 * event.deltaTime, 0, animated);\n        }\n      },\n      [animated, isOrbiting]\n    );\n    const panLeft = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (event) => {\n        var _a2;\n        if (!isOrbiting) {\n          (_a2 = cameraRef.current) == null ? void 0 : _a2.truck(0.03 * event.deltaTime, 0, animated);\n        }\n      },\n      [animated, isOrbiting]\n    );\n    const panUp = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (event) => {\n        var _a2;\n        if (!isOrbiting) {\n          (_a2 = cameraRef.current) == null ? void 0 : _a2.truck(0, 0.03 * event.deltaTime, animated);\n        }\n      },\n      [animated, isOrbiting]\n    );\n    const panDown = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (event) => {\n        var _a2;\n        if (!isOrbiting) {\n          (_a2 = cameraRef.current) == null ? void 0 : _a2.truck(0, -0.03 * event.deltaTime, animated);\n        }\n      },\n      [animated, isOrbiting]\n    );\n    const onKeyDown = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (event) => {\n        if (event.code === \"Space\") {\n          if (mode === \"rotate\") {\n            cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.TRUCK;\n          } else {\n            cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.ROTATE;\n          }\n        }\n      },\n      [mode]\n    );\n    const onKeyUp = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (event) => {\n        if (event.code === \"Space\") {\n          if (mode === \"rotate\") {\n            cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.ROTATE;\n          } else {\n            cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.TRUCK;\n          }\n        }\n      },\n      [mode]\n    );\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n      if (!disabled2) {\n        leftKey.addEventListener(\"holding\", panLeft);\n        rightKey.addEventListener(\"holding\", panRight);\n        upKey.addEventListener(\"holding\", panUp);\n        downKey.addEventListener(\"holding\", panDown);\n        if (typeof window !== \"undefined\") {\n          window.addEventListener(\"keydown\", onKeyDown);\n          window.addEventListener(\"keyup\", onKeyUp);\n        }\n      }\n      return () => {\n        leftKey.removeEventListener(\"holding\", panLeft);\n        rightKey.removeEventListener(\"holding\", panRight);\n        upKey.removeEventListener(\"holding\", panUp);\n        downKey.removeEventListener(\"holding\", panDown);\n        if (typeof window !== \"undefined\") {\n          window.removeEventListener(\"keydown\", onKeyDown);\n          window.removeEventListener(\"keyup\", onKeyUp);\n        }\n      };\n    }, [disabled2, onKeyDown, onKeyUp, panDown, panLeft, panRight, panUp]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n      if (disabled2) {\n        cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.NONE;\n        cameraRef.current.mouseButtons.middle = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.NONE;\n        cameraRef.current.mouseButtons.wheel = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.NONE;\n      } else {\n        cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.TRUCK;\n        cameraRef.current.mouseButtons.middle = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.TRUCK;\n        cameraRef.current.mouseButtons.wheel = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.DOLLY;\n      }\n    }, [disabled2]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n      const onControl = () => setPanning(true);\n      const onControlEnd = () => setPanning(false);\n      const ref2 = cameraRef.current;\n      if (ref2) {\n        ref2.addEventListener(\"control\", onControl);\n        ref2.addEventListener(\"controlend\", onControlEnd);\n      }\n      return () => {\n        if (ref2) {\n          ref2.removeEventListener(\"control\", onControl);\n          ref2.removeEventListener(\"controlend\", onControlEnd);\n        }\n      };\n    }, [cameraRef, setPanning]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n      if (isDragging) {\n        cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.NONE;\n        cameraRef.current.touches.one = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.NONE;\n      } else {\n        if (mode === \"rotate\") {\n          cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.ROTATE;\n          cameraRef.current.touches.one = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.TOUCH_ROTATE;\n        } else {\n          cameraRef.current.touches.one = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.TOUCH_TRUCK;\n          cameraRef.current.mouseButtons.left = camera_controls__WEBPACK_IMPORTED_MODULE_12__[\"default\"].ACTION.TRUCK;\n        }\n      }\n    }, [isDragging, mode]);\n    (0,reakeys__WEBPACK_IMPORTED_MODULE_13__.useHotkeys)([\n      {\n        name: \"Zoom In\",\n        disabled: disabled2,\n        category: \"Graph\",\n        keys: \"command+shift+i\",\n        callback: (event) => {\n          event.preventDefault();\n          zoomIn();\n        }\n      },\n      {\n        name: \"Zoom Out\",\n        category: \"Graph\",\n        disabled: disabled2,\n        keys: \"command+shift+o\",\n        callback: (event) => {\n          event.preventDefault();\n          zoomOut();\n        }\n      }\n    ]);\n    const values = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n      () => ({\n        controls: cameraRef.current,\n        zoomIn: () => zoomIn(),\n        zoomOut: () => zoomOut(),\n        dollyIn: (distance = 1e3) => dollyIn(distance),\n        dollyOut: (distance = -1e3) => dollyOut(distance),\n        panLeft: (deltaTime = 100) => panLeft({ deltaTime }),\n        panRight: (deltaTime = 100) => panRight({ deltaTime }),\n        panDown: (deltaTime = 100) => panDown({ deltaTime }),\n        panUp: (deltaTime = 100) => panUp({ deltaTime }),\n        resetControls: (animated2) => {\n          var _a2;\n          return (_a2 = cameraRef.current) == null ? void 0 : _a2.reset(animated2);\n        },\n        freeze: () => {\n          if (cameraRef.current.truckSpeed) {\n            cameraSpeedRef.current = cameraRef.current.truckSpeed;\n          }\n          cameraRef.current.truckSpeed = 0;\n        },\n        unFreeze: () => cameraRef.current.truckSpeed = cameraSpeedRef.current\n      }),\n      // eslint-disable-next-line\n      [zoomIn, zoomOut, panLeft, panRight, panDown, panUp, cameraRef.current]\n    );\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle)(ref, () => values);\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(CameraControlsContext.Provider, { value: values, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        \"threeCameraControls\",\n        {\n          ref: cameraRef,\n          args: [camera, gl.domElement],\n          smoothTime: 0.1,\n          minDistance,\n          dollyToCursor: true,\n          maxDistance\n        }\n      ),\n      children\n    ] });\n  }\n);\nfunction visibleHeightAtZDepth(depth, camera) {\n  const cameraOffset = camera.position.z;\n  if (depth < cameraOffset)\n    depth -= cameraOffset;\n  else\n    depth += cameraOffset;\n  const vFOV = camera.fov / camera.zoom * Math.PI / 180;\n  return 2 * Math.tan(vFOV / 2) * Math.abs(depth);\n}\nfunction visibleWidthAtZDepth(depth, camera) {\n  const height = visibleHeightAtZDepth(depth, camera);\n  return height * camera.aspect;\n}\nfunction isNodeInView(camera, nodePosition) {\n  var _a2, _b2, _c, _d;\n  const visibleWidth = visibleWidthAtZDepth(1, camera);\n  const visibleHeight = visibleHeightAtZDepth(1, camera);\n  const visibleArea = {\n    x0: ((_a2 = camera == null ? void 0 : camera.position) == null ? void 0 : _a2.x) - visibleWidth / 2,\n    x1: ((_b2 = camera == null ? void 0 : camera.position) == null ? void 0 : _b2.x) + visibleWidth / 2,\n    y0: ((_c = camera == null ? void 0 : camera.position) == null ? void 0 : _c.y) - visibleHeight / 2,\n    y1: ((_d = camera == null ? void 0 : camera.position) == null ? void 0 : _d.y) + visibleHeight / 2\n  };\n  return (nodePosition == null ? void 0 : nodePosition.x) > visibleArea.x0 && (nodePosition == null ? void 0 : nodePosition.x) < visibleArea.x1 && (nodePosition == null ? void 0 : nodePosition.y) > visibleArea.y0 && (nodePosition == null ? void 0 : nodePosition.y) < visibleArea.y1;\n}\nfunction getClosestAxis(angle, axes) {\n  return axes.reduce(\n    (prev, curr) => Math.abs(curr - angle % Math.PI) < Math.abs(prev - angle % Math.PI) ? curr : prev\n  );\n}\nfunction getDegreesToClosest2dAxis(horizontalAngle, verticalAngle) {\n  const closestHorizontalAxis = getClosestAxis(horizontalAngle, [0, Math.PI]);\n  const closestVerticalAxis = getClosestAxis(verticalAngle, [\n    Math.PI / 2,\n    3 * Math.PI / 2\n  ]);\n  return {\n    horizontalRotation: closestHorizontalAxis - horizontalAngle % Math.PI,\n    verticalRotation: closestVerticalAxis - verticalAngle % Math.PI\n  };\n}\nconst PADDING = 50;\nconst useCenterGraph = ({\n  animated,\n  disabled: disabled2,\n  layoutType\n}) => {\n  const nodes = useStore((state) => state.nodes);\n  const [isCentered, setIsCentered] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n  const invalidate = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.invalidate);\n  const { controls } = useCameraControls();\n  const camera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.camera);\n  const mounted = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const centerNodes = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    async (nodes2, opts) => {\n      const animated2 = (opts == null ? void 0 : opts.animated) !== void 0 ? opts == null ? void 0 : opts.animated : true;\n      const centerOnlyIfNodesNotInView = (opts == null ? void 0 : opts.centerOnlyIfNodesNotInView) !== void 0 ? opts == null ? void 0 : opts.centerOnlyIfNodesNotInView : false;\n      if (!mounted.current || !centerOnlyIfNodesNotInView || centerOnlyIfNodesNotInView && (nodes2 == null ? void 0 : nodes2.some((node) => !isNodeInView(camera, node.position)))) {\n        const { x, y, z } = getLayoutCenter(nodes2);\n        await controls.setTarget(x, y, z, animated2);\n        if (!isCentered) {\n          setIsCentered(true);\n        }\n        invalidate();\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [invalidate, controls, nodes]\n  );\n  const fitNodesInView = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    async (nodes2, opts = { animated: true, fitOnlyIfNodesNotInView: false }) => {\n      const { fitOnlyIfNodesNotInView } = opts;\n      if (!fitOnlyIfNodesNotInView || fitOnlyIfNodesNotInView && (nodes2 == null ? void 0 : nodes2.some((node) => !isNodeInView(camera, node.position)))) {\n        const { minX, maxX, minY, maxY, minZ, maxZ } = getLayoutCenter(nodes2);\n        if (!layoutType.includes(\"3d\")) {\n          const { horizontalRotation, verticalRotation } = getDegreesToClosest2dAxis(\n            controls == null ? void 0 : controls.azimuthAngle,\n            controls == null ? void 0 : controls.polarAngle\n          );\n          void (controls == null ? void 0 : controls.rotate(horizontalRotation, verticalRotation, true));\n        }\n        await (controls == null ? void 0 : controls.zoomTo(1, opts == null ? void 0 : opts.animated));\n        await (controls == null ? void 0 : controls.fitToBox(\n          new three__WEBPACK_IMPORTED_MODULE_30__.Box3(\n            new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(minX, minY, minZ),\n            new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(maxX, maxY, maxZ)\n          ),\n          opts == null ? void 0 : opts.animated,\n          {\n            cover: false,\n            paddingLeft: PADDING,\n            paddingRight: PADDING,\n            paddingBottom: PADDING,\n            paddingTop: PADDING\n          }\n        ));\n      }\n    },\n    [camera, controls, layoutType]\n  );\n  const getNodesById = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nodeIds) => {\n      let mappedNodes = null;\n      if (nodeIds == null ? void 0 : nodeIds.length) {\n        mappedNodes = nodeIds.reduce((acc, id) => {\n          const node = nodes.find((n) => n.id === id);\n          if (node) {\n            acc.push(node);\n          } else {\n            throw new Error(\n              `Attempted to center ${id} but it was not found in the nodes`\n            );\n          }\n          return acc;\n        }, []);\n      }\n      return mappedNodes;\n    },\n    [nodes]\n  );\n  const centerNodesById = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nodeIds, opts) => {\n      const mappedNodes = getNodesById(nodeIds);\n      centerNodes(mappedNodes || nodes, {\n        animated,\n        centerOnlyIfNodesNotInView: opts == null ? void 0 : opts.centerOnlyIfNodesNotInView\n      });\n    },\n    [animated, centerNodes, getNodesById, nodes]\n  );\n  const fitNodesInViewById = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    async (nodeIds, opts) => {\n      const mappedNodes = getNodesById(nodeIds);\n      await fitNodesInView(mappedNodes || nodes, { animated, ...opts });\n    },\n    [animated, fitNodesInView, getNodesById, nodes]\n  );\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect)(() => {\n    async function load() {\n      if (controls && (nodes == null ? void 0 : nodes.length)) {\n        if (!mounted.current) {\n          await centerNodes(nodes, { animated: false });\n          await fitNodesInView(nodes, { animated: false });\n          mounted.current = true;\n        }\n      }\n    }\n    load();\n  }, [controls, centerNodes, nodes, animated, camera, fitNodesInView]);\n  (0,reakeys__WEBPACK_IMPORTED_MODULE_13__.useHotkeys)([\n    {\n      name: \"Center\",\n      disabled: disabled2,\n      category: \"Graph\",\n      keys: [\"command+shift+c\"],\n      callback: () => centerNodes(nodes)\n    }\n  ]);\n  return { centerNodes, centerNodesById, fitNodesInViewById, isCentered };\n};\nconst Icon = ({\n  image,\n  id,\n  size,\n  opacity = 1,\n  animated\n}) => {\n  const texture = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new three__WEBPACK_IMPORTED_MODULE_30__.TextureLoader().load(image), [image]);\n  const { scale, spriteOpacity } = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)({\n    from: {\n      scale: [1e-5, 1e-5, 1e-5],\n      spriteOpacity: 0\n    },\n    to: {\n      scale: [size, size, size],\n      spriteOpacity: opacity\n    },\n    config: {\n      ...animationConfig,\n      duration: animated ? void 0 : 0\n    }\n  });\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.sprite, { userData: { id, type: \"node\" }, scale, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.spriteMaterial,\n    {\n      attach: \"material\",\n      opacity: spriteOpacity,\n      fog: true,\n      depthTest: false,\n      transparent: true,\n      side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n      children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"primitive\", { attach: \"map\", object: texture, minFilter: three__WEBPACK_IMPORTED_MODULE_30__.LinearFilter })\n    }\n  ) });\n};\nconst SphereWithIcon = ({\n  color,\n  id,\n  size,\n  opacity = 1,\n  node,\n  active = false,\n  animated,\n  image,\n  selected\n}) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n  /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    Sphere,\n    {\n      id,\n      selected,\n      size,\n      opacity,\n      animated,\n      color,\n      node,\n      active\n    }\n  ),\n  /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    Icon,\n    {\n      id,\n      image,\n      selected,\n      size: size + 8,\n      opacity,\n      animated,\n      color,\n      node,\n      active\n    }\n  )\n] });\nconst Svg = ({\n  id,\n  image,\n  color,\n  size,\n  opacity = 1,\n  animated,\n  ...rest\n}) => {\n  const normalizedSize = size / 25;\n  const { scale } = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)({\n    from: {\n      scale: [1e-5, 1e-5, 1e-5]\n    },\n    to: {\n      scale: [normalizedSize, normalizedSize, normalizedSize]\n    },\n    config: {\n      ...animationConfig,\n      duration: animated ? void 0 : 0\n    }\n  });\n  const normalizedColor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new three__WEBPACK_IMPORTED_MODULE_30__.Color(color), [color]);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group, { userData: { id, type: \"node\" }, scale, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(glodrei__WEBPACK_IMPORTED_MODULE_35__.Billboard, { position: [0, 0, 1], children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    glodrei__WEBPACK_IMPORTED_MODULE_37__.Svg,\n    {\n      ...rest,\n      src: image,\n      fillMaterial: {\n        fog: true,\n        depthTest: false,\n        transparent: true,\n        color: normalizedColor,\n        opacity,\n        side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n        ...rest.fillMaterial || {}\n      },\n      fillMeshProps: {\n        // Note: This is a hack to get the svg to\n        // render in the correct position.\n        position: [-25, -25, 1],\n        ...rest.fillMeshProps || {}\n      }\n    }\n  ) }) });\n};\nconst SphereWithSvg = ({\n  color,\n  id,\n  size,\n  opacity = 1,\n  node,\n  svgFill,\n  active = false,\n  animated,\n  image,\n  selected,\n  ...rest\n}) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n  /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    Sphere,\n    {\n      id,\n      selected,\n      size,\n      opacity,\n      animated,\n      color,\n      node,\n      active\n    }\n  ),\n  /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    Svg,\n    {\n      ...rest,\n      id,\n      selected,\n      image,\n      size,\n      opacity,\n      animated,\n      color: svgFill,\n      node,\n      active\n    }\n  )\n] });\nconst Node = ({\n  animated,\n  disabled: disabled2,\n  id,\n  draggable = false,\n  labelFontUrl,\n  contextMenu,\n  onClick,\n  onDoubleClick,\n  onPointerOver,\n  onDragged,\n  onPointerOut,\n  onContextMenu,\n  renderNode,\n  constrainDragging\n}) => {\n  var _a2, _b2, _c;\n  const cameraControls = useCameraControls();\n  const theme = useStore((state) => state.theme);\n  const node = useStore((state) => state.nodes.find((n) => n.id === id));\n  const edges = useStore((state) => state.edges);\n  const draggingIds = useStore((state) => state.draggingIds);\n  const collapsedNodeIds = useStore((state) => state.collapsedNodeIds);\n  const addDraggingId = useStore((state) => state.addDraggingId);\n  const removeDraggingId = useStore((state) => state.removeDraggingId);\n  const setHoveredNodeId = useStore((state) => state.setHoveredNodeId);\n  const setNodePosition = useStore((state) => state.setNodePosition);\n  const setCollapsedNodeIds = useStore((state) => state.setCollapsedNodeIds);\n  const isCollapsed = useStore((state) => state.collapsedNodeIds.includes(id));\n  const isActive = useStore((state) => {\n    var _a3;\n    return (_a3 = state.actives) == null ? void 0 : _a3.includes(id);\n  });\n  const isSelected = useStore((state) => {\n    var _a3;\n    return (_a3 = state.selections) == null ? void 0 : _a3.includes(id);\n  });\n  const hasSelections = useStore((state) => {\n    var _a3;\n    return ((_a3 = state.selections) == null ? void 0 : _a3.length) > 0;\n  });\n  const center = useStore((state) => state.centerPosition);\n  const cluster = useStore((state) => state.clusters.get(node.cluster));\n  const isDraggingCurrent = draggingIds.includes(id);\n  const isDragging = draggingIds.length > 0;\n  const {\n    position,\n    label,\n    subLabel,\n    size: nodeSize = 7,\n    labelVisible = true\n  } = node;\n  const group = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const [active, setActive] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n  const [menuVisible, setMenuVisible] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n  const shouldHighlight = active || isSelected || isActive;\n  const selectionOpacity = hasSelections ? shouldHighlight ? theme.node.selectedOpacity : theme.node.inactiveOpacity : theme.node.opacity;\n  const canCollapse = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    const outboundLinks = edges.filter((l) => l.source === id);\n    return outboundLinks.length > 0 || isCollapsed;\n  }, [edges, id, isCollapsed]);\n  const onCollapse = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    if (canCollapse) {\n      if (isCollapsed) {\n        setCollapsedNodeIds(collapsedNodeIds.filter((p) => p !== id));\n      } else {\n        setCollapsedNodeIds([...collapsedNodeIds, id]);\n      }\n    }\n  }, [canCollapse, collapsedNodeIds, id, isCollapsed, setCollapsedNodeIds]);\n  const [{ nodePosition, labelPosition, subLabelPosition }] = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)(\n    () => ({\n      from: {\n        nodePosition: center ? [center.x, center.y, 0] : [0, 0, 0],\n        labelPosition: [0, -(nodeSize + 7), 2],\n        subLabelPosition: [0, -(nodeSize + 14), 2]\n      },\n      to: {\n        nodePosition: position ? [\n          position.x,\n          position.y,\n          shouldHighlight ? position.z + 1 : position.z\n        ] : [0, 0, 0],\n        labelPosition: [0, -(nodeSize + 7), 2],\n        subLabelPosition: [0, -(nodeSize + 14), 2]\n      },\n      config: {\n        ...animationConfig,\n        duration: animated && !isDragging ? void 0 : 0\n      }\n    }),\n    [isDraggingCurrent, position, animated, nodeSize, shouldHighlight]\n  );\n  const bind = useDrag({\n    draggable,\n    position,\n    // If dragging is constrained to the cluster, use the cluster's position as the bounds\n    bounds: constrainDragging ? cluster == null ? void 0 : cluster.position : void 0,\n    // @ts-ignore\n    set: (pos) => setNodePosition(id, pos),\n    onDragStart: () => {\n      addDraggingId(id);\n      setActive(true);\n    },\n    onDragEnd: () => {\n      removeDraggingId(id);\n      onDragged == null ? void 0 : onDragged(node);\n    }\n  });\n  (0,glodrei__WEBPACK_IMPORTED_MODULE_38__.useCursor)(active && !isDragging && onClick !== void 0, \"pointer\");\n  (0,glodrei__WEBPACK_IMPORTED_MODULE_38__.useCursor)(\n    active && draggable && !isDraggingCurrent && onClick === void 0,\n    \"grab\"\n  );\n  (0,glodrei__WEBPACK_IMPORTED_MODULE_38__.useCursor)(isDraggingCurrent, \"grabbing\");\n  const combinedActiveState = shouldHighlight || isDraggingCurrent;\n  const color = combinedActiveState ? theme.node.activeFill : node.fill || theme.node.fill;\n  const { pointerOver, pointerOut } = useHoverIntent({\n    disabled: disabled2 || isDraggingCurrent,\n    onPointerOver: (event) => {\n      cameraControls.freeze();\n      setActive(true);\n      onPointerOver == null ? void 0 : onPointerOver(node, event);\n      setHoveredNodeId(id);\n    },\n    onPointerOut: (event) => {\n      cameraControls.unFreeze();\n      setActive(false);\n      onPointerOut == null ? void 0 : onPointerOut(node, event);\n      setHoveredNodeId(null);\n    }\n  });\n  const nodeComponent = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => renderNode ? renderNode({\n      id,\n      color,\n      size: nodeSize,\n      active: combinedActiveState,\n      opacity: selectionOpacity,\n      animated,\n      selected: isSelected,\n      node\n    }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: node.icon ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      Icon,\n      {\n        id,\n        image: node.icon || \"\",\n        size: nodeSize + 8,\n        opacity: selectionOpacity,\n        animated,\n        color,\n        node,\n        active: combinedActiveState,\n        selected: isSelected\n      }\n    ) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      Sphere,\n      {\n        id,\n        size: nodeSize,\n        opacity: selectionOpacity,\n        animated,\n        color,\n        node,\n        active: combinedActiveState,\n        selected: isSelected\n      }\n    ) }),\n    [\n      renderNode,\n      id,\n      color,\n      nodeSize,\n      combinedActiveState,\n      selectionOpacity,\n      animated,\n      isSelected,\n      node\n    ]\n  );\n  const labelComponent = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => {\n      var _a3, _b3, _c2;\n      return labelVisible && (labelVisible || isSelected || active) && label && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group, { position: labelPosition, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          Label,\n          {\n            text: label,\n            fontUrl: labelFontUrl,\n            opacity: selectionOpacity,\n            stroke: theme.node.label.stroke,\n            active: isSelected || active || isDraggingCurrent || isActive,\n            color: isSelected || active || isDraggingCurrent || isActive ? theme.node.label.activeColor : theme.node.label.color\n          }\n        ) }),\n        subLabel && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group, { position: subLabelPosition, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          Label,\n          {\n            text: subLabel,\n            fontUrl: labelFontUrl,\n            fontSize: 5,\n            opacity: selectionOpacity,\n            stroke: (_a3 = theme.node.subLabel) == null ? void 0 : _a3.stroke,\n            active: isSelected || active || isDraggingCurrent || isActive,\n            color: isSelected || active || isDraggingCurrent || isActive ? (_b3 = theme.node.subLabel) == null ? void 0 : _b3.activeColor : (_c2 = theme.node.subLabel) == null ? void 0 : _c2.color\n          }\n        ) })\n      ] });\n    },\n    [\n      active,\n      isActive,\n      isDraggingCurrent,\n      isSelected,\n      label,\n      labelFontUrl,\n      labelPosition,\n      labelVisible,\n      selectionOpacity,\n      subLabel,\n      subLabelPosition,\n      theme.node.label.activeColor,\n      theme.node.label.color,\n      theme.node.label.stroke,\n      (_a2 = theme.node.subLabel) == null ? void 0 : _a2.activeColor,\n      (_b2 = theme.node.subLabel) == null ? void 0 : _b2.color,\n      (_c = theme.node.subLabel) == null ? void 0 : _c.stroke\n    ]\n  );\n  const menuComponent = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => menuVisible && contextMenu && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(glodrei__WEBPACK_IMPORTED_MODULE_39__.Html, { prepend: true, center: true, children: contextMenu({\n      data: node,\n      canCollapse,\n      isCollapsed,\n      onCollapse,\n      onClose: () => setMenuVisible(false)\n    }) }),\n    [menuVisible, contextMenu, node, canCollapse, isCollapsed, onCollapse]\n  );\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\n    _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group,\n    {\n      renderOrder: 1,\n      userData: { id, type: \"node\" },\n      ref: group,\n      position: nodePosition,\n      onPointerOver: pointerOver,\n      onPointerOut: pointerOut,\n      onClick: (event) => {\n        if (!disabled2 && !isDraggingCurrent) {\n          onClick == null ? void 0 : onClick(\n            node,\n            {\n              canCollapse,\n              isCollapsed\n            },\n            event\n          );\n        }\n      },\n      onDoubleClick: (event) => {\n        if (!disabled2 && !isDraggingCurrent) {\n          onDoubleClick == null ? void 0 : onDoubleClick(node, event);\n        }\n      },\n      onContextMenu: () => {\n        if (!disabled2) {\n          setMenuVisible(true);\n          onContextMenu == null ? void 0 : onContextMenu(node, {\n            canCollapse,\n            isCollapsed,\n            onCollapse\n          });\n        }\n      },\n      ...bind(),\n      children: [\n        nodeComponent,\n        menuComponent,\n        labelComponent\n      ]\n    }\n  );\n};\nconst Arrow = ({\n  animated,\n  color = \"#D8E6EA\",\n  length,\n  opacity = 0.5,\n  position,\n  rotation,\n  size = 1,\n  onActive,\n  onContextMenu\n}) => {\n  const normalizedColor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new three__WEBPACK_IMPORTED_MODULE_30__.Color(color), [color]);\n  const meshRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const isDragging = useStore((state) => state.draggingIds.length > 0);\n  const center = useStore((state) => state.centerPosition);\n  const [{ pos, arrowOpacity }] = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)(\n    () => ({\n      from: {\n        pos: center ? [center.x, center.y, center.z] : [0, 0, 0],\n        arrowOpacity: 0\n      },\n      to: {\n        pos: [position.x, position.y, position.z],\n        arrowOpacity: opacity\n      },\n      config: {\n        ...animationConfig,\n        duration: animated && !isDragging ? void 0 : 0\n      }\n    }),\n    [animated, isDragging, opacity, position]\n  );\n  const setQuaternion = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    var _a2;\n    const axis = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(0, 1, 0);\n    (_a2 = meshRef.current) == null ? void 0 : _a2.quaternion.setFromUnitVectors(axis, rotation);\n  }, [rotation, meshRef]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => setQuaternion(), [setQuaternion]);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\n    _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.mesh,\n    {\n      position: pos,\n      ref: meshRef,\n      scale: [1, 1, 1],\n      onPointerOver: () => onActive(true),\n      onPointerOut: () => onActive(false),\n      onPointerDown: (event) => {\n        if (event.nativeEvent.buttons === 2) {\n          event.stopPropagation();\n          onContextMenu();\n        }\n      },\n      children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          \"cylinderGeometry\",\n          {\n            args: [0, size, length, 20, 1, true],\n            attach: \"geometry\"\n          }\n        ),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n          {\n            attach: \"material\",\n            color: normalizedColor,\n            depthTest: false,\n            opacity: arrowOpacity,\n            transparent: true,\n            side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n            fog: true\n          }\n        )\n      ]\n    }\n  );\n};\nconst Line = ({\n  curveOffset,\n  animated,\n  color = \"#000\",\n  curve,\n  curved = false,\n  id,\n  opacity = 1,\n  size = 1,\n  onContextMenu,\n  onClick,\n  onPointerOver,\n  onPointerOut\n}) => {\n  const tubeRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const isDragging = useStore((state) => state.draggingIds.length > 0);\n  const normalizedColor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new three__WEBPACK_IMPORTED_MODULE_30__.Color(color), [color]);\n  const center = useStore((state) => state.centerPosition);\n  const mounted = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const { lineOpacity } = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)({\n    from: {\n      lineOpacity: 0\n    },\n    to: {\n      lineOpacity: opacity\n    },\n    config: {\n      ...animationConfig,\n      duration: animated ? void 0 : 0\n    }\n  });\n  (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)(() => {\n    const from = curve.getPoint(0);\n    const to = curve.getPoint(1);\n    return {\n      from: {\n        // Animate from center first time, then from the actual from point\n        fromVertices: !mounted.current ? [center == null ? void 0 : center.x, center == null ? void 0 : center.y, (center == null ? void 0 : center.z) || 0] : [to == null ? void 0 : to.x, to == null ? void 0 : to.y, (to == null ? void 0 : to.z) || 0],\n        toVertices: [from == null ? void 0 : from.x, from == null ? void 0 : from.y, (from == null ? void 0 : from.z) || 0]\n      },\n      to: {\n        fromVertices: [from == null ? void 0 : from.x, from == null ? void 0 : from.y, (from == null ? void 0 : from.z) || 0],\n        toVertices: [to == null ? void 0 : to.x, to == null ? void 0 : to.y, (to == null ? void 0 : to.z) || 0]\n      },\n      onChange: (event) => {\n        const { fromVertices, toVertices } = event.value;\n        const fromVector = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(...fromVertices);\n        const toVector = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(...toVertices);\n        const curve2 = getCurve(fromVector, 0, toVector, 0, curved, curveOffset);\n        tubeRef.current.copy(new three__WEBPACK_IMPORTED_MODULE_30__.TubeGeometry(curve2, 20, size / 2, 5, false));\n      },\n      config: {\n        ...animationConfig,\n        duration: animated && !isDragging ? void 0 : 0\n      }\n    };\n  }, [animated, isDragging, curve, size]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    mounted.current = true;\n  }, []);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\n    \"mesh\",\n    {\n      userData: { id, type: \"edge\" },\n      onPointerOver,\n      onPointerOut,\n      onClick,\n      onPointerDown: (event) => {\n        if (event.nativeEvent.buttons === 2) {\n          event.stopPropagation();\n          onContextMenu();\n        }\n      },\n      children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"tubeGeometry\", { attach: \"geometry\", ref: tubeRef }),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n          {\n            attach: \"material\",\n            opacity: lineOpacity,\n            fog: true,\n            transparent: true,\n            depthTest: false,\n            color: normalizedColor\n          }\n        )\n      ]\n    }\n  );\n};\nconst LABEL_PLACEMENT_OFFSET = 3;\nconst Edge$1 = ({\n  animated,\n  arrowPlacement = \"end\",\n  contextMenu,\n  disabled: disabled2,\n  labelPlacement = \"inline\",\n  id,\n  interpolation,\n  labelFontUrl,\n  onContextMenu,\n  onClick,\n  onPointerOver,\n  onPointerOut\n}) => {\n  const theme = useStore((state) => state.theme);\n  const isDragging = useStore((state) => state.draggingIds.length > 0);\n  const [active, setActive] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n  const [menuVisible, setMenuVisible] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n  const edges = useStore((state) => state.edges);\n  const edge = edges.find((e) => e.id === id);\n  const { target, source, label, labelVisible = false, size = 1, fill } = edge;\n  const from = useStore((store) => store.nodes.find((node) => node.id === source));\n  const to = useStore((store) => store.nodes.find((node) => node.id === target));\n  const labelOffset = (size + theme.edge.label.fontSize) / 2;\n  const [arrowLength, arrowSize] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => getArrowSize(size), [size]);\n  const { curveOffset, curved } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => calculateEdgeCurveOffset({\n      edge,\n      edges,\n      curved: interpolation === \"curved\"\n    }),\n    [edge, edges, interpolation]\n  );\n  const [curve, arrowPosition, arrowRotation] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    const fromVector = getVector(from);\n    const fromOffset = from.size;\n    const toVector = getVector(to);\n    const toOffset = to.size;\n    let curve2 = getCurve(\n      fromVector,\n      fromOffset,\n      toVector,\n      toOffset,\n      curved,\n      curveOffset\n    );\n    const [arrowPosition2, arrowRotation2] = getArrowVectors(\n      arrowPlacement,\n      curve2,\n      arrowLength\n    );\n    if (arrowPlacement === \"end\") {\n      curve2 = getCurve(\n        fromVector,\n        fromOffset,\n        arrowPosition2,\n        0,\n        curved,\n        curveOffset\n      );\n    }\n    return [curve2, arrowPosition2, arrowRotation2];\n  }, [from, to, curved, curveOffset, arrowPlacement, arrowLength]);\n  const midPoint = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    let newMidPoint = getMidPoint(\n      from.position,\n      to.position,\n      getLabelOffsetByType(labelOffset, labelPlacement)\n    );\n    if (curved) {\n      const offset = new three__WEBPACK_IMPORTED_MODULE_30__.Vector3().subVectors(newMidPoint, curve.getPoint(0.5));\n      switch (labelPlacement) {\n        case \"above\":\n          offset.y = offset.y - LABEL_PLACEMENT_OFFSET;\n          break;\n        case \"below\":\n          offset.y = offset.y + LABEL_PLACEMENT_OFFSET;\n          break;\n      }\n      newMidPoint = newMidPoint.sub(offset);\n    }\n    return newMidPoint;\n  }, [from.position, to.position, labelOffset, labelPlacement, curved, curve]);\n  const isSelected = useStore((state) => {\n    var _a2;\n    return (_a2 = state.selections) == null ? void 0 : _a2.includes(id);\n  });\n  const hasSelections = useStore((state) => {\n    var _a2;\n    return (_a2 = state.selections) == null ? void 0 : _a2.length;\n  });\n  const isActive = useStore((state) => {\n    var _a2;\n    return (_a2 = state.actives) == null ? void 0 : _a2.includes(id);\n  });\n  const center = useStore((state) => state.centerPosition);\n  const selectionOpacity = hasSelections ? isSelected || isActive ? theme.edge.selectedOpacity : theme.edge.inactiveOpacity : theme.edge.opacity;\n  const [{ labelPosition }] = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)(\n    () => ({\n      from: {\n        labelPosition: center ? [center.x, center.y, center.z] : [0, 0, 0]\n      },\n      to: {\n        labelPosition: [midPoint.x, midPoint.y, midPoint.z]\n      },\n      config: {\n        ...animationConfig,\n        duration: animated && !isDragging ? void 0 : 0\n      }\n    }),\n    [midPoint, animated, isDragging]\n  );\n  const labelRotation = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => new three__WEBPACK_IMPORTED_MODULE_30__.Euler(\n      0,\n      0,\n      labelPlacement === \"natural\" ? 0 : Math.atan(\n        (to.position.y - from.position.y) / (to.position.x - from.position.x)\n      )\n    ),\n    [\n      to.position.x,\n      to.position.y,\n      from.position.x,\n      from.position.y,\n      labelPlacement\n    ]\n  );\n  (0,glodrei__WEBPACK_IMPORTED_MODULE_38__.useCursor)(active && !isDragging && onClick !== void 0, \"pointer\");\n  const { pointerOver, pointerOut } = useHoverIntent({\n    disabled: disabled2,\n    onPointerOver: (event) => {\n      setActive(true);\n      onPointerOver == null ? void 0 : onPointerOver(edge, event);\n    },\n    onPointerOut: (event) => {\n      setActive(false);\n      onPointerOut == null ? void 0 : onPointerOut(edge, event);\n    }\n  });\n  const arrowComponent = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => arrowPlacement !== \"none\" && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      Arrow,\n      {\n        animated,\n        color: isSelected || active || isActive ? theme.arrow.activeFill : fill || theme.arrow.fill,\n        length: arrowLength,\n        opacity: selectionOpacity,\n        position: arrowPosition,\n        rotation: arrowRotation,\n        size: arrowSize,\n        onActive: setActive,\n        onContextMenu: () => {\n          if (!disabled2) {\n            setMenuVisible(true);\n            onContextMenu == null ? void 0 : onContextMenu(edge);\n          }\n        }\n      }\n    ),\n    [\n      fill,\n      active,\n      animated,\n      arrowLength,\n      arrowPlacement,\n      arrowPosition,\n      arrowRotation,\n      arrowSize,\n      disabled2,\n      edge,\n      isActive,\n      isSelected,\n      onContextMenu,\n      selectionOpacity,\n      theme.arrow.activeFill,\n      theme.arrow.fill\n    ]\n  );\n  const labelComponent = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => labelVisible && label && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group,\n      {\n        position: labelPosition,\n        onContextMenu: () => {\n          if (!disabled2) {\n            setMenuVisible(true);\n            onContextMenu == null ? void 0 : onContextMenu(edge);\n          }\n        },\n        onPointerOver: pointerOver,\n        onPointerOut: pointerOut,\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          Label,\n          {\n            text: label,\n            ellipsis: 15,\n            fontUrl: labelFontUrl,\n            stroke: theme.edge.label.stroke,\n            color: isSelected || active || isActive ? theme.edge.label.activeColor : theme.edge.label.color,\n            opacity: selectionOpacity,\n            fontSize: theme.edge.label.fontSize,\n            rotation: labelRotation\n          }\n        )\n      }\n    ),\n    [\n      active,\n      disabled2,\n      edge,\n      isActive,\n      isSelected,\n      label,\n      labelFontUrl,\n      labelPosition,\n      labelRotation,\n      labelVisible,\n      onContextMenu,\n      pointerOut,\n      pointerOver,\n      selectionOpacity,\n      theme.edge.label.activeColor,\n      theme.edge.label.color,\n      theme.edge.label.fontSize,\n      theme.edge.label.stroke\n    ]\n  );\n  const menuComponent = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => menuVisible && contextMenu && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(glodrei__WEBPACK_IMPORTED_MODULE_39__.Html, { prepend: true, center: true, position: midPoint, children: contextMenu({ data: edge, onClose: () => setMenuVisible(false) }) }),\n    [menuVisible, contextMenu, midPoint, edge]\n  );\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"group\", { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      Line,\n      {\n        curveOffset,\n        animated,\n        color: isSelected || active || isActive ? theme.edge.activeFill : fill || theme.edge.fill,\n        curve,\n        curved,\n        id,\n        opacity: selectionOpacity,\n        size,\n        onClick: (event) => {\n          if (!disabled2) {\n            onClick == null ? void 0 : onClick(edge, event);\n          }\n        },\n        onPointerOver: pointerOver,\n        onPointerOut: pointerOut,\n        onContextMenu: () => {\n          if (!disabled2) {\n            setMenuVisible(true);\n            onContextMenu == null ? void 0 : onContextMenu(edge);\n          }\n        }\n      }\n    ),\n    arrowComponent,\n    labelComponent,\n    menuComponent\n  ] });\n};\nconst NULL_GEOMETRY = new three__WEBPACK_IMPORTED_MODULE_30__.BoxGeometry(0, 0, 0);\nfunction useEdgeGeometry(arrowPlacement, interpolation) {\n  const stateRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  const theme = useStore((state) => state.theme);\n  useStore((state) => {\n    stateRef.current = state;\n  });\n  const geometryCacheRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(/* @__PURE__ */ new Map());\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(new three__WEBPACK_IMPORTED_MODULE_30__.BoxGeometry(0, 0, 0));\n  const baseArrowGeometryRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  const curved = interpolation === \"curved\";\n  const getGeometries = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (edges) => {\n      const geometries = [];\n      const cache = geometryCacheRef.current;\n      const { nodes } = stateRef.current;\n      const nodesMap = new Map(nodes.map((node) => [node.id, node]));\n      const labelFontSize = theme.edge.label.fontSize;\n      if (arrowPlacement !== \"none\" && !baseArrowGeometryRef.current) {\n        baseArrowGeometryRef.current = new three__WEBPACK_IMPORTED_MODULE_30__.CylinderGeometry(\n          0,\n          1,\n          1,\n          20,\n          1,\n          true\n        );\n      }\n      edges.forEach((edge) => {\n        const { target, source, size = 1 } = edge;\n        const from = nodesMap.get(source);\n        const to = nodesMap.get(target);\n        if (!from || !to) {\n          return;\n        }\n        const hash = `${from.position.x},${from.position.y},${to.position.x},${to.position.y},${size}`;\n        if (cache.has(hash)) {\n          geometries.push(cache.get(hash));\n          return;\n        }\n        const fromVector = getVector(from);\n        const fromOffset = from.size + labelFontSize;\n        const toVector = getVector(to);\n        const toOffset = to.size + labelFontSize;\n        let curve = getCurve(\n          fromVector,\n          fromOffset,\n          toVector,\n          toOffset,\n          curved\n        );\n        let edgeGeometry = new three__WEBPACK_IMPORTED_MODULE_30__.TubeGeometry(curve, 20, size / 2, 5, false);\n        if (arrowPlacement === \"none\") {\n          geometries.push(edgeGeometry);\n          cache.set(hash, edgeGeometry);\n          return;\n        }\n        const [arrowLength, arrowSize] = getArrowSize(size);\n        const arrowGeometry = baseArrowGeometryRef.current.clone();\n        arrowGeometry.scale(arrowSize, arrowLength, arrowSize);\n        const [arrowPosition, arrowRotation] = getArrowVectors(\n          arrowPlacement,\n          curve,\n          arrowLength\n        );\n        const quaternion = new three__WEBPACK_IMPORTED_MODULE_30__.Quaternion();\n        quaternion.setFromUnitVectors(new three__WEBPACK_IMPORTED_MODULE_30__.Vector3(0, 1, 0), arrowRotation);\n        arrowGeometry.applyQuaternion(quaternion);\n        arrowGeometry.translate(\n          arrowPosition.x,\n          arrowPosition.y,\n          arrowPosition.z\n        );\n        if (arrowPlacement && arrowPlacement === \"end\") {\n          const curve2 = getCurve(\n            fromVector,\n            fromOffset,\n            arrowPosition,\n            0,\n            curved\n          );\n          edgeGeometry = new three__WEBPACK_IMPORTED_MODULE_30__.TubeGeometry(curve2, 20, size / 2, 5, false);\n        }\n        const merged = (0,three_stdlib__WEBPACK_IMPORTED_MODULE_40__.mergeBufferGeometries)([edgeGeometry, arrowGeometry]);\n        geometries.push(merged);\n        cache.set(hash, merged);\n      });\n      return geometries;\n    },\n    [arrowPlacement, curved, theme.edge.label.fontSize]\n  );\n  const getGeometry = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (active, inactive) => {\n      const activeGeometries = getGeometries(active);\n      const inactiveGeometries = getGeometries(inactive);\n      return (0,three_stdlib__WEBPACK_IMPORTED_MODULE_40__.mergeBufferGeometries)(\n        [\n          inactiveGeometries.length ? (0,three_stdlib__WEBPACK_IMPORTED_MODULE_40__.mergeBufferGeometries)(inactiveGeometries) : NULL_GEOMETRY,\n          activeGeometries.length ? (0,three_stdlib__WEBPACK_IMPORTED_MODULE_40__.mergeBufferGeometries)(activeGeometries) : NULL_GEOMETRY\n        ],\n        true\n      );\n    },\n    [getGeometries]\n  );\n  return {\n    getGeometries,\n    getGeometry\n  };\n}\nfunction useEdgeEvents(events, contextMenu, disabled2) {\n  const memoizedEvents = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(events);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    memoizedEvents.current = events;\n  }, [events]);\n  const edgeContextMenus = useStore((state) => state.edgeContextMenus);\n  const setEdgeContextMenus = useStore(\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((state) => state.setEdgeContextMenus, [])\n  );\n  const clickRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const handleClick = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    clickRef.current = true;\n  }, []);\n  const contextMenuEventRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const handleContextMenu = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    contextMenuEventRef.current = true;\n  }, []);\n  const handleIntersections = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (previous, intersected) => {\n      const { onClick, onContextMenu, onPointerOver, onPointerOut } = memoizedEvents.current;\n      if (onClick && clickRef.current && !disabled2) {\n        clickRef.current = false;\n        for (const edge of intersected) {\n          onClick(edge);\n        }\n      }\n      if ((contextMenu || onContextMenu) && contextMenuEventRef.current && !disabled2) {\n        contextMenuEventRef.current = false;\n        const newEdges = new Set(edgeContextMenus);\n        let hasChanges = false;\n        for (const edge of intersected) {\n          if (!edgeContextMenus.has(edge.id)) {\n            newEdges.add(edge.id);\n            hasChanges = true;\n            onContextMenu == null ? void 0 : onContextMenu(edge);\n          }\n        }\n        if (hasChanges) {\n          setEdgeContextMenus(newEdges);\n        }\n      }\n      if (onPointerOver) {\n        const over = intersected.filter((index) => !previous.includes(index));\n        over.forEach((edge) => {\n          onPointerOver(edge);\n        });\n      }\n      if (onPointerOut) {\n        const out = previous.filter((index) => !intersected.includes(index));\n        out.forEach((edge) => {\n          onPointerOut(edge);\n        });\n      }\n    },\n    [contextMenu, disabled2, edgeContextMenus, setEdgeContextMenus]\n  );\n  return {\n    handleClick,\n    handleContextMenu,\n    handleIntersections\n  };\n}\nfunction useEdgePositionAnimation(geometry, animated) {\n  const geometryRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(geometry);\n  const bufferPool = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    geometryRef.current = geometry;\n    const positions = geometry.getAttribute(\"position\");\n    bufferPool.current = new Float32Array(positions.array.length);\n  }, [geometry]);\n  const getAnimationPositions = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    const positions = geometryRef.current.getAttribute(\"position\");\n    const from = new Float32Array(positions.array.length);\n    return {\n      from,\n      to: positions.array\n    };\n  }, []);\n  const updateGeometryPosition = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((positions) => {\n    const buffer = bufferPool.current;\n    buffer.set(positions);\n    const newPosition = new three__WEBPACK_IMPORTED_MODULE_30__.BufferAttribute(buffer, 3, false);\n    geometryRef.current.setAttribute(\"position\", newPosition);\n    newPosition.needsUpdate = true;\n  }, []);\n  (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)(() => {\n    if (!animated) {\n      return null;\n    }\n    const animationPositions = getAnimationPositions();\n    return {\n      from: {\n        positions: animationPositions.from\n      },\n      to: {\n        positions: animationPositions.to\n      },\n      onChange: (event) => {\n        updateGeometryPosition(event.value.positions);\n      },\n      config: {\n        ...animationConfig,\n        duration: animated ? void 0 : 0\n      }\n    };\n  }, [animated, getAnimationPositions, updateGeometryPosition]);\n}\nfunction useEdgeOpacityAnimation(animated, hasSelections, theme) {\n  const [{ activeOpacity, inactiveOpacity }] = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)(() => {\n    return {\n      from: {\n        activeOpacity: 0,\n        inactiveOpacity: 0\n      },\n      to: {\n        activeOpacity: hasSelections ? theme.edge.selectedOpacity : theme.edge.opacity,\n        inactiveOpacity: hasSelections ? theme.edge.inactiveOpacity : theme.edge.opacity\n      },\n      config: {\n        ...animationConfig,\n        duration: animated ? void 0 : 0\n      }\n    };\n  }, [animated, hasSelections, theme]);\n  return { activeOpacity, inactiveOpacity };\n}\nconst Edge = ({\n  animated,\n  color,\n  contextMenu,\n  edge,\n  labelFontUrl,\n  labelPlacement = \"inline\",\n  opacity\n}) => {\n  const theme = useStore((state) => state.theme);\n  const { target, source, label, labelVisible = false, size = 1 } = edge;\n  const nodes = useStore((store) => store.nodes);\n  const [from, to] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => [\n      nodes.find((node) => node.id === source),\n      nodes.find((node) => node.id === target)\n    ],\n    [nodes, source, target]\n  );\n  const isDragging = useStore((state) => state.draggingIds.length > 0);\n  const labelOffset = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => (size + theme.edge.label.fontSize) / 2,\n    [size, theme.edge.label.fontSize]\n  );\n  const midPoint = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => getMidPoint(\n      from.position,\n      to.position,\n      getLabelOffsetByType(labelOffset, labelPlacement)\n    ),\n    [from.position, to.position, labelOffset, labelPlacement]\n  );\n  const edgeContextMenus = useStore((state) => state.edgeContextMenus);\n  const setEdgeContextMenus = useStore((state) => state.setEdgeContextMenus);\n  const [{ labelPosition }] = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)(\n    () => ({\n      from: {\n        labelPosition: [0, 0, 0]\n      },\n      to: {\n        labelPosition: [midPoint.x, midPoint.y, midPoint.z]\n      },\n      config: {\n        ...animationConfig,\n        duration: animated && !isDragging ? void 0 : 0\n      }\n    }),\n    [midPoint, animated, isDragging]\n  );\n  const removeContextMenu = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (edgeId) => {\n      edgeContextMenus.delete(edgeId);\n      setEdgeContextMenus(new Set(edgeContextMenus));\n    },\n    [edgeContextMenus, setEdgeContextMenus]\n  );\n  const labelRotation = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    if (labelPlacement === \"natural\") {\n      return new three__WEBPACK_IMPORTED_MODULE_30__.Euler(0, 0, 0);\n    }\n    return new three__WEBPACK_IMPORTED_MODULE_30__.Euler(\n      0,\n      0,\n      Math.atan2(\n        to.position.y - from.position.y,\n        to.position.x - from.position.x\n      )\n    );\n  }, [\n    labelPlacement,\n    to.position.y,\n    to.position.x,\n    from.position.y,\n    from.position.x\n  ]);\n  const htmlProps = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => ({\n      prepend: true,\n      center: true,\n      position: midPoint\n    }),\n    [midPoint]\n  );\n  const labelProps = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => ({\n      text: label,\n      ellipsis: 15,\n      fontUrl: labelFontUrl,\n      stroke: theme.edge.label.stroke,\n      color,\n      opacity,\n      fontSize: theme.edge.label.fontSize,\n      rotation: labelRotation\n    }),\n    [\n      label,\n      labelFontUrl,\n      theme.edge.label.stroke,\n      color,\n      opacity,\n      theme.edge.label.fontSize,\n      labelRotation\n    ]\n  );\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"group\", { children: [\n    labelVisible && label && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group, { position: labelPosition, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Label, { ...labelProps }) }),\n    contextMenu && edgeContextMenus.has(edge.id) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(glodrei__WEBPACK_IMPORTED_MODULE_39__.Html, { ...htmlProps, children: contextMenu({\n      data: edge,\n      onClose: () => removeContextMenu(edge.id)\n    }) })\n  ] });\n};\nconst Edges = ({\n  interpolation = \"linear\",\n  arrowPlacement = \"end\",\n  labelPlacement = \"inline\",\n  animated,\n  contextMenu,\n  disabled: disabled2,\n  edges,\n  labelFontUrl,\n  onClick,\n  onContextMenu,\n  onPointerOut,\n  onPointerOver\n}) => {\n  const theme = useStore((state) => state.theme);\n  const { getGeometries, getGeometry } = useEdgeGeometry(\n    arrowPlacement,\n    interpolation\n  );\n  const draggingIds = useStore((state) => state.draggingIds);\n  const edgeMeshes = useStore((state) => state.edgeMeshes);\n  const setEdgeMeshes = useStore((state) => state.setEdgeMeshes);\n  const actives = useStore((state) => state.actives || []);\n  const selections = useStore((state) => state.selections || []);\n  const [active, inactive, draggingActive, draggingInactive] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    const active2 = [];\n    const inactive2 = [];\n    const draggingActive2 = [];\n    const draggingInactive2 = [];\n    edges.forEach((edge) => {\n      if (draggingIds.includes(edge.source) || draggingIds.includes(edge.target)) {\n        if (selections.includes(edge.id) || actives.includes(edge.id)) {\n          draggingActive2.push(edge);\n        } else {\n          draggingInactive2.push(edge);\n        }\n        return;\n      }\n      if (selections.includes(edge.id) || actives.includes(edge.id)) {\n        active2.push(edge);\n      } else {\n        inactive2.push(edge);\n      }\n    });\n    return [active2, inactive2, draggingActive2, draggingInactive2];\n  }, [edges, actives, selections, draggingIds]);\n  const hasSelections = !!selections.length;\n  const staticEdgesGeometry = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => getGeometry(active, inactive),\n    [getGeometry, active, inactive]\n  );\n  const { activeOpacity, inactiveOpacity } = useEdgeOpacityAnimation(\n    animated,\n    hasSelections,\n    theme\n  );\n  useEdgePositionAnimation(staticEdgesGeometry, animated);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (draggingIds.length === 0) {\n      const edgeGeometries = getGeometries(edges);\n      const edgeMeshes2 = edgeGeometries.map((edge) => new three__WEBPACK_IMPORTED_MODULE_30__.Mesh(edge));\n      setEdgeMeshes(edgeMeshes2);\n    }\n  }, [getGeometries, setEdgeMeshes, edges, draggingIds.length]);\n  const staticEdgesRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(new three__WEBPACK_IMPORTED_MODULE_30__.Mesh());\n  const dynamicEdgesRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(new three__WEBPACK_IMPORTED_MODULE_30__.Mesh());\n  const intersect = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (raycaster) => {\n      if (!raycaster.camera) {\n        return [];\n      }\n      const intersections = raycaster.intersectObjects(edgeMeshes);\n      if (!intersections.length) {\n        return [];\n      }\n      return intersections.map(\n        (intersection) => edges[edgeMeshes.indexOf(intersection.object)]\n      );\n    },\n    [edgeMeshes, edges]\n  );\n  const { handleClick, handleContextMenu, handleIntersections } = useEdgeEvents(\n    {\n      onClick,\n      onContextMenu,\n      onPointerOut,\n      onPointerOver\n    },\n    contextMenu,\n    disabled2\n  );\n  const draggingIdRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)([]);\n  const intersectingRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)([]);\n  (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.A)((state) => {\n    staticEdgesRef.current.geometry = staticEdgesGeometry;\n    if (disabled2) {\n      return;\n    }\n    const previousDraggingId = draggingIdRef.current;\n    if (draggingIds.length || draggingIds.length === 0 && previousDraggingId !== null) {\n      dynamicEdgesRef.current.geometry = getGeometry(\n        draggingActive,\n        draggingInactive\n      );\n    }\n    draggingIdRef.current = draggingIds;\n    if (draggingIds.length) {\n      return;\n    }\n    const previousIntersecting = intersectingRef.current;\n    const intersecting = intersect(state.raycaster);\n    handleIntersections(previousIntersecting, intersecting);\n    if (intersecting.join() !== previousIntersecting.join()) {\n      dynamicEdgesRef.current.geometry = getGeometry(intersecting, []);\n    }\n    intersectingRef.current = intersecting;\n  });\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"group\", { onClick: handleClick, onContextMenu: handleContextMenu, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"mesh\", { ref: staticEdgesRef, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n        {\n          attach: \"material-0\",\n          color: theme.edge.fill,\n          depthTest: false,\n          fog: true,\n          opacity: inactiveOpacity,\n          side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n          transparent: true\n        }\n      ),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n        {\n          attach: \"material-1\",\n          color: theme.edge.activeFill,\n          depthTest: false,\n          fog: true,\n          opacity: activeOpacity,\n          side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n          transparent: true\n        }\n      )\n    ] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"mesh\", { ref: dynamicEdgesRef, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n        {\n          attach: \"material-0\",\n          color: theme.edge.fill,\n          depthTest: false,\n          fog: true,\n          opacity: inactiveOpacity,\n          side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n          transparent: true\n        }\n      ),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n        {\n          attach: \"material-1\",\n          color: theme.edge.activeFill,\n          depthTest: false,\n          fog: true,\n          opacity: activeOpacity,\n          side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n          transparent: true\n        }\n      )\n    ] }),\n    edges.map((edge) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      Edge,\n      {\n        animated,\n        contextMenu,\n        color: theme.edge.label.color,\n        disabled: disabled2,\n        edge,\n        labelFontUrl,\n        labelPlacement\n      },\n      edge.id\n    ))\n  ] });\n};\nconst Ring = ({\n  outerRadius,\n  innerRadius,\n  padding,\n  normalizedFill,\n  normalizedStroke,\n  opacity,\n  animated,\n  theme\n}) => {\n  var _a2;\n  const { opacity: springOpacity } = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)({\n    from: { opacity: 0 },\n    to: { opacity },\n    config: {\n      ...animationConfig,\n      duration: animated ? void 0 : 0\n    }\n  });\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"mesh\", { children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"ringGeometry\", { attach: \"geometry\", args: [outerRadius, 0, 128] }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n        {\n          attach: \"material\",\n          color: normalizedFill,\n          transparent: true,\n          depthTest: false,\n          opacity: ((_a2 = theme.cluster) == null ? void 0 : _a2.fill) ? springOpacity : 0,\n          side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n          fog: true\n        }\n      )\n    ] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"mesh\", { children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        \"ringGeometry\",\n        {\n          attach: \"geometry\",\n          args: [outerRadius, innerRadius + padding, 128]\n        }\n      ),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.meshBasicMaterial,\n        {\n          attach: \"material\",\n          color: normalizedStroke,\n          transparent: true,\n          depthTest: false,\n          opacity: springOpacity,\n          side: three__WEBPACK_IMPORTED_MODULE_30__.DoubleSide,\n          fog: true\n        }\n      )\n    ] })\n  ] });\n};\nconst Cluster = ({\n  animated,\n  position,\n  padding = 40,\n  labelFontUrl,\n  disabled: disabled2,\n  radius = 2,\n  nodes,\n  label,\n  onClick,\n  onPointerOver,\n  onPointerOut,\n  draggable = false,\n  onDragged,\n  onRender\n}) => {\n  var _a2, _b2, _c, _d, _e, _f, _g;\n  const theme = useStore((state) => state.theme);\n  const rad = Math.max(position.width, position.height) / 2;\n  const offset = rad - radius + padding;\n  const [active, setActive] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n  const center = useStore((state) => state.centerPosition);\n  const nodesState = useStore((state) => state.nodes);\n  const cameraControls = useCameraControls();\n  const draggingIds = useStore((state) => state.draggingIds);\n  const isDraggingCurrent = draggingIds.includes(label);\n  const isDragging = draggingIds.length > 0;\n  const isActive = useStore(\n    (state) => {\n      var _a3;\n      return (_a3 = state.actives) == null ? void 0 : _a3.some((id) => nodes.some((n) => n.id === id));\n    }\n  );\n  const hoveredNodeId = useStore((state) => state.hoveredNodeId);\n  const isSelected = useStore(\n    (state) => {\n      var _a3;\n      return (_a3 = state.selections) == null ? void 0 : _a3.some((id) => nodes.some((n) => n.id === id));\n    }\n  );\n  const hasSelections = useStore((state) => {\n    var _a3;\n    return ((_a3 = state.selections) == null ? void 0 : _a3.length) > 0;\n  });\n  const opacity = hasSelections ? isSelected || active || isActive ? (_a2 = theme.cluster) == null ? void 0 : _a2.selectedOpacity : (_b2 = theme.cluster) == null ? void 0 : _b2.inactiveOpacity : (_c = theme.cluster) == null ? void 0 : _c.opacity;\n  const labelPosition = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    var _a3, _b3;\n    const defaultPosition = [0, -offset, 2];\n    const themeOffset = (_b3 = (_a3 = theme.cluster) == null ? void 0 : _a3.label) == null ? void 0 : _b3.offset;\n    if (themeOffset) {\n      return [\n        defaultPosition[0] - themeOffset[0],\n        defaultPosition[1] - themeOffset[1],\n        defaultPosition[2] - themeOffset[2]\n      ];\n    }\n    return defaultPosition;\n  }, [offset, (_e = (_d = theme.cluster) == null ? void 0 : _d.label) == null ? void 0 : _e.offset]);\n  const { circlePosition } = (0,_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.useSpring)({\n    from: {\n      circlePosition: [center.x, center.y, -1]\n    },\n    to: {\n      circlePosition: position ? [position.x, position.y, -1] : [0, 0, -1]\n    },\n    config: {\n      ...animationConfig,\n      duration: animated && !isDragging ? void 0 : 0\n    }\n  });\n  const normalizedStroke = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => {\n      var _a3;\n      return new three__WEBPACK_IMPORTED_MODULE_30__.Color((_a3 = theme.cluster) == null ? void 0 : _a3.stroke);\n    },\n    [(_f = theme.cluster) == null ? void 0 : _f.stroke]\n  );\n  const normalizedFill = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => {\n      var _a3;\n      return new three__WEBPACK_IMPORTED_MODULE_30__.Color((_a3 = theme.cluster) == null ? void 0 : _a3.fill);\n    },\n    [(_g = theme.cluster) == null ? void 0 : _g.fill]\n  );\n  const addDraggingId = useStore((state) => state.addDraggingId);\n  const removeDraggingId = useStore((state) => state.removeDraggingId);\n  const setClusterPosition = useStore((state) => state.setClusterPosition);\n  const bind = useDrag({\n    draggable: draggable && !hoveredNodeId,\n    position: {\n      x: position.x,\n      y: position.y,\n      z: -1\n    },\n    set: (pos) => setClusterPosition(label, pos),\n    onDragStart: () => {\n      addDraggingId(label);\n      setActive(true);\n    },\n    onDragEnd: () => {\n      removeDraggingId(label);\n      setActive(false);\n      const updatedClusterNodes = nodesState.filter((n) => n.cluster === label);\n      onDragged == null ? void 0 : onDragged({ nodes: updatedClusterNodes, label });\n    }\n  });\n  (0,glodrei__WEBPACK_IMPORTED_MODULE_38__.useCursor)(active && !isDragging && onClick !== void 0, \"pointer\");\n  (0,glodrei__WEBPACK_IMPORTED_MODULE_38__.useCursor)(\n    active && draggable && !isDraggingCurrent && onClick === void 0,\n    \"grab\"\n  );\n  (0,glodrei__WEBPACK_IMPORTED_MODULE_38__.useCursor)(isDraggingCurrent, \"grabbing\");\n  const { pointerOver, pointerOut } = useHoverIntent({\n    disabled: disabled2,\n    onPointerOver: (event) => {\n      setActive(true);\n      cameraControls.freeze();\n      onPointerOver == null ? void 0 : onPointerOver(\n        {\n          nodes,\n          label\n        },\n        event\n      );\n    },\n    onPointerOut: (event) => {\n      setActive(false);\n      cameraControls.unFreeze();\n      onPointerOut == null ? void 0 : onPointerOut(\n        {\n          nodes,\n          label\n        },\n        event\n      );\n    }\n  });\n  const cluster = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => {\n      var _a3, _b3, _c2;\n      return theme.cluster && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group,\n        {\n          userData: { id: label, type: \"cluster\" },\n          position: circlePosition,\n          onPointerOver: pointerOver,\n          onPointerOut: pointerOut,\n          onClick: (event) => {\n            if (!disabled2 && !isDraggingCurrent) {\n              onClick == null ? void 0 : onClick({ nodes, label }, event);\n            }\n          },\n          ...bind(),\n          children: onRender ? onRender({\n            label: {\n              position: labelPosition,\n              text: label,\n              opacity,\n              fontUrl: labelFontUrl\n            },\n            opacity,\n            outerRadius: offset,\n            innerRadius: rad,\n            padding,\n            theme\n          }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n              Ring,\n              {\n                outerRadius: offset,\n                innerRadius: rad,\n                padding,\n                normalizedFill,\n                normalizedStroke,\n                opacity,\n                animated,\n                theme\n              }\n            ),\n            ((_a3 = theme.cluster) == null ? void 0 : _a3.label) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_spring_three__WEBPACK_IMPORTED_MODULE_11__.a.group, { position: labelPosition, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n              Label,\n              {\n                text: label,\n                opacity,\n                fontUrl: labelFontUrl,\n                stroke: theme.cluster.label.stroke,\n                active: false,\n                color: (_b3 = theme.cluster) == null ? void 0 : _b3.label.color,\n                fontSize: ((_c2 = theme.cluster) == null ? void 0 : _c2.label.fontSize) ?? 12\n              }\n            ) })\n          ] })\n        }\n      );\n    },\n    [\n      theme,\n      circlePosition,\n      pointerOver,\n      pointerOut,\n      offset,\n      normalizedFill,\n      rad,\n      padding,\n      normalizedStroke,\n      labelPosition,\n      label,\n      opacity,\n      labelFontUrl,\n      disabled2,\n      onClick,\n      nodes,\n      bind,\n      isDraggingCurrent,\n      onRender,\n      animated\n    ]\n  );\n  return cluster;\n};\nconst GraphScene = (0,react__WEBPACK_IMPORTED_MODULE_1__.forwardRef)(\n  ({\n    onNodeClick,\n    onNodeDoubleClick,\n    onNodeContextMenu,\n    onEdgeContextMenu,\n    onEdgeClick,\n    onEdgePointerOver,\n    onEdgePointerOut,\n    onNodePointerOver,\n    onNodePointerOut,\n    onClusterClick,\n    onNodeDragged,\n    onClusterDragged,\n    onClusterPointerOver,\n    onClusterPointerOut,\n    contextMenu,\n    animated,\n    disabled: disabled2,\n    draggable,\n    constrainDragging = false,\n    edgeLabelPosition,\n    edgeArrowPosition,\n    edgeInterpolation = \"linear\",\n    labelFontUrl,\n    renderNode,\n    onRenderCluster,\n    ...rest\n  }, ref) => {\n    const { layoutType, clusterAttribute } = rest;\n    const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.gl);\n    const scene = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.scene);\n    const camera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.camera);\n    const { updateLayout } = useGraph({ ...rest, constrainDragging });\n    if (clusterAttribute && !(layoutType === \"forceDirected2d\" || layoutType === \"forceDirected3d\")) {\n      throw new Error(\n        \"Clustering is only supported for the force directed layouts.\"\n      );\n    }\n    const graph = useStore((state) => state.graph);\n    const nodes = useStore((state) => state.nodes);\n    const edges = useStore((state) => state.edges);\n    const clusters = useStore((state) => [...state.clusters.values()]);\n    const { centerNodesById, fitNodesInViewById, isCentered } = useCenterGraph({\n      animated,\n      disabled: disabled2,\n      layoutType\n    });\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle)(\n      ref,\n      () => ({\n        centerGraph: centerNodesById,\n        fitNodesInView: fitNodesInViewById,\n        graph,\n        renderScene: () => gl.render(scene, camera)\n      }),\n      [centerNodesById, fitNodesInViewById, graph, gl, scene, camera]\n    );\n    const onNodeDraggedHandler = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n      (node) => {\n        onNodeDragged == null ? void 0 : onNodeDragged(node);\n        if (clusterAttribute) {\n          updateLayout();\n        }\n      },\n      [clusterAttribute, onNodeDragged, updateLayout]\n    );\n    const nodeComponents = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n      () => nodes.map((n) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        Node,\n        {\n          id: n == null ? void 0 : n.id,\n          labelFontUrl,\n          draggable,\n          constrainDragging,\n          disabled: disabled2,\n          animated,\n          contextMenu,\n          renderNode,\n          onClick: onNodeClick,\n          onDoubleClick: onNodeDoubleClick,\n          onContextMenu: onNodeContextMenu,\n          onPointerOver: onNodePointerOver,\n          onPointerOut: onNodePointerOut,\n          onDragged: onNodeDraggedHandler\n        },\n        n == null ? void 0 : n.id\n      )),\n      [\n        constrainDragging,\n        animated,\n        contextMenu,\n        disabled2,\n        draggable,\n        labelFontUrl,\n        nodes,\n        onNodeClick,\n        onNodeContextMenu,\n        onNodeDoubleClick,\n        onNodeDraggedHandler,\n        onNodePointerOut,\n        onNodePointerOver,\n        renderNode\n      ]\n    );\n    const edgeComponents = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n      () => animated ? edges.map((e) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        Edge$1,\n        {\n          id: e.id,\n          disabled: disabled2,\n          animated,\n          labelFontUrl,\n          labelPlacement: edgeLabelPosition,\n          arrowPlacement: edgeArrowPosition,\n          interpolation: edgeInterpolation,\n          contextMenu,\n          onClick: onEdgeClick,\n          onContextMenu: onEdgeContextMenu,\n          onPointerOver: onEdgePointerOver,\n          onPointerOut: onEdgePointerOut\n        },\n        e.id\n      )) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        Edges,\n        {\n          edges,\n          disabled: disabled2,\n          animated,\n          labelFontUrl,\n          labelPlacement: edgeLabelPosition,\n          arrowPlacement: edgeArrowPosition,\n          interpolation: edgeInterpolation,\n          contextMenu,\n          onClick: onEdgeClick,\n          onContextMenu: onEdgeContextMenu,\n          onPointerOver: onEdgePointerOver,\n          onPointerOut: onEdgePointerOut\n        }\n      ),\n      [\n        animated,\n        contextMenu,\n        disabled2,\n        edgeArrowPosition,\n        edgeInterpolation,\n        edgeLabelPosition,\n        edges,\n        labelFontUrl,\n        onEdgeClick,\n        onEdgeContextMenu,\n        onEdgePointerOut,\n        onEdgePointerOver\n      ]\n    );\n    const clusterComponents = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n      () => clusters.map((c) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        Cluster,\n        {\n          animated,\n          disabled: disabled2,\n          draggable,\n          labelFontUrl,\n          onClick: onClusterClick,\n          onPointerOver: onClusterPointerOver,\n          onPointerOut: onClusterPointerOut,\n          onDragged: onClusterDragged,\n          onRender: onRenderCluster,\n          ...c\n        },\n        c.label\n      )),\n      [\n        animated,\n        clusters,\n        disabled2,\n        draggable,\n        labelFontUrl,\n        onClusterClick,\n        onClusterPointerOut,\n        onClusterPointerOver,\n        onClusterDragged,\n        onRenderCluster\n      ]\n    );\n    return isCentered && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [\n      edgeComponents,\n      nodeComponents,\n      clusterComponents\n    ] });\n  }\n);\nconst darkTheme = {\n  canvas: {\n    background: \"#1E2026\"\n  },\n  node: {\n    fill: \"#7A8C9E\",\n    activeFill: \"#1DE9AC\",\n    opacity: 1,\n    selectedOpacity: 1,\n    inactiveOpacity: 0.2,\n    label: {\n      stroke: \"#1E2026\",\n      color: \"#ACBAC7\",\n      activeColor: \"#1DE9AC\"\n    },\n    subLabel: {\n      stroke: \"#1E2026\",\n      color: \"#ACBAC7\",\n      activeColor: \"#1DE9AC\"\n    }\n  },\n  lasso: {\n    border: \"1px solid #55aaff\",\n    background: \"rgba(75, 160, 255, 0.1)\"\n  },\n  ring: {\n    fill: \"#54616D\",\n    activeFill: \"#1DE9AC\"\n  },\n  edge: {\n    fill: \"#474B56\",\n    activeFill: \"#1DE9AC\",\n    opacity: 1,\n    selectedOpacity: 1,\n    inactiveOpacity: 0.1,\n    label: {\n      stroke: \"#1E2026\",\n      color: \"#ACBAC7\",\n      activeColor: \"#1DE9AC\",\n      fontSize: 6\n    }\n  },\n  arrow: {\n    fill: \"#474B56\",\n    activeFill: \"#1DE9AC\"\n  },\n  cluster: {\n    stroke: \"#474B56\",\n    opacity: 1,\n    selectedOpacity: 1,\n    inactiveOpacity: 0.1,\n    label: {\n      stroke: \"#1E2026\",\n      color: \"#ACBAC7\"\n    }\n  }\n};\nconst lightTheme = {\n  canvas: {\n    background: \"#fff\"\n  },\n  node: {\n    fill: \"#7CA0AB\",\n    activeFill: \"#1DE9AC\",\n    opacity: 1,\n    selectedOpacity: 1,\n    inactiveOpacity: 0.2,\n    label: {\n      color: \"#2A6475\",\n      stroke: \"#fff\",\n      activeColor: \"#1DE9AC\"\n    },\n    subLabel: {\n      color: \"#ddd\",\n      stroke: \"transparent\",\n      activeColor: \"#1DE9AC\"\n    }\n  },\n  lasso: {\n    border: \"1px solid #55aaff\",\n    background: \"rgba(75, 160, 255, 0.1)\"\n  },\n  ring: {\n    fill: \"#D8E6EA\",\n    activeFill: \"#1DE9AC\"\n  },\n  edge: {\n    fill: \"#D8E6EA\",\n    activeFill: \"#1DE9AC\",\n    opacity: 1,\n    selectedOpacity: 1,\n    inactiveOpacity: 0.1,\n    label: {\n      stroke: \"#fff\",\n      color: \"#2A6475\",\n      activeColor: \"#1DE9AC\",\n      fontSize: 6\n    }\n  },\n  arrow: {\n    fill: \"#D8E6EA\",\n    activeFill: \"#1DE9AC\"\n  },\n  cluster: {\n    stroke: \"#D8E6EA\",\n    opacity: 1,\n    selectedOpacity: 1,\n    inactiveOpacity: 0.1,\n    label: {\n      stroke: \"#fff\",\n      color: \"#2A6475\"\n    }\n  }\n};\nfunction getAdjacents(graph, nodeIds, type) {\n  nodeIds = Array.isArray(nodeIds) ? nodeIds : [nodeIds];\n  const nodes = [];\n  const edges = [];\n  for (const nodeId of nodeIds) {\n    const graphLinks = [\n      ...graph.inEdgeEntries(nodeId) ?? [],\n      ...graph.outEdgeEntries(nodeId) ?? []\n    ];\n    if (!graphLinks) {\n      continue;\n    }\n    for (const link of graphLinks) {\n      const linkId = link.attributes.id;\n      if (type === \"in\") {\n        if (link.target === nodeId && !edges.includes(linkId)) {\n          edges.push(linkId);\n        }\n      } else if (type === \"out\") {\n        if (link.source === nodeId && !edges.includes(linkId)) {\n          edges.push(linkId);\n        }\n      } else {\n        if (!edges.includes(linkId)) {\n          edges.push(linkId);\n        }\n      }\n      if (type === \"out\" || type === \"all\") {\n        const toId = link.target;\n        if (!nodes.includes(toId)) {\n          nodes.push(toId);\n        }\n      }\n      if (type === \"in\" || type === \"all\") {\n        if (!nodes.includes(link.source)) {\n          nodes.push(link.source);\n        }\n      }\n    }\n  }\n  return {\n    nodes,\n    edges\n  };\n}\nfunction prepareRay(event, vec, size) {\n  const { offsetX, offsetY } = event;\n  const { width, height } = size;\n  vec.set(offsetX / width * 2 - 1, -(offsetY / height) * 2 + 1);\n}\nfunction createElement(theme) {\n  const element = document.createElement(\"div\");\n  element.style.pointerEvents = \"none\";\n  element.style.border = theme.lasso.border;\n  element.style.backgroundColor = theme.lasso.background;\n  element.style.position = \"fixed\";\n  return element;\n}\nconst Lasso = ({\n  children,\n  type = \"none\",\n  onLasso,\n  onLassoEnd,\n  disabled: disabled2\n}) => {\n  var _a2;\n  const theme = useStore((state) => state.theme);\n  const camera = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.camera);\n  const gl = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.gl);\n  const setEvents = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.setEvents);\n  const size = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.size);\n  const get = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.get);\n  const scene = (0,_react_three_fiber__WEBPACK_IMPORTED_MODULE_31__.z)((state) => state.scene);\n  const cameraControls = useCameraControls();\n  const actives = useStore((state) => state.actives);\n  const setActives = useStore((state) => state.setActives);\n  const edges = useStore((state) => state.edges);\n  const edgeMeshes = useStore((state) => state.edgeMeshes);\n  const mountedRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const selectionBoxRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const edgeMeshSelectionBoxRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const elementRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(createElement(theme));\n  const vectorsRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  const isDownRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const oldRaycasterEnabledRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(get().events.enabled);\n  const oldControlsEnabledRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(\n    (_a2 = cameraControls.controls) == null ? void 0 : _a2.enabled\n  );\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (mountedRef.current) {\n      onLasso == null ? void 0 : onLasso(actives);\n    }\n    mountedRef.current = true;\n  }, [actives, onLasso]);\n  const onPointerMove = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (event) => {\n      if (isDownRef.current) {\n        const [startPoint, pointTopLeft, pointBottomRight] = vectorsRef.current;\n        pointBottomRight.x = Math.max(startPoint.x, event.clientX);\n        pointBottomRight.y = Math.max(startPoint.y, event.clientY);\n        pointTopLeft.x = Math.min(startPoint.x, event.clientX);\n        pointTopLeft.y = Math.min(startPoint.y, event.clientY);\n        elementRef.current.style.left = `${pointTopLeft.x}px`;\n        elementRef.current.style.top = `${pointTopLeft.y}px`;\n        elementRef.current.style.width = `${pointBottomRight.x - pointTopLeft.x}px`;\n        elementRef.current.style.height = `${pointBottomRight.y - pointTopLeft.y}px`;\n        prepareRay(event, selectionBoxRef.current.endPoint, size);\n        prepareRay(event, edgeMeshSelectionBoxRef.current.endPoint, size);\n        const allSelected = [];\n        const edgesSelected = edgeMeshSelectionBoxRef.current.select().sort((o) => o.uuid).map(\n          (edge) => edges[edgeMeshes.indexOf(edge)].id\n        );\n        allSelected.push(...edgesSelected);\n        const selected = selectionBoxRef.current.select().sort((o) => o.uuid).filter(\n          (o) => {\n            var _a3, _b2;\n            return o.isMesh && ((_a3 = o.userData) == null ? void 0 : _a3.id) && (((_b2 = o.userData) == null ? void 0 : _b2.type) === type || type === \"all\");\n          }\n        ).map((o) => o.userData.id);\n        allSelected.push(...selected);\n        requestAnimationFrame(() => {\n          setActives(allSelected);\n        });\n        document.addEventListener(\"pointermove\", onPointerMove, {\n          passive: true,\n          capture: true,\n          once: true\n        });\n      }\n    },\n    [edges, edgeMeshes, setActives, size, type]\n  );\n  const onPointerUp = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    var _a3;\n    if (isDownRef.current) {\n      setEvents({ enabled: oldRaycasterEnabledRef.current });\n      isDownRef.current = false;\n      (_a3 = elementRef.current.parentElement) == null ? void 0 : _a3.removeChild(elementRef.current);\n      cameraControls.controls.enabled = oldControlsEnabledRef.current;\n      onLassoEnd == null ? void 0 : onLassoEnd(actives);\n      document.removeEventListener(\"pointermove\", onPointerMove);\n      document.removeEventListener(\"pointerup\", onPointerUp);\n    }\n  }, [setEvents, cameraControls.controls, onLassoEnd, actives, onPointerMove]);\n  const onPointerDown = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (event) => {\n      var _a3, _b2;\n      if (event.shiftKey) {\n        oldRaycasterEnabledRef.current = get().events.enabled;\n        oldControlsEnabledRef.current = (_a3 = cameraControls.controls) == null ? void 0 : _a3.enabled;\n        selectionBoxRef.current = new three_stdlib__WEBPACK_IMPORTED_MODULE_41__.SelectionBox(camera, scene);\n        const edgeScene = new three__WEBPACK_IMPORTED_MODULE_30__.Scene();\n        if (edgeMeshes.length) {\n          edgeScene.add(...edgeMeshes);\n        }\n        edgeMeshSelectionBoxRef.current = new three_stdlib__WEBPACK_IMPORTED_MODULE_41__.SelectionBox(camera, edgeScene);\n        vectorsRef.current = [\n          // start point\n          new three__WEBPACK_IMPORTED_MODULE_30__.Vector2(),\n          // point top left\n          new three__WEBPACK_IMPORTED_MODULE_30__.Vector2(),\n          // point bottom right\n          new three__WEBPACK_IMPORTED_MODULE_30__.Vector2()\n        ];\n        const [startPoint] = vectorsRef.current;\n        cameraControls.controls.enabled = false;\n        setEvents({ enabled: false });\n        isDownRef.current = true;\n        (_b2 = gl.domElement.parentElement) == null ? void 0 : _b2.appendChild(elementRef.current);\n        elementRef.current.style.left = `${event.clientX}px`;\n        elementRef.current.style.top = `${event.clientY}px`;\n        elementRef.current.style.width = \"0px\";\n        elementRef.current.style.height = \"0px\";\n        startPoint.x = event.clientX;\n        startPoint.y = event.clientY;\n        prepareRay(event, selectionBoxRef.current.startPoint, size);\n        prepareRay(event, edgeMeshSelectionBoxRef.current.startPoint, size);\n        document.addEventListener(\"pointermove\", onPointerMove, {\n          passive: true,\n          capture: true,\n          once: true\n        });\n        document.addEventListener(\"pointerup\", onPointerUp, { passive: true });\n      }\n    },\n    [\n      camera,\n      cameraControls.controls,\n      edgeMeshes,\n      get,\n      gl.domElement.parentElement,\n      onPointerMove,\n      onPointerUp,\n      scene,\n      setEvents,\n      size\n    ]\n  );\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (disabled2 || type === \"none\") {\n      return;\n    }\n    if (typeof window !== \"undefined\") {\n      document.addEventListener(\"pointerdown\", onPointerDown, {\n        passive: true\n      });\n      document.addEventListener(\"pointermove\", onPointerMove, {\n        passive: true\n      });\n      document.addEventListener(\"pointerup\", onPointerUp, { passive: true });\n    }\n    return () => {\n      if (typeof window !== \"undefined\") {\n        document.removeEventListener(\"pointerdown\", onPointerDown);\n        document.removeEventListener(\"pointermove\", onPointerMove);\n        document.removeEventListener(\"pointerup\", onPointerUp);\n      }\n    };\n  }, [type, disabled2, onPointerDown, onPointerMove, onPointerUp]);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"group\", { children });\n};\nconst useSelection = ({\n  selections = [],\n  nodes = [],\n  actives = [],\n  focusOnSelect = true,\n  type = \"single\",\n  pathHoverType = \"out\",\n  pathSelectionType = \"direct\",\n  ref,\n  hotkeys = [\"selectAll\", \"deselect\", \"delete\"],\n  disabled: disabled2,\n  onSelection\n}) => {\n  const [internalHovers, setInternalHovers] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n  const [internalActives, setInternalActives] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(actives);\n  const [internalSelections, setInternalSelections] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(selections);\n  const [metaKeyDown, setMetaKeyDown] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n  const isMulti = type === \"multi\" || type === \"multiModifier\";\n  const addSelection = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (items) => {\n      if (!disabled2 && items) {\n        items = Array.isArray(items) ? items : [items];\n        const filtered = items.filter(\n          (item) => !internalSelections.includes(item)\n        );\n        if (filtered.length) {\n          const next = [...internalSelections, ...filtered];\n          onSelection == null ? void 0 : onSelection(next);\n          setInternalSelections(next);\n        }\n      }\n    },\n    [disabled2, internalSelections, onSelection]\n  );\n  const removeSelection = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (items) => {\n      if (!disabled2 && items) {\n        items = Array.isArray(items) ? items : [items];\n        const next = internalSelections.filter((i) => !items.includes(i));\n        onSelection == null ? void 0 : onSelection(next);\n        setInternalSelections(next);\n      }\n    },\n    [disabled2, internalSelections, onSelection]\n  );\n  const clearSelections = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (next = []) => {\n      if (!disabled2) {\n        next = Array.isArray(next) ? next : [next];\n        setInternalActives([]);\n        setInternalSelections(next);\n        onSelection == null ? void 0 : onSelection(next);\n      }\n    },\n    [disabled2, onSelection]\n  );\n  const toggleSelection = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (item) => {\n      const has = internalSelections.includes(item);\n      if (has) {\n        removeSelection(item);\n      } else {\n        if (!isMulti) {\n          clearSelections(item);\n        } else {\n          addSelection(item);\n        }\n      }\n    },\n    [\n      addSelection,\n      clearSelections,\n      internalSelections,\n      isMulti,\n      removeSelection\n    ]\n  );\n  const onNodeClick = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (data) => {\n      if (isMulti) {\n        if (type === \"multiModifier\") {\n          if (metaKeyDown) {\n            addSelection(data.id);\n          } else {\n            clearSelections(data.id);\n          }\n        } else {\n          addSelection(data.id);\n        }\n      } else {\n        clearSelections(data.id);\n      }\n      if (focusOnSelect === true || focusOnSelect === \"singleOnly\" && !metaKeyDown) {\n        if (!ref.current) {\n          throw new Error(\"No ref found for the graph canvas.\");\n        }\n        const graph = ref.current.getGraph();\n        const { nodes: adjacents } = getAdjacents(\n          graph,\n          [data.id],\n          pathSelectionType\n        );\n        ref.current.fitNodesInView([data.id, ...adjacents], {\n          fitOnlyIfNodesNotInView: true\n        });\n      }\n    },\n    [\n      addSelection,\n      clearSelections,\n      focusOnSelect,\n      isMulti,\n      metaKeyDown,\n      pathSelectionType,\n      ref,\n      type\n    ]\n  );\n  const selectNodePaths = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (source, target) => {\n      const graph = ref.current.getGraph();\n      if (!graph) {\n        throw new Error(\"Graph is not initialized\");\n      }\n      const path = findPath(graph, source, target);\n      clearSelections([source, target]);\n      const result = [];\n      for (let i = 0; i < path.length - 1; i++) {\n        const from = path[i];\n        const to = path[i + 1];\n        const edge = graph.getEdgeAttributes(from, to);\n        if (edge) {\n          result.push(edge.id);\n        }\n      }\n      setInternalActives([...path.map((p) => p), ...result]);\n    },\n    [clearSelections, ref]\n  );\n  const onKeyDown = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((event) => {\n    const element = event.target;\n    const isSafe = element.tagName !== \"INPUT\" && element.tagName !== \"SELECT\" && element.tagName !== \"TEXTAREA\" && !element.isContentEditable;\n    const isMeta = event.metaKey || event.ctrlKey;\n    if (isSafe && isMeta) {\n      event.preventDefault();\n      setMetaKeyDown(true);\n    }\n  }, []);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (typeof window !== \"undefined\") {\n      window.addEventListener(\"keydown\", onKeyDown);\n    }\n    return () => {\n      if (typeof window !== \"undefined\") {\n        window.removeEventListener(\"keydown\", onKeyDown);\n      }\n    };\n  }, [onKeyDown]);\n  const onCanvasClick = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (event) => {\n      if (event.button !== 2 && (internalSelections.length || internalActives.length)) {\n        clearSelections();\n        setMetaKeyDown(false);\n        if (focusOnSelect && internalSelections.length === 1) {\n          if (!ref.current) {\n            throw new Error(\"No ref found for the graph canvas.\");\n          }\n          ref.current.fitNodesInView([], { fitOnlyIfNodesNotInView: true });\n        }\n      }\n    },\n    [\n      clearSelections,\n      focusOnSelect,\n      internalActives.length,\n      internalSelections.length,\n      ref\n    ]\n  );\n  const onLasso = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((selections2) => {\n    setInternalActives(selections2);\n  }, []);\n  const onLassoEnd = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (selections2) => {\n      clearSelections(selections2);\n    },\n    [clearSelections]\n  );\n  const onNodePointerOver = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (data) => {\n      if (pathHoverType) {\n        const graph = ref.current.getGraph();\n        if (!graph) {\n          throw new Error(\"No ref found for the graph canvas.\");\n        }\n        const { nodes: nodes2, edges } = getAdjacents(graph, [data.id], pathHoverType);\n        setInternalHovers([...nodes2, ...edges]);\n      }\n    },\n    [pathHoverType, ref]\n  );\n  const onNodePointerOut = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    if (pathHoverType) {\n      setInternalHovers([]);\n    }\n  }, [pathHoverType]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    var _a2;\n    if (pathSelectionType !== \"direct\" && internalSelections.length > 0) {\n      const graph = (_a2 = ref.current) == null ? void 0 : _a2.getGraph();\n      if (graph) {\n        const { nodes: nodes2, edges } = getAdjacents(\n          graph,\n          internalSelections,\n          pathSelectionType\n        );\n        setInternalActives([...nodes2, ...edges]);\n      }\n    }\n  }, [internalSelections, pathSelectionType, ref]);\n  (0,reakeys__WEBPACK_IMPORTED_MODULE_13__.useHotkeys)([\n    {\n      name: \"Select All\",\n      keys: \"mod+a\",\n      disabled: !hotkeys.includes(\"selectAll\"),\n      category: \"Graph\",\n      description: \"Select all nodes and edges\",\n      callback: (event) => {\n        event.preventDefault();\n        if (!disabled2 && type !== \"single\") {\n          const next = nodes.map((n) => n.id);\n          onSelection == null ? void 0 : onSelection(next);\n          setInternalSelections(next);\n        }\n      }\n    },\n    {\n      name: \"Deselect Selections\",\n      category: \"Graph\",\n      disabled: !hotkeys.includes(\"deselect\"),\n      description: \"Deselect selected nodes and edges\",\n      keys: \"escape\",\n      callback: (event) => {\n        if (!disabled2) {\n          event.preventDefault();\n          onSelection == null ? void 0 : onSelection([]);\n          setInternalSelections([]);\n        }\n      }\n    }\n  ]);\n  const joinedActives = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => [...internalActives, ...internalHovers],\n    [internalActives, internalHovers]\n  );\n  return {\n    actives: joinedActives,\n    onNodeClick,\n    onNodePointerOver,\n    onNodePointerOut,\n    onLasso,\n    onLassoEnd,\n    selectNodePaths,\n    onCanvasClick,\n    selections: internalSelections,\n    clearSelections,\n    addSelection,\n    removeSelection,\n    toggleSelection,\n    setSelections: setInternalSelections\n  };\n};\nconst canvas = \"_canvas_670zp_1\";\nconst css$2 = {\n  canvas\n};\nconst GL_DEFAULTS = {\n  alpha: true,\n  antialias: true\n};\nconst CAMERA_DEFAULTS = {\n  position: [0, 0, 1e3],\n  near: 5,\n  far: 5e4,\n  fov: 10\n};\nconst GraphCanvas = (0,react__WEBPACK_IMPORTED_MODULE_1__.forwardRef)(\n  ({\n    cameraMode = \"pan\",\n    layoutType = \"forceDirected2d\",\n    sizingType = \"default\",\n    labelType = \"auto\",\n    theme = lightTheme,\n    animated = true,\n    defaultNodeSize = 7,\n    minNodeSize = 5,\n    maxNodeSize = 15,\n    lassoType = \"none\",\n    glOptions = {},\n    edges,\n    children,\n    nodes,\n    minDistance,\n    maxDistance,\n    onCanvasClick,\n    disabled: disabled2,\n    onLasso,\n    onLassoEnd,\n    ...rest\n  }, ref) => {\n    var _a2, _b2;\n    const rendererRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const controlsRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const canvasRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle)(ref, () => ({\n      centerGraph: (nodeIds, opts) => {\n        var _a3;\n        return (_a3 = rendererRef.current) == null ? void 0 : _a3.centerGraph(nodeIds, opts);\n      },\n      fitNodesInView: (nodeIds, opts) => {\n        var _a3;\n        return (_a3 = rendererRef.current) == null ? void 0 : _a3.fitNodesInView(nodeIds, opts);\n      },\n      zoomIn: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.zoomIn();\n      },\n      zoomOut: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.zoomOut();\n      },\n      dollyIn: (distance) => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.dollyIn(distance);\n      },\n      dollyOut: (distance) => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.dollyOut(distance);\n      },\n      panLeft: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.panLeft();\n      },\n      panRight: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.panRight();\n      },\n      panDown: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.panDown();\n      },\n      panUp: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.panUp();\n      },\n      resetControls: (animated2) => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.resetControls(animated2);\n      },\n      getControls: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.controls;\n      },\n      getGraph: () => {\n        var _a3;\n        return (_a3 = rendererRef.current) == null ? void 0 : _a3.graph;\n      },\n      exportCanvas: () => {\n        rendererRef.current.renderScene();\n        return canvasRef.current.toDataURL();\n      },\n      freeze: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.freeze();\n      },\n      unFreeze: () => {\n        var _a3;\n        return (_a3 = controlsRef.current) == null ? void 0 : _a3.unFreeze();\n      }\n    }));\n    const { selections, actives, collapsedNodeIds } = rest;\n    const finalAnimated = edges.length + nodes.length > 400 ? false : animated;\n    const gl = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => ({ ...glOptions, ...GL_DEFAULTS }), [glOptions]);\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { className: css$2.canvas, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      _react_three_fiber__WEBPACK_IMPORTED_MODULE_42__.Canvas,\n      {\n        legacy: true,\n        linear: true,\n        ref: canvasRef,\n        flat: true,\n        gl,\n        camera: CAMERA_DEFAULTS,\n        onPointerMissed: onCanvasClick,\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\n          Provider,\n          {\n            createStore: () => createStore({\n              selections,\n              actives,\n              theme,\n              collapsedNodeIds\n            }),\n            children: [\n              ((_a2 = theme.canvas) == null ? void 0 : _a2.background) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"color\", { attach: \"background\", args: [theme.canvas.background] }),\n              /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"ambientLight\", { intensity: 1 }),\n              children,\n              ((_b2 = theme.canvas) == null ? void 0 : _b2.fog) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"fog\", { attach: \"fog\", args: [theme.canvas.fog, 4e3, 9e3] }),\n              /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n                CameraControls,\n                {\n                  mode: cameraMode,\n                  ref: controlsRef,\n                  disabled: disabled2,\n                  minDistance,\n                  maxDistance,\n                  animated,\n                  children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n                    Lasso,\n                    {\n                      disabled: disabled2,\n                      type: lassoType,\n                      onLasso,\n                      onLassoEnd,\n                      children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Suspense, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n                        GraphScene,\n                        {\n                          ref: rendererRef,\n                          disabled: disabled2,\n                          animated: finalAnimated,\n                          edges,\n                          nodes,\n                          layoutType,\n                          sizingType,\n                          labelType,\n                          defaultNodeSize,\n                          minNodeSize,\n                          maxNodeSize,\n                          ...rest\n                        }\n                      ) })\n                    }\n                  )\n                }\n              )\n            ]\n          }\n        )\n      }\n    ) });\n  }\n);\nconst container$1 = \"_container_155l7_1\";\nconst disabled = \"_disabled_155l7_7\";\nconst contentContainer = \"_contentContainer_155l7_10\";\nconst contentInner = \"_contentInner_155l7_35\";\nconst content = \"_content_155l7_10\";\nconst css$1 = {\n  container: container$1,\n  disabled,\n  contentContainer,\n  contentInner,\n  content\n};\nconst RadialSlice = ({\n  label,\n  centralAngle,\n  startAngle,\n  endAngle,\n  polar,\n  radius,\n  className,\n  icon,\n  innerRadius,\n  skew,\n  disabled: disabled2,\n  onClick\n}) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n  \"div\",\n  {\n    role: \"menuitem\",\n    className: classnames__WEBPACK_IMPORTED_MODULE_15__(css$1.container, className, {\n      [css$1.disabled]: disabled2\n    }),\n    style: {\n      width: centralAngle > 90 ? \"100%\" : \"50%\",\n      height: centralAngle > 90 ? \"100%\" : \"50%\",\n      bottom: centralAngle > 90 ? \"50%\" : \"initial\",\n      right: centralAngle > 90 ? \"50%\" : \"initial\",\n      transform: `rotate(${startAngle + endAngle}deg) skew(${skew}deg)`\n    },\n    onClick: (event) => {\n      if (!disabled2) {\n        onClick(event);\n      }\n    },\n    children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      \"div\",\n      {\n        className: css$1.contentContainer,\n        style: {\n          transform: `skew(${-skew}deg) rotate(${(polar ? 90 : centralAngle) / 2 - 90}deg)`\n        },\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          \"div\",\n          {\n            className: css$1.contentInner,\n            style: {\n              top: `calc((((${centralAngle > 90 ? \"50% + \" : \"\"}${radius}px) - ${innerRadius}px) / 2) - 4em)`\n            },\n            children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\n              \"div\",\n              {\n                className: css$1.content,\n                style: {\n                  transform: `rotate(${-endAngle}deg)`\n                },\n                title: label,\n                children: [\n                  icon,\n                  label\n                ]\n              }\n            )\n          }\n        )\n      }\n    )\n  }\n);\nfunction calculateRadius(items, startOffsetAngle) {\n  const centralAngle = 360 / items.length || 360;\n  const polar = centralAngle % 180 === 0;\n  const deltaAngle = 90 - centralAngle;\n  const startAngle = polar ? 45 : startOffsetAngle + deltaAngle + centralAngle / 2;\n  return { centralAngle, polar, startAngle, deltaAngle };\n}\nconst container = \"_container_x9hyx_1\";\nconst css = {\n  container\n};\nconst RadialMenu = ({\n  items,\n  radius = 175,\n  className,\n  innerRadius = 25,\n  startOffsetAngle = 0,\n  onClose\n}) => {\n  const { centralAngle, polar, startAngle, deltaAngle } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => calculateRadius(items, startOffsetAngle),\n    [items, startOffsetAngle]\n  );\n  const timeout = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect)(() => {\n    const timer = timeout.current;\n    return () => clearTimeout(timer);\n  }, []);\n  if (items.length === 0) {\n    return null;\n  }\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    \"div\",\n    {\n      role: \"menu\",\n      className: classnames__WEBPACK_IMPORTED_MODULE_15__(css.container, className),\n      onPointerEnter: () => clearTimeout(timeout.current),\n      onPointerLeave: (event) => {\n        clearTimeout(timeout.current);\n        timeout.current = setTimeout(() => onClose == null ? void 0 : onClose(event), 500);\n      },\n      children: items.map((slice, index) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        RadialSlice,\n        {\n          ...slice,\n          radius,\n          innerRadius,\n          startAngle,\n          endAngle: centralAngle * index,\n          skew: polar ? 0 : deltaAngle,\n          polar,\n          centralAngle,\n          onClick: (event) => {\n            slice == null ? void 0 : slice.onClick(event);\n            onClose == null ? void 0 : onClose(event);\n          }\n        },\n        index\n      ))\n    }\n  );\n};\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcmVhZ3JhcGgvZGlzdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEUsdUJBQXVCLFdBQVcsWUFBWSxhQUFhLGNBQWMsR0FBRyx1QkFBdUIsbUNBQW1DLHFCQUFxQix1QkFBdUIsZ0RBQWdELEdBQUcsNkNBQTZDLG1CQUFtQixLQUFLLHlFQUF5RSw0QkFBNEIsT0FBTywrRUFBK0Usd0JBQXdCLE9BQU8scUZBQXFGLGlEQUFpRCwyREFBMkQsU0FBUyx1REFBdUQsa0JBQWtCLG1CQUFtQixnQ0FBZ0MseUJBQXlCLG9CQUFvQiwrQ0FBK0Msc0NBQXNDLEtBQUssK0VBQStFLDJCQUEyQixvQkFBb0IsMkJBQTJCLE9BQU8sa0dBQWtHLGdDQUFnQyxTQUFTLCtCQUErQixxQkFBcUIsNENBQTRDLG1CQUFtQixrQkFBa0IscUJBQXFCLEtBQUssdUJBQXVCLHVCQUF1QixlQUFlLHVCQUF1QixrQkFBa0IsaUJBQWlCLGdEQUFnRCxxQkFBcUIsOENBQThDLEdBQUcsa0NBQWtDLG1CQUFtQiw0Q0FBNEMseUJBQXlCLG1CQUFtQixrQkFBa0IseUJBQXlCLGlCQUFpQixlQUFlLGdCQUFnQix1Q0FBdUMsS0FBSztBQUN0K0Q7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ3dEO0FBQ29KO0FBQ3BJO0FBQ2lGO0FBQ3ZGO0FBQ2I7QUFDRztBQUNNO0FBQ2I7QUFDZ0I7QUFDVTtBQUNwQztBQUNOO0FBQ1c7QUFDeVE7QUFDclE7QUFDUztBQUMxQjtBQUMwQztBQUN2QztBQUNpQjtBQUNEO0FBQ2I7QUFDRztBQUMyQjtBQUMvQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxrQkFBa0I7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsS0FBSztBQUNwRDtBQUNBO0FBQ0EsK0NBQStDLEdBQUc7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsVUFBVSw0QkFBNEI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGtDQUFrQyx3REFBYTtBQUMvQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQixHQUFHO0FBQ0gsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0UsT0FBTztBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QywrQkFBK0I7QUFDeEU7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTCxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHVCQUF1QjtBQUM3QztBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGNBQWMseURBQU87QUFDckIsWUFBWSx5REFBUztBQUNyQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLG9CQUFvQix3REFBZSx1QkFBdUIsd0RBQU0sd0NBQXdDLHdEQUFNLDhDQUE4Qyx3REFBWSw0Q0FBNEMsd0RBQWE7QUFDak87QUFDQSxNQUFNLHdEQUFTO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsVUFBVSxlQUFlO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLHdEQUFNO0FBQ3JCLGVBQWUsd0RBQU07QUFDckIsSUFBSTtBQUNKLGVBQWUsd0RBQU07QUFDckIsZUFBZSx3REFBTTtBQUNyQjtBQUNBLGNBQWMsd0RBQWUsbUJBQW1CLHdEQUFXLHNCQUFzQix3REFBUyxvQkFBb0Isd0RBQWEsMEZBQTBGLHdEQUFNO0FBQzNOO0FBQ0EsSUFBSSx3REFBWTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDRCQUE0QjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpQkFBaUIsMERBQVE7QUFDekI7QUFDQSxHQUFHO0FBQ0gsVUFBVSxlQUFlO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsNEJBQTRCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFVBQVUsZUFBZTtBQUN6QixVQUFVLFNBQVM7QUFDbkI7QUFDQSxlQUFlLHlEQUFRO0FBQ3ZCO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsbUJBQW1CLHlEQUFJLHVEQUF1RCx5REFBUztBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDRCQUE0QjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxVQUFVLGVBQWU7QUFDekIsaUJBQWlCLHVEQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsNEJBQTRCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELEVBQUUsK0RBQWE7QUFDZixpQkFBaUIsMERBQWlCO0FBQ2xDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwrQkFBK0I7QUFDakQsVUFBVSxlQUFlO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLG1DQUFtQyw0QkFBNEI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxZQUFZLDZDQUE2QztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxJQUFJO0FBQ0osWUFBWSxTQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0osMEJBQTBCLHFCQUFxQjtBQUMvQyxJQUFJO0FBQ0osMEJBQTBCLHFCQUFxQjtBQUMvQyxJQUFJO0FBQ0osWUFBWSw2REFBNkQ7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0osWUFBWSx3REFBd0Q7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDRCQUE0QixNQUFNO0FBQ2xDO0FBQ0E7QUFDQSxVQUFVLFVBQVU7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGdCQUFnQixzRUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxnQkFBZ0IseUZBQWdCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsTUFBTSwyQkFBMkIsUUFBUTtBQUMzRTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGFBQWE7QUFDeEI7QUFDQSxHQUFHO0FBQ0g7QUFDQSw0QkFBNEIsZUFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsS0FBSztBQUNyRDtBQUNBLFVBQVUsMEJBQTBCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGtCQUFrQixxREFBVztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxTQUFTLFNBQVM7QUFDeEIsK0JBQStCLFFBQVE7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sU0FBUyxTQUFTO0FBQ3hCLCtCQUErQixRQUFRO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxnREFBZ0Qsc0JBQXNCO0FBQ3RFO0FBQ0E7QUFDQSxZQUFZLHlDQUF5QztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGlDQUFpQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QiwyQ0FBTztBQUNoQyx1QkFBdUIsMkNBQU87QUFDOUIsd0JBQXdCLDJDQUFPO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMkNBQU87QUFDdkI7QUFDQTtBQUNBLGlCQUFpQiwyQ0FBTztBQUN4QjtBQUNBLGdCQUFnQiwyQ0FBTztBQUN2QixpQkFBaUIsMkNBQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix5REFBcUI7QUFDM0M7QUFDQSxVQUFVLDhDQUFVO0FBQ3BCO0FBQ0E7QUFDQSxhQUFhLDJDQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxxQkFBcUI7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsb0JBQW9CLDZDQUFNO0FBQzFCLGdCQUFnQiw2Q0FBTTtBQUN0QixnQkFBZ0IsNkNBQU07QUFDdEIsaUJBQWlCLDZDQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILHNCQUFzQixrREFBVztBQUNqQztBQUNBO0FBQ0EsR0FBRztBQUNILDBCQUEwQixrREFBVztBQUNyQztBQUNBO0FBQ0EsY0FBYyxlQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esa0JBQWtCLGtEQUFXO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILHNCQUFzQixrREFBVztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsZ0JBQWdCLGtEQUFXO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxxQkFBcUIsa0RBQVc7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsaUJBQWlCLHNEQUFRO0FBQ3pCLG9CQUFvQixzREFBUTtBQUM1QixlQUFlLHNEQUFRO0FBQ3ZCLGFBQWEsc0RBQVE7QUFDckIsVUFBVSwwQ0FBMEMsRUFBRSw4Q0FBTztBQUM3RDtBQUNBO0FBQ0EsbUJBQW1CLDJDQUFPO0FBQzFCO0FBQ0EsbUJBQW1CLDJDQUFPO0FBQzFCO0FBQ0Esa0JBQWtCLDJDQUFPO0FBQ3pCO0FBQ0Esa0JBQWtCLDJDQUFPO0FBQ3pCO0FBQ0EsaUJBQWlCLHlDQUFLO0FBQ3RCLEtBQUs7QUFDTDtBQUNBO0FBQ0EscUJBQXFCLDhDQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFNBQVMsK0RBQVU7QUFDbkI7QUFDQSxzQkFBc0IsT0FBTztBQUM3QixnQkFBZ0IscUJBQXFCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxpQkFBaUIscUJBQXFCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMkNBQU87QUFDbkM7QUFDQSw2QkFBNkIsMkNBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0wsTUFBTSxRQUFRO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsU0FBUyx1RUFBYTtBQUN0QjtBQUNBLFFBQVEscUJBQXFCLEVBQUUsNERBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsS0FBSyxnREFBTTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLGFBQWEsa0RBQUssR0FBRyxhQUFhO0FBQ2xDLDBDQUEwQyx5QkFBeUI7QUFDbkUsK0NBQStDLG9CQUFvQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsbURBQW1ELHNCQUFzQjtBQUN6RSw2Q0FBNkMsbUJBQW1CO0FBQ2hFLHlDQUF5QyxpQkFBaUI7QUFDMUQsMkNBQTJDLG1EQUFtRDtBQUM5RjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsOENBQThDLDZCQUE2QjtBQUMzRSxvREFBb0QsbUNBQW1DO0FBQ3ZGLHlEQUF5RCx5QkFBeUI7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gseUNBQXlDLGlCQUFpQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwyQ0FBTztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEdBQUc7QUFDSCwyREFBMkQscUNBQXFDO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QiwyQ0FBTztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkJBQTJCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsOENBQThDO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QseUJBQXlCLGtEQUFXO0FBQ3BDO0FBQ0EsY0FBYyxlQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSwyQkFBMkIsa0RBQVc7QUFDdEM7QUFDQSxjQUFjLGVBQWU7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsNkJBQTZCLCtCQUErQjtBQUM1RCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw2Q0FBTTtBQUM5QixpQkFBaUIsNkNBQU07QUFDdkIsaUJBQWlCLHNEQUFRO0FBQ3pCLGtCQUFrQiw2Q0FBTTtBQUN4QixzQkFBc0IsNkNBQU07QUFDNUIsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxVQUFVLDZCQUE2QixFQUFFLDhDQUFPO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxzQkFBc0Isa0RBQVc7QUFDakM7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSx1QkFBdUIsa0RBQVc7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsZ0RBQVM7QUFDWDtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFTO0FBQ1g7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFTO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFTO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDBDQUEwQyx1Q0FBUztBQUNuRCwwQkFBMEIsOENBQU8sV0FBVyx5Q0FBSztBQUNqRCwyQkFBMkIsOENBQU87QUFDbEMsdUJBQXVCLHlDQUFLO0FBQzVCO0FBQ0E7QUFDQSx5QkFBeUIsc0RBQUcsQ0FBQywrQ0FBUyxJQUFJLCtDQUErQyxzREFBRztBQUM1RixJQUFJLDBDQUFJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMEJBQTBCLDhDQUFPLFdBQVcseUNBQUs7QUFDakQsVUFBVSx3QkFBd0IsRUFBRSwrREFBUztBQUM3QztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSx5QkFBeUIsc0RBQUcsQ0FBQywrQ0FBUyxJQUFJLCtDQUErQyx1REFBSSxDQUFDLG1EQUFDLFNBQVM7QUFDeEcsb0JBQW9CLHNEQUFHO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzREFBRztBQUN2QixNQUFNLG1EQUFDO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw4Q0FBVTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxLQUFLLEdBQUc7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFVBQVUscUJBQXFCLEVBQUUsK0RBQVM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILDBCQUEwQiw4Q0FBTyxXQUFXLHlDQUFLO0FBQ2pEO0FBQ0EseUJBQXlCLHVEQUFJLENBQUMsdURBQVEsSUFBSTtBQUMxQyxvQkFBb0IsdURBQUksQ0FBQyxtREFBQyxTQUFTLFlBQVksa0JBQWtCO0FBQ2pFLHNCQUFzQixzREFBRyxxQkFBcUIsdUNBQXVDO0FBQ3JGLHNCQUFzQixzREFBRztBQUN6QixRQUFRLG1EQUFDO0FBQ1Q7QUFDQTtBQUNBLGdCQUFnQiw4Q0FBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asb0JBQW9CLHNEQUFHO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSw4QkFBOEIsb0RBQWU7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esa0JBQWtCLGlEQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQW1CO0FBQ25CO0FBQ0EsU0FBUztBQUNULFdBQVc7QUFDWCxXQUFXO0FBQ1gsV0FBVztBQUNYLGNBQWM7QUFDZCxXQUFXO0FBQ1gsYUFBYTtBQUNiLFFBQVE7QUFDUixZQUFZLDBDQUFRO0FBQ3BCLGFBQWE7QUFDYjtBQUNBLHFCQUFxQiw2Q0FBUztBQUM5QixtQkFBbUIsNkNBQVM7QUFDNUI7QUFDQTtBQUNBLENBQUM7QUFDRCxzREFBTSxHQUFHLG1CQUFtQiw0REFBRTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isd0RBQXlCO0FBQzdDLHFCQUFxQix3REFBeUI7QUFDOUMsa0JBQWtCLHdEQUF5QjtBQUMzQyxvQkFBb0Isd0RBQXlCO0FBQzdDLHVCQUF1QixpREFBVTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxzQkFBc0IsNkNBQU07QUFDNUIsbUJBQW1CLHNEQUFRO0FBQzNCLGVBQWUsc0RBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDZDQUFNO0FBQ2pDLElBQUksc0RBQVE7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDZDQUFTO0FBQ2hFO0FBQ0EsS0FBSztBQUNMLElBQUksZ0RBQVM7QUFDYjtBQUNBO0FBQ0EsS0FBSztBQUNMLG1CQUFtQixrREFBVztBQUM5QjtBQUNBO0FBQ0EsS0FBSztBQUNMLG9CQUFvQixrREFBVztBQUMvQjtBQUNBO0FBQ0EsS0FBSztBQUNMLG9CQUFvQixrREFBVztBQUMvQjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLHFCQUFxQixrREFBVztBQUNoQztBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLHFCQUFxQixrREFBVztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxvQkFBb0Isa0RBQVc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0Esa0JBQWtCLGtEQUFXO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLG9CQUFvQixrREFBVztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxzQkFBc0Isa0RBQVc7QUFDakM7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELHdEQUFtQjtBQUNyRSxZQUFZO0FBQ1osa0RBQWtELHdEQUFtQjtBQUNyRTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxvQkFBb0Isa0RBQVc7QUFDL0I7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELHdEQUFtQjtBQUNyRSxZQUFZO0FBQ1osa0RBQWtELHdEQUFtQjtBQUNyRTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxJQUFJLGdEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJLGdEQUFTO0FBQ2I7QUFDQSw4Q0FBOEMsd0RBQW1CO0FBQ2pFLGdEQUFnRCx3REFBbUI7QUFDbkUsK0NBQStDLHdEQUFtQjtBQUNsRSxRQUFRO0FBQ1IsOENBQThDLHdEQUFtQjtBQUNqRSxnREFBZ0Qsd0RBQW1CO0FBQ25FLCtDQUErQyx3REFBbUI7QUFDbEU7QUFDQSxLQUFLO0FBQ0wsSUFBSSxnREFBUztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUksZ0RBQVM7QUFDYjtBQUNBLDhDQUE4Qyx3REFBbUI7QUFDakUsd0NBQXdDLHdEQUFtQjtBQUMzRCxRQUFRO0FBQ1I7QUFDQSxnREFBZ0Qsd0RBQW1CO0FBQ25FLDBDQUEwQyx3REFBbUI7QUFDN0QsVUFBVTtBQUNWLDBDQUEwQyx3REFBbUI7QUFDN0QsZ0RBQWdELHdEQUFtQjtBQUNuRTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUksb0RBQVU7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw4Q0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsV0FBVztBQUMzRCxrREFBa0QsV0FBVztBQUM3RCxnREFBZ0QsV0FBVztBQUMzRCw0Q0FBNEMsV0FBVztBQUN2RDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxJQUFJLDBEQUFtQjtBQUN2QiwyQkFBMkIsdURBQUksbUNBQW1DO0FBQ2xFLHNCQUFzQixzREFBRztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHNDQUFzQywrQ0FBUTtBQUM5QyxxQkFBcUIsc0RBQVE7QUFDN0IsVUFBVSxXQUFXO0FBQ3JCLGlCQUFpQixzREFBUTtBQUN6QixrQkFBa0IsNkNBQU07QUFDeEIsc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixrREFBVztBQUNwQyw0QkFBNEIsZ0RBQWdEO0FBQzVFLGNBQWMsMEJBQTBCO0FBQ3hDO0FBQ0EsZ0JBQWdCLHFDQUFxQztBQUNyRDtBQUNBLGtCQUFrQix1Q0FBdUM7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHdDQUFJO0FBQ2xCLGdCQUFnQiwyQ0FBTztBQUN2QixnQkFBZ0IsMkNBQU87QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFXO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0EscUNBQXFDLElBQUk7QUFDekM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDBCQUEwQixrREFBVztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsNkJBQTZCLGtEQUFXO0FBQ3hDO0FBQ0E7QUFDQSxtREFBbUQsbUJBQW1CO0FBQ3RFLEtBQUs7QUFDTDtBQUNBO0FBQ0EsRUFBRSxzREFBZTtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsaUJBQWlCO0FBQ3RELHdDQUF3QyxpQkFBaUI7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLG9EQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxrQkFBa0IsOENBQU8sV0FBVyxpREFBYTtBQUNqRCxVQUFVLHVCQUF1QixFQUFFLCtEQUFTO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gseUJBQXlCLHNEQUFHLENBQUMsbURBQUMsV0FBVyxZQUFZLGtCQUFrQixtQ0FBbUMsc0RBQUc7QUFDN0csSUFBSSxtREFBQztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksOENBQVU7QUFDdEIsZ0NBQWdDLHNEQUFHLGdCQUFnQiwyQ0FBMkMsZ0RBQVksRUFBRTtBQUM1RztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxxQkFBcUIsdURBQUksQ0FBQyx1REFBUSxJQUFJO0FBQ3ZDLGtCQUFrQixzREFBRztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isc0RBQUc7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLFVBQVUsUUFBUSxFQUFFLCtEQUFTO0FBQzdCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCwwQkFBMEIsOENBQU8sV0FBVyx5Q0FBSztBQUNqRCx5QkFBeUIsc0RBQUcsQ0FBQyxtREFBQyxVQUFVLFlBQVksa0JBQWtCLG1DQUFtQyxzREFBRyxDQUFDLCtDQUFTLElBQUksK0NBQStDLHNEQUFHO0FBQzVLLElBQUkseUNBQUs7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhDQUFVO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxHQUFHO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHFCQUFxQix1REFBSSxDQUFDLHVEQUFRLElBQUk7QUFDdkMsa0JBQWtCLHNEQUFHO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixzREFBRztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGdCQUFnQiw2Q0FBTTtBQUN0Qiw4QkFBOEIsK0NBQVE7QUFDdEMsd0NBQXdDLCtDQUFRO0FBQ2hEO0FBQ0E7QUFDQSxzQkFBc0IsOENBQU87QUFDN0I7QUFDQTtBQUNBLEdBQUc7QUFDSCxxQkFBcUIsa0RBQVc7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxXQUFXLCtDQUErQyxJQUFJLCtEQUFTO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxtREFBUztBQUNYLEVBQUUsbURBQVM7QUFDWDtBQUNBO0FBQ0E7QUFDQSxFQUFFLG1EQUFTO0FBQ1g7QUFDQTtBQUNBLFVBQVUsMEJBQTBCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsd0JBQXdCLDhDQUFPO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssb0JBQW9CLHNEQUFHLENBQUMsdURBQVEsSUFBSSxzQ0FBc0Msc0RBQUc7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNEQUFHO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDhDQUFPO0FBQ2hDO0FBQ0E7QUFDQSxnR0FBZ0csdURBQUksQ0FBQyx1REFBUSxJQUFJO0FBQ2pILHdCQUF3QixzREFBRyxDQUFDLG1EQUFDLFVBQVUsbURBQW1ELHNEQUFHO0FBQzdGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxvQ0FBb0Msc0RBQUcsQ0FBQyxtREFBQyxVQUFVLHNEQUFzRCxzREFBRztBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOENBQU87QUFDL0Isd0RBQXdELHNEQUFHLENBQUMsMENBQUksSUFBSTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxHQUFHO0FBQ1I7QUFDQTtBQUNBLHlCQUF5Qix1REFBSTtBQUM3QixJQUFJLG1EQUFDO0FBQ0w7QUFDQTtBQUNBLGtCQUFrQixrQkFBa0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMEJBQTBCLDhDQUFPLFdBQVcseUNBQUs7QUFDakQsa0JBQWtCLDZDQUFNO0FBQ3hCO0FBQ0E7QUFDQSxXQUFXLG1CQUFtQixJQUFJLCtEQUFTO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esd0JBQXdCLGtEQUFXO0FBQ25DO0FBQ0EscUJBQXFCLDJDQUFPO0FBQzVCO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWCx5QkFBeUIsdURBQUk7QUFDN0IsSUFBSSxtREFBQztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSx3QkFBd0Isc0RBQUc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNEQUFHO0FBQzNCLFVBQVUsbURBQUM7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsOENBQVU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxrQkFBa0IsNkNBQU07QUFDeEI7QUFDQSwwQkFBMEIsOENBQU8sV0FBVyx5Q0FBSztBQUNqRDtBQUNBLGtCQUFrQiw2Q0FBTTtBQUN4QixVQUFVLGNBQWMsRUFBRSwrREFBUztBQUNuQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSwrREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLGdCQUFnQiwyQkFBMkI7QUFDM0MsK0JBQStCLDJDQUFPO0FBQ3RDLDZCQUE2QiwyQ0FBTztBQUNwQztBQUNBLGlDQUFpQyxnREFBWTtBQUM3QyxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFTO0FBQ1g7QUFDQSxHQUFHO0FBQ0gseUJBQXlCLHVEQUFJO0FBQzdCO0FBQ0E7QUFDQSxrQkFBa0Isa0JBQWtCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSx3QkFBd0Isc0RBQUcsbUJBQW1CLGtDQUFrQztBQUNoRix3QkFBd0Isc0RBQUc7QUFDM0IsVUFBVSxtREFBQztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsOEJBQThCLCtDQUFRO0FBQ3RDLHdDQUF3QywrQ0FBUTtBQUNoRDtBQUNBO0FBQ0EsVUFBVSw4REFBOEQ7QUFDeEU7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDhDQUFPO0FBQzFDLFVBQVUsc0JBQXNCLEVBQUUsOENBQU87QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGdEQUFnRCw4Q0FBTztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxtQkFBbUIsOENBQU87QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDJDQUFPO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFdBQVcsZUFBZSxJQUFJLCtEQUFTO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSx3QkFBd0IsOENBQU87QUFDL0IsY0FBYyx5Q0FBSztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxtREFBUztBQUNYLFVBQVUsMEJBQTBCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILHlCQUF5Qiw4Q0FBTztBQUNoQyx1REFBdUQsc0RBQUc7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOENBQU87QUFDaEMsbURBQW1ELHNEQUFHO0FBQ3RELE1BQU0sbURBQUM7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esa0NBQWtDLHNEQUFHO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOENBQU87QUFDL0Isd0RBQXdELHNEQUFHLENBQUMsMENBQUksSUFBSSx5RUFBeUUsa0RBQWtELEdBQUc7QUFDbE07QUFDQTtBQUNBLHlCQUF5Qix1REFBSSxZQUFZO0FBQ3pDLG9CQUFvQixzREFBRztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMEJBQTBCLCtDQUFXO0FBQ3JDO0FBQ0EsbUJBQW1CLDZDQUFNO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCwyQkFBMkIsNkNBQU07QUFDakMsRUFBRSw2Q0FBTSxLQUFLLCtDQUFXO0FBQ3hCLCtCQUErQiw2Q0FBTTtBQUNyQztBQUNBLHdCQUF3QixrREFBVztBQUNuQztBQUNBO0FBQ0E7QUFDQSxjQUFjLFFBQVE7QUFDdEI7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLG9EQUFnQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMkJBQTJCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0JBQWdCLEdBQUcsZ0JBQWdCLEdBQUcsY0FBYyxHQUFHLGNBQWMsR0FBRyxLQUFLO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixnREFBWTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw4Q0FBVTtBQUN6QywwQ0FBMEMsMkNBQU87QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixnREFBWTtBQUN6QztBQUNBLHVCQUF1QixvRUFBcUI7QUFDNUM7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLGFBQWEsb0VBQXFCO0FBQ2xDO0FBQ0Esc0NBQXNDLG9FQUFxQjtBQUMzRCxvQ0FBb0Msb0VBQXFCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDZDQUFNO0FBQy9CLEVBQUUsZ0RBQVM7QUFDWDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSSxrREFBVztBQUNmO0FBQ0EsbUJBQW1CLDZDQUFNO0FBQ3pCLHNCQUFzQixrREFBVztBQUNqQztBQUNBLEdBQUc7QUFDSCw4QkFBOEIsNkNBQU07QUFDcEMsNEJBQTRCLGtEQUFXO0FBQ3ZDO0FBQ0EsR0FBRztBQUNILDhCQUE4QixrREFBVztBQUN6QztBQUNBLGNBQWMsc0RBQXNEO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDZDQUFNO0FBQzVCLHFCQUFxQiw2Q0FBTTtBQUMzQixFQUFFLGdEQUFTO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILGdDQUFnQyxrREFBVztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsaUNBQWlDLGtEQUFXO0FBQzVDO0FBQ0E7QUFDQSw0QkFBNEIsbURBQWU7QUFDM0M7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLCtEQUFTO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFdBQVcsZ0NBQWdDLElBQUksK0RBQVM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLFVBQVUsd0RBQXdEO0FBQ2xFO0FBQ0EscUJBQXFCLDhDQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDhDQUFPO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw4Q0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGVBQWUsSUFBSSwrREFBUztBQUN2QztBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsNEJBQTRCLGtEQUFXO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esd0JBQXdCLDhDQUFPO0FBQy9CO0FBQ0EsaUJBQWlCLHlDQUFLO0FBQ3RCO0FBQ0EsZUFBZSx5Q0FBSztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsOENBQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHFCQUFxQiw4Q0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdURBQUksWUFBWTtBQUN6Qyw2Q0FBNkMsc0RBQUcsQ0FBQyxtREFBQyxVQUFVLG1EQUFtRCxzREFBRyxVQUFVLGVBQWUsR0FBRztBQUM5SSxvRUFBb0Usc0RBQUcsQ0FBQywwQ0FBSSxJQUFJO0FBQ2hGO0FBQ0E7QUFDQSxLQUFLLEdBQUc7QUFDUixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLFVBQVUsNkJBQTZCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsOENBQU87QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBLDhCQUE4Qiw4Q0FBTztBQUNyQztBQUNBO0FBQ0E7QUFDQSxVQUFVLGlDQUFpQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQSwyREFBMkQsd0NBQUk7QUFDL0Q7QUFDQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsNkNBQU0sS0FBSyx3Q0FBSTtBQUN4QywwQkFBMEIsNkNBQU0sS0FBSyx3Q0FBSTtBQUN6QyxvQkFBb0Isa0RBQVc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsVUFBVSxzREFBc0Q7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkNBQU07QUFDOUIsMEJBQTBCLDZDQUFNO0FBQ2hDLEVBQUUsc0RBQVE7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsdURBQUksWUFBWTtBQUN6QyxvQkFBb0IsdURBQUksV0FBVztBQUNuQyxzQkFBc0Isc0RBQUc7QUFDekIsUUFBUSxtREFBQztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw4Q0FBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isc0RBQUc7QUFDekIsUUFBUSxtREFBQztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw4Q0FBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asb0JBQW9CLHVEQUFJLFdBQVc7QUFDbkMsc0JBQXNCLHNEQUFHO0FBQ3pCLFFBQVEsbURBQUM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsOENBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHNEQUFHO0FBQ3pCLFFBQVEsbURBQUM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsOENBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHdDQUF3QyxzREFBRztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLFVBQVUseUJBQXlCLEVBQUUsK0RBQVM7QUFDOUMsWUFBWSxZQUFZO0FBQ3hCLFVBQVUsU0FBUztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsdURBQUksQ0FBQyx1REFBUSxJQUFJO0FBQzFDLG9CQUFvQix1REFBSSxXQUFXO0FBQ25DLHNCQUFzQixzREFBRyxtQkFBbUIsaURBQWlEO0FBQzdGLHNCQUFzQixzREFBRztBQUN6QixRQUFRLG1EQUFDO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDhDQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxvQkFBb0IsdURBQUksV0FBVztBQUNuQyxzQkFBc0Isc0RBQUc7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHNEQUFHO0FBQ3pCLFFBQVEsbURBQUM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsOENBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QiwrQ0FBUTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHdCQUF3Qiw4Q0FBTztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILFVBQVUsaUJBQWlCLEVBQUUsK0RBQVM7QUFDdEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILDJCQUEyQiw4Q0FBTztBQUNsQztBQUNBO0FBQ0EsaUJBQWlCLHlDQUFLO0FBQ3RCLEtBQUs7QUFDTDtBQUNBO0FBQ0EseUJBQXlCLDhDQUFPO0FBQ2hDO0FBQ0E7QUFDQSxpQkFBaUIseUNBQUs7QUFDdEIsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsbUNBQW1DO0FBQ2xGO0FBQ0EsR0FBRztBQUNILEVBQUUsbURBQVM7QUFDWCxFQUFFLG1EQUFTO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsRUFBRSxtREFBUztBQUNYLFVBQVUsMEJBQTBCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsa0JBQWtCLDhDQUFPO0FBQ3pCO0FBQ0E7QUFDQSw4Q0FBOEMsc0RBQUc7QUFDakQsUUFBUSxtREFBQztBQUNUO0FBQ0Esc0JBQXNCLDRCQUE0QjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGNBQWM7QUFDakU7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsb0JBQW9CLHVEQUFJLENBQUMsdURBQVEsSUFBSTtBQUNoRCw0QkFBNEIsc0RBQUc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0ZBQW9GLHNEQUFHLENBQUMsbURBQUMsVUFBVSxtREFBbUQsc0RBQUc7QUFDeko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsYUFBYTtBQUNiO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsaURBQVU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILFlBQVksK0JBQStCO0FBQzNDLGVBQWUsc0RBQVE7QUFDdkIsa0JBQWtCLHNEQUFRO0FBQzFCLG1CQUFtQixzREFBUTtBQUMzQixZQUFZLGVBQWUsYUFBYSw0QkFBNEI7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxrREFBa0Q7QUFDOUQ7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUksMERBQW1CO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsaUNBQWlDLGtEQUFXO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLDJCQUEyQiw4Q0FBTztBQUNsQyw2Q0FBNkMsc0RBQUc7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsOENBQU87QUFDbEMsd0RBQXdELHNEQUFHO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSwyQkFBMkIsc0RBQUc7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsOENBQU87QUFDckMsZ0RBQWdELHNEQUFHO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsdURBQUksQ0FBQywyQ0FBVSxJQUFJO0FBQzVEO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFVBQVUsOENBQThDLEVBQUUsOENBQU87QUFDakU7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDZDQUFNO0FBQ3hCLEVBQUUsc0RBQWU7QUFDakI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsc0RBQUc7QUFDNUI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHdDQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLDREQUE0RCxzREFBRztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF3RUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy8uL25vZGVfbW9kdWxlcy9yZWFncmFwaC9kaXN0L2luZGV4LmpzPzgxNDciXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuICBcInVzZSBzdHJpY3RcIjtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHZhciBlbGVtZW50U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgICBlbGVtZW50U3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCIuX2NhbnZhc182NzB6cF8xIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogMDtcXG4gIGxlZnQ6IDA7XFxuICByaWdodDogMDtcXG4gIGJvdHRvbTogMDtcXG59XFxuLl9jb250YWluZXJfMTU1bDdfMSB7XFxuICB0cmFuc2Zvcm0tb3JpZ2luOiBib3R0b20gcmlnaHQ7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgYm9yZGVyOiBzb2xpZCAxcHggdmFyKC0tcmFkaWFsLW1lbnUtYm9yZGVyKTtcXG59XFxuXFxuICAuX2NvbnRhaW5lcl8xNTVsN18xLl9kaXNhYmxlZF8xNTVsN183IHtcXG4gICAgb3BhY2l0eTogMC42O1xcbiAgfVxcblxcbiAgLl9jb250YWluZXJfMTU1bDdfMS5fZGlzYWJsZWRfMTU1bDdfNyAuX2NvbnRlbnRDb250YWluZXJfMTU1bDdfMTAge1xcbiAgICAgIGN1cnNvcjogbm90LWFsbG93ZWQ7XFxuICAgIH1cXG5cXG4gIC5fY29udGFpbmVyXzE1NWw3XzE6bm90KC5fZGlzYWJsZWRfMTU1bDdfNykgLl9jb250ZW50Q29udGFpbmVyXzE1NWw3XzEwIHtcXG4gICAgICBjdXJzb3I6IHBvaW50ZXI7XFxuICAgIH1cXG5cXG4gIC5fY29udGFpbmVyXzE1NWw3XzE6bm90KC5fZGlzYWJsZWRfMTU1bDdfNykgLl9jb250ZW50Q29udGFpbmVyXzE1NWw3XzEwOmhvdmVyIHtcXG4gICAgICAgIGNvbG9yOiB2YXIoLS1yYWRpYWwtbWVudS1hY3RpdmUtY29sb3IpO1xcbiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tcmFkaWFsLW1lbnUtYWN0aXZlLWJhY2tncm91bmQpO1xcbiAgICAgIH1cXG5cXG4gIC5fY29udGFpbmVyXzE1NWw3XzEgLl9jb250ZW50Q29udGFpbmVyXzE1NWw3XzEwIHtcXG4gICAgd2lkdGg6IDIwMCU7XFxuICAgIGhlaWdodDogMjAwJTtcXG4gICAgdHJhbnNmb3JtLW9yaWdpbjogNTAlIDUwJTtcXG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xcbiAgICBvdXRsaW5lOiBub25lO1xcbiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDE1MG1zIGVhc2UtaW4tb3V0O1xcbiAgICBjb2xvcjogdmFyKC0tcmFkaWFsLW1lbnUtY29sb3IpO1xcbiAgfVxcblxcbiAgLl9jb250YWluZXJfMTU1bDdfMSAuX2NvbnRlbnRDb250YWluZXJfMTU1bDdfMTAgLl9jb250ZW50SW5uZXJfMTU1bDdfMzUge1xcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgICB3aWR0aDogMTAwJTtcXG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICAgIH1cXG5cXG4gIC5fY29udGFpbmVyXzE1NWw3XzEgLl9jb250ZW50Q29udGFpbmVyXzE1NWw3XzEwIC5fY29udGVudElubmVyXzE1NWw3XzM1IC5fY29udGVudF8xNTVsN18xMCB7XFxuICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICAgICAgfVxcblxcbiAgLl9jb250YWluZXJfMTU1bDdfMSBzdmcge1xcbiAgICBtYXJnaW46IDAgYXV0bztcXG4gICAgZmlsbDogdmFyKC0tcmFkaWFsLW1lbnUtYWN0aXZlLWNvbG9yKTtcXG4gICAgaGVpZ2h0OiAyNXB4O1xcbiAgICB3aWR0aDogMjVweDtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICB9XFxuLl9jb250YWluZXJfeDloeXhfMSB7XFxuICBib3JkZXItcmFkaXVzOiA1MCU7XFxuICB6LWluZGV4OiA5O1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgaGVpZ2h0OiAxNzVweDtcXG4gIHdpZHRoOiAxNzVweDtcXG4gIGJvcmRlcjogc29saWQgNXB4IHZhcigtLXJhZGlhbC1tZW51LWJvcmRlcik7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgYmFja2dyb3VuZDogdmFyKC0tcmFkaWFsLW1lbnUtYmFja2dyb3VuZCk7XFxufVxcblxcbiAgLl9jb250YWluZXJfeDloeXhfMTpiZWZvcmUge1xcbiAgICBjb250ZW50OiAnICc7XFxuICAgIGJhY2tncm91bmQ6IHZhcigtLXJhZGlhbC1tZW51LWJvcmRlcik7XFxuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcXG4gICAgaGVpZ2h0OiAyNXB4O1xcbiAgICB3aWR0aDogMjVweDtcXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICB6LWluZGV4OiA5O1xcbiAgICB0b3A6IDUwJTtcXG4gICAgbGVmdDogNTAlO1xcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTtcXG4gIH1cIikpO1xuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChlbGVtZW50U3R5bGUpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJ2aXRlLXBsdWdpbi1jc3MtaW5qZWN0ZWQtYnktanNcIiwgZSk7XG4gIH1cbn0pKCk7XG52YXIgX2EsIF9iO1xuaW1wb3J0IHsganN4LCBqc3hzLCBGcmFnbWVudCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xuaW1wb3J0IHsgdXNlUmVmLCB1c2VDYWxsYmFjaywgdXNlTWVtbywgdXNlRWZmZWN0LCBjcmVhdGVDb250ZXh0IGFzIGNyZWF0ZUNvbnRleHQkMSwgdXNlQ29udGV4dCwgZm9yd2FyZFJlZiwgdXNlSW1wZXJhdGl2ZUhhbmRsZSwgdXNlU3RhdGUsIHVzZUxheW91dEVmZmVjdCwgRnJhZ21lbnQgYXMgRnJhZ21lbnQkMSwgU3VzcGVuc2UgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVRocmVlLCBleHRlbmQsIHVzZUZyYW1lLCBDYW52YXMgfSBmcm9tIFwiQHJlYWN0LXRocmVlL2ZpYmVyXCI7XG5pbXBvcnQgeyBmb3JjZVJhZGlhbCBhcyBmb3JjZVJhZGlhbCQxLCBmb3JjZVNpbXVsYXRpb24sIGZvcmNlWCwgZm9yY2VZLCBmb3JjZUNvbGxpZGUsIGZvcmNlTWFueUJvZHksIGZvcmNlTGluaywgZm9yY2VDZW50ZXIsIGZvcmNlWiB9IGZyb20gXCJkMy1mb3JjZS0zZFwiO1xuaW1wb3J0IHsgdHJlZW1hcCwgaGllcmFyY2h5LCBzdHJhdGlmeSwgdHJlZSB9IGZyb20gXCJkMy1oaWVyYXJjaHlcIjtcbmltcG9ydCBjaXJjdWxhciBmcm9tIFwiZ3JhcGhvbG9neS1sYXlvdXQvY2lyY3VsYXIuanNcIjtcbmltcG9ydCBub3ZlcmxhcExheW91dCBmcm9tIFwiZ3JhcGhvbG9neS1sYXlvdXQtbm92ZXJsYXBcIjtcbmltcG9ydCBmb3JjZUF0bGFzMkxheW91dCBmcm9tIFwiZ3JhcGhvbG9neS1sYXlvdXQtZm9yY2VhdGxhczJcIjtcbmltcG9ydCByYW5kb20gZnJvbSBcImdyYXBob2xvZ3ktbGF5b3V0L3JhbmRvbS5qc1wiO1xuaW1wb3J0IHBhZ2VyYW5rIGZyb20gXCJncmFwaG9sb2d5LW1ldHJpY3MvY2VudHJhbGl0eS9wYWdlcmFuay5qc1wiO1xuaW1wb3J0IHsgZGVncmVlQ2VudHJhbGl0eSB9IGZyb20gXCJncmFwaG9sb2d5LW1ldHJpY3MvY2VudHJhbGl0eS9kZWdyZWUuanNcIjtcbmltcG9ydCB7IHNjYWxlTGluZWFyIH0gZnJvbSBcImQzLXNjYWxlXCI7XG5pbXBvcnQgeyBjcmVhdGUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IGNyZWF0ZUNvbnRleHQgZnJvbSBcInp1c3RhbmQvY29udGV4dFwiO1xuaW1wb3J0IHsgVmVjdG9yMywgUXVhZHJhdGljQmV6aWVyQ3VydmUzLCBMaW5lQ3VydmUzLCBWZWN0b3IyLCBQbGFuZSwgQ29sb3IsIERvdWJsZVNpZGUsIE1PVVNFLCBWZWN0b3I0LCBRdWF0ZXJuaW9uLCBNYXRyaXg0LCBTcGhlcmljYWwsIEJveDMsIFNwaGVyZSBhcyBTcGhlcmUkMSwgUmF5Y2FzdGVyLCBNYXRoVXRpbHMsIFRleHR1cmVMb2FkZXIsIExpbmVhckZpbHRlciwgVHViZUdlb21ldHJ5LCBFdWxlciwgQm94R2VvbWV0cnksIEN5bGluZGVyR2VvbWV0cnksIEJ1ZmZlckF0dHJpYnV0ZSwgTWVzaCwgU2NlbmUgfSBmcm9tIFwidGhyZWVcIjtcbmltcG9ydCB7IHVzZUdlc3R1cmUgfSBmcm9tIFwiQHVzZS1nZXN0dXJlL3JlYWN0XCI7XG5pbXBvcnQgeyBiaWRpcmVjdGlvbmFsIH0gZnJvbSBcImdyYXBob2xvZ3ktc2hvcnRlc3QtcGF0aFwiO1xuaW1wb3J0IEdyYXBoIGZyb20gXCJncmFwaG9sb2d5XCI7XG5pbXBvcnQgeyBCaWxsYm9hcmQsIFRleHQsIFN2ZyBhcyBTdmckMSwgdXNlQ3Vyc29yLCBIdG1sIH0gZnJvbSBcImdsb2RyZWlcIjtcbmltcG9ydCBlbGxpcHNpemUgZnJvbSBcImVsbGlwc2l6ZVwiO1xuaW1wb3J0IHsgdXNlU3ByaW5nLCBhIH0gZnJvbSBcIkByZWFjdC1zcHJpbmcvdGhyZWVcIjtcbmltcG9ydCBUaHJlZUNhbWVyYUNvbnRyb2xzIGZyb20gXCJjYW1lcmEtY29udHJvbHNcIjtcbmltcG9ydCB7IHVzZUhvdGtleXMgfSBmcm9tIFwicmVha2V5c1wiO1xuaW1wb3J0ICogYXMgaG9sZEV2ZW50IGZyb20gXCJob2xkLWV2ZW50XCI7XG5pbXBvcnQgeyBtZXJnZUJ1ZmZlckdlb21ldHJpZXMsIFNlbGVjdGlvbkJveCB9IGZyb20gXCJ0aHJlZS1zdGRsaWJcIjtcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5mdW5jdGlvbiB0cmF2ZXJzZUdyYXBoKG5vZGVzLCBub2RlU3RhY2sgPSBbXSkge1xuICBjb25zdCBjdXJyZW50RGVwdGggPSBub2RlU3RhY2subGVuZ3RoO1xuICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICBjb25zdCBpZHggPSBub2RlU3RhY2suaW5kZXhPZihub2RlKTtcbiAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgIGNvbnN0IGxvb3AgPSBbLi4ubm9kZVN0YWNrLnNsaWNlKGlkeCksIG5vZGVdLm1hcCgoZCkgPT4gZC5kYXRhLmlkKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEludmFsaWQgR3JhcGg6IENpcmN1bGFyIG5vZGUgcGF0aCBkZXRlY3RlZDogJHtsb29wLmpvaW4oXCIgLT4gXCIpfS5gXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoY3VycmVudERlcHRoID4gbm9kZS5kZXB0aCkge1xuICAgICAgbm9kZS5kZXB0aCA9IGN1cnJlbnREZXB0aDtcbiAgICAgIHRyYXZlcnNlR3JhcGgobm9kZS5vdXQsIFsuLi5ub2RlU3RhY2ssIG5vZGVdKTtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGdldE5vZGVEZXB0aChub2RlcywgbGlua3MpIHtcbiAgbGV0IGludmFsaWQgPSBmYWxzZTtcbiAgY29uc3QgZ3JhcGggPSBub2Rlcy5yZWR1Y2UoXG4gICAgKGFjYywgY3VyKSA9PiAoe1xuICAgICAgLi4uYWNjLFxuICAgICAgW2N1ci5pZF06IHtcbiAgICAgICAgZGF0YTogY3VyLFxuICAgICAgICBvdXQ6IFtdLFxuICAgICAgICBkZXB0aDogLTEsXG4gICAgICAgIGluczogW11cbiAgICAgIH1cbiAgICB9KSxcbiAgICB7fVxuICApO1xuICB0cnkge1xuICAgIGZvciAoY29uc3QgbGluayBvZiBsaW5rcykge1xuICAgICAgY29uc3QgZnJvbSA9IGxpbmsuc291cmNlO1xuICAgICAgY29uc3QgdG8gPSBsaW5rLnRhcmdldDtcbiAgICAgIGlmICghZ3JhcGguaGFzT3duUHJvcGVydHkoZnJvbSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIHNvdXJjZSBOb2RlICR7ZnJvbX1gKTtcbiAgICAgIH1cbiAgICAgIGlmICghZ3JhcGguaGFzT3duUHJvcGVydHkodG8pKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyB0YXJnZXQgTm9kZSAke3RvfWApO1xuICAgICAgfVxuICAgICAgY29uc3Qgc291cmNlTm9kZSA9IGdyYXBoW2Zyb21dO1xuICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGdyYXBoW3RvXTtcbiAgICAgIHRhcmdldE5vZGUuaW5zLnB1c2goc291cmNlTm9kZSk7XG4gICAgICBzb3VyY2VOb2RlLm91dC5wdXNoKHRhcmdldE5vZGUpO1xuICAgIH1cbiAgICB0cmF2ZXJzZUdyYXBoKE9iamVjdC52YWx1ZXMoZ3JhcGgpKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGludmFsaWQgPSB0cnVlO1xuICB9XG4gIGNvbnN0IGFsbERlcHRocyA9IE9iamVjdC5rZXlzKGdyYXBoKS5tYXAoKGlkKSA9PiBncmFwaFtpZF0uZGVwdGgpO1xuICBjb25zdCBtYXhEZXB0aCA9IE1hdGgubWF4KC4uLmFsbERlcHRocyk7XG4gIHJldHVybiB7XG4gICAgaW52YWxpZCxcbiAgICBkZXB0aHM6IGdyYXBoLFxuICAgIG1heERlcHRoOiBtYXhEZXB0aCB8fCAxXG4gIH07XG59XG5jb25zdCBSQURJQUxTID0gW1wicmFkaWFsaW5cIiwgXCJyYWRpYWxvdXRcIl07XG5mdW5jdGlvbiBmb3JjZVJhZGlhbCh7XG4gIG5vZGVzLFxuICBlZGdlcyxcbiAgbW9kZSA9IFwibHJcIixcbiAgbm9kZUxldmVsUmF0aW8gPSAyXG59KSB7XG4gIGNvbnN0IHsgZGVwdGhzLCBtYXhEZXB0aCwgaW52YWxpZCB9ID0gZ2V0Tm9kZURlcHRoKG5vZGVzLCBlZGdlcyk7XG4gIGlmIChpbnZhbGlkKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgbW9kZURpc3RhbmNlID0gUkFESUFMUy5pbmNsdWRlcyhtb2RlKSA/IDEgOiA1O1xuICBjb25zdCBkYWdMZXZlbERpc3RhbmNlID0gbm9kZXMubGVuZ3RoIC8gbWF4RGVwdGggKiBub2RlTGV2ZWxSYXRpbyAqIG1vZGVEaXN0YW5jZTtcbiAgaWYgKG1vZGUpIHtcbiAgICBjb25zdCBnZXRGRm4gPSAoZml4LCBpbnZlcnQpID0+IChub2RlKSA9PiAhZml4ID8gdm9pZCAwIDogKGRlcHRoc1tub2RlLmlkXS5kZXB0aCAtIG1heERlcHRoIC8gMikgKiBkYWdMZXZlbERpc3RhbmNlICogKGludmVydCA/IC0xIDogMSk7XG4gICAgY29uc3QgZnhGbiA9IGdldEZGbihbXCJsclwiLCBcInJsXCJdLmluY2x1ZGVzKG1vZGUpLCBtb2RlID09PSBcInJsXCIpO1xuICAgIGNvbnN0IGZ5Rm4gPSBnZXRGRm4oW1widGRcIiwgXCJidVwiXS5pbmNsdWRlcyhtb2RlKSwgbW9kZSA9PT0gXCJ0ZFwiKTtcbiAgICBjb25zdCBmekZuID0gZ2V0RkZuKFtcInppblwiLCBcInpvdXRcIl0uaW5jbHVkZXMobW9kZSksIG1vZGUgPT09IFwiem91dFwiKTtcbiAgICBub2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICBub2RlLmZ4ID0gZnhGbihub2RlKTtcbiAgICAgIG5vZGUuZnkgPSBmeUZuKG5vZGUpO1xuICAgICAgbm9kZS5meiA9IGZ6Rm4obm9kZSk7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIFJBRElBTFMuaW5jbHVkZXMobW9kZSkgPyBmb3JjZVJhZGlhbCQxKChub2RlKSA9PiB7XG4gICAgY29uc3Qgbm9kZURlcHRoID0gZGVwdGhzW25vZGUuaWRdO1xuICAgIGNvbnN0IGRlcHRoID0gbW9kZSA9PT0gXCJyYWRpYWxpblwiID8gbWF4RGVwdGggLSBub2RlRGVwdGguZGVwdGggOiBub2RlRGVwdGguZGVwdGg7XG4gICAgcmV0dXJuIGRlcHRoICogZGFnTGV2ZWxEaXN0YW5jZTtcbiAgfSkuc3RyZW5ndGgoMSkgOiBudWxsO1xufVxuZnVuY3Rpb24gdGljayhsYXlvdXQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCBfcmVqZWN0KSA9PiB7XG4gICAgbGV0IHN0YWJsZTtcbiAgICBmdW5jdGlvbiBydW4oKSB7XG4gICAgICBpZiAoIXN0YWJsZSkge1xuICAgICAgICBzdGFibGUgPSBsYXlvdXQuc3RlcCgpO1xuICAgICAgICBydW4oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoc3RhYmxlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcnVuKCk7XG4gIH0pO1xufVxuZnVuY3Rpb24gYnVpbGROb2RlRWRnZXMoZ3JhcGgpIHtcbiAgY29uc3Qgbm9kZXMgPSBbXTtcbiAgY29uc3QgZWRnZXMgPSBbXTtcbiAgZ3JhcGguZm9yRWFjaE5vZGUoKGlkLCBuKSA9PiB7XG4gICAgbm9kZXMucHVzaCh7XG4gICAgICAuLi5uLFxuICAgICAgaWQsXG4gICAgICAvLyBUaGlzIGlzIGZvciB0aGUgY2x1c3RlcmluZ1xuICAgICAgcmFkaXVzOiBuLnNpemUgfHwgMVxuICAgIH0pO1xuICB9KTtcbiAgZ3JhcGguZm9yRWFjaEVkZ2UoKGlkLCBsKSA9PiB7XG4gICAgZWRnZXMucHVzaCh7IC4uLmwsIGlkIH0pO1xuICB9KTtcbiAgcmV0dXJuIHsgbm9kZXMsIGVkZ2VzIH07XG59XG5mdW5jdGlvbiBmb3JjZUluQUJveCgpIHtcbiAgY29uc3QgY29uc3RhbnQgPSAoXykgPT4gKCkgPT4gXztcbiAgY29uc3QgaW5kZXggPSAoZCkgPT4gZC5pbmRleDtcbiAgbGV0IGlkID0gaW5kZXg7XG4gIGxldCBub2RlcyA9IFtdO1xuICBsZXQgbGlua3MgPSBbXTtcbiAgbGV0IGNsdXN0ZXJzO1xuICBsZXQgdHJlZTI7XG4gIGxldCBzaXplID0gWzEwMCwgMTAwXTtcbiAgbGV0IGZvcmNlTm9kZVNpemUgPSBjb25zdGFudCgxKTtcbiAgbGV0IGZvcmNlQ2hhcmdlID0gY29uc3RhbnQoLTEpO1xuICBsZXQgZm9yY2VMaW5rRGlzdGFuY2UgPSBjb25zdGFudCgxMDApO1xuICBsZXQgZm9yY2VMaW5rU3RyZW5ndGggPSBjb25zdGFudCgwLjEpO1xuICBsZXQgZm9jaSA9IHt9O1xuICBsZXQgbGlua1N0cmVuZ3RoSW50cmFDbHVzdGVyID0gMC4xO1xuICBsZXQgbGlua1N0cmVuZ3RoSW50ZXJDbHVzdGVyID0gMWUtMztcbiAgbGV0IHRlbXBsYXRlTm9kZXMgPSBbXTtcbiAgbGV0IG9mZnNldCA9IFswLCAwXTtcbiAgbGV0IHRlbXBsYXRlRm9yY2U7XG4gIGxldCBncm91cEJ5ID0gKGQpID0+IGQuY2x1c3RlcjtcbiAgbGV0IHRlbXBsYXRlID0gXCJ0cmVlbWFwXCI7XG4gIGxldCBlbmFibGVHcm91cGluZyA9IHRydWU7XG4gIGxldCBzdHJlbmd0aCA9IDAuMTtcbiAgZnVuY3Rpb24gZm9yY2UoYWxwaGEpIHtcbiAgICBpZiAoIWVuYWJsZUdyb3VwaW5nKSB7XG4gICAgICByZXR1cm4gZm9yY2U7XG4gICAgfVxuICAgIGlmICh0ZW1wbGF0ZSA9PT0gXCJmb3JjZVwiKSB7XG4gICAgICB0ZW1wbGF0ZUZvcmNlLnRpY2soKTtcbiAgICAgIGdldEZvY2lzRnJvbVRlbXBsYXRlKCk7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwLCBuID0gbm9kZXMubGVuZ3RoLCBub2RlLCBrID0gYWxwaGEgKiBzdHJlbmd0aDsgaSA8IG47ICsraSkge1xuICAgICAgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgbm9kZS52eCArPSAoZm9jaVtncm91cEJ5KG5vZGUpXS54IC0gbm9kZS54KSAqIGs7XG4gICAgICBub2RlLnZ5ICs9IChmb2NpW2dyb3VwQnkobm9kZSldLnkgLSBub2RlLnkpICogaztcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgICBpZiAoIW5vZGVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0ZW1wbGF0ZSA9PT0gXCJ0cmVlbWFwXCIpIHtcbiAgICAgIGluaXRpYWxpemVXaXRoVHJlZW1hcCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbml0aWFsaXplV2l0aEZvcmNlKCk7XG4gICAgfVxuICB9XG4gIGZvcmNlLmluaXRpYWxpemUgPSBmdW5jdGlvbihfKSB7XG4gICAgbm9kZXMgPSBfO1xuICAgIGluaXRpYWxpemUoKTtcbiAgfTtcbiAgZnVuY3Rpb24gZ2V0TGlua0tleShsKSB7XG4gICAgbGV0IHNvdXJjZUlEID0gZ3JvdXBCeShsLnNvdXJjZSksIHRhcmdldElEID0gZ3JvdXBCeShsLnRhcmdldCk7XG4gICAgcmV0dXJuIHNvdXJjZUlEIDw9IHRhcmdldElEID8gc291cmNlSUQgKyBcIn5cIiArIHRhcmdldElEIDogdGFyZ2V0SUQgKyBcIn5cIiArIHNvdXJjZUlEO1xuICB9XG4gIGZ1bmN0aW9uIGNvbXB1dGVDbHVzdGVyc05vZGVDb3VudHMobm9kZXMyKSB7XG4gICAgbGV0IGNsdXN0ZXJzQ291bnRzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSwgdG1wQ291bnQgPSB7fTtcbiAgICBub2RlczIuZm9yRWFjaChmdW5jdGlvbihkKSB7XG4gICAgICBpZiAoIWNsdXN0ZXJzQ291bnRzLmhhcyhncm91cEJ5KGQpKSkge1xuICAgICAgICBjbHVzdGVyc0NvdW50cy5zZXQoZ3JvdXBCeShkKSwgeyBjb3VudDogMCwgc3VtZm9yY2VOb2RlU2l6ZTogMCB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBub2RlczIuZm9yRWFjaChmdW5jdGlvbihkKSB7XG4gICAgICB0bXBDb3VudCA9IGNsdXN0ZXJzQ291bnRzLmdldChncm91cEJ5KGQpKTtcbiAgICAgIHRtcENvdW50LmNvdW50ID0gdG1wQ291bnQuY291bnQgKyAxO1xuICAgICAgdG1wQ291bnQuc3VtZm9yY2VOb2RlU2l6ZSA9IHRtcENvdW50LnN1bWZvcmNlTm9kZVNpemUgKyAvLyBAdHMtaWdub3JlXG4gICAgICBNYXRoLlBJICogKGZvcmNlTm9kZVNpemUoZCkgKiBmb3JjZU5vZGVTaXplKGQpKSAqIDEuMztcbiAgICAgIGNsdXN0ZXJzQ291bnRzLnNldChncm91cEJ5KGQpLCB0bXBDb3VudCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNsdXN0ZXJzQ291bnRzO1xuICB9XG4gIGZ1bmN0aW9uIGNvbXB1dGVDbHVzdGVyc0xpbmtDb3VudHMobGlua3MyKSB7XG4gICAgbGV0IGRDbHVzdGVyTGlua3MgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpLCBjbHVzdGVyTGlua3MgPSBbXTtcbiAgICBsaW5rczIuZm9yRWFjaChmdW5jdGlvbihsKSB7XG4gICAgICBsZXQga2V5ID0gZ2V0TGlua0tleShsKSwgY291bnQ7XG4gICAgICBpZiAoZENsdXN0ZXJMaW5rcy5oYXMoa2V5KSkge1xuICAgICAgICBjb3VudCA9IGRDbHVzdGVyTGlua3MuZ2V0KGtleSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb3VudCA9IDA7XG4gICAgICB9XG4gICAgICBjb3VudCArPSAxO1xuICAgICAgZENsdXN0ZXJMaW5rcy5zZXQoa2V5LCBjb3VudCk7XG4gICAgfSk7XG4gICAgZENsdXN0ZXJMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgIGxldCBzb3VyY2UsIHRhcmdldDtcbiAgICAgIHNvdXJjZSA9IGtleS5zcGxpdChcIn5cIilbMF07XG4gICAgICB0YXJnZXQgPSBrZXkuc3BsaXQoXCJ+XCIpWzFdO1xuICAgICAgaWYgKHNvdXJjZSAhPT0gdm9pZCAwICYmIHRhcmdldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIGNsdXN0ZXJMaW5rcy5wdXNoKHtcbiAgICAgICAgICBzb3VyY2UsXG4gICAgICAgICAgdGFyZ2V0LFxuICAgICAgICAgIGNvdW50OiB2YWx1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gY2x1c3RlckxpbmtzO1xuICB9XG4gIGZ1bmN0aW9uIGdldEdyb3Vwc0dyYXBoKCkge1xuICAgIGxldCBnbm9kZXMgPSBbXTtcbiAgICBsZXQgZ2xpbmtzID0gW107XG4gICAgbGV0IGROb2RlcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gICAgbGV0IGM7XG4gICAgbGV0IGk7XG4gICAgbGV0IGNjO1xuICAgIGxldCBjbHVzdGVyc0NvdW50cztcbiAgICBsZXQgY2x1c3RlcnNMaW5rcztcbiAgICBjbHVzdGVyc0NvdW50cyA9IGNvbXB1dGVDbHVzdGVyc05vZGVDb3VudHMobm9kZXMpO1xuICAgIGNsdXN0ZXJzTGlua3MgPSBjb21wdXRlQ2x1c3RlcnNMaW5rQ291bnRzKGxpbmtzKTtcbiAgICBmb3IgKGMgb2YgY2x1c3RlcnNDb3VudHMua2V5cygpKSB7XG4gICAgICBjYyA9IGNsdXN0ZXJzQ291bnRzLmdldChjKTtcbiAgICAgIGdub2Rlcy5wdXNoKHtcbiAgICAgICAgaWQ6IGMsXG4gICAgICAgIHNpemU6IGNjLmNvdW50LFxuICAgICAgICByOiBNYXRoLnNxcnQoY2Muc3VtZm9yY2VOb2RlU2l6ZSAvIE1hdGguUEkpXG4gICAgICB9KTtcbiAgICAgIGROb2Rlcy5zZXQoYywgaSk7XG4gICAgfVxuICAgIGNsdXN0ZXJzTGlua3MuZm9yRWFjaChmdW5jdGlvbihsKSB7XG4gICAgICBsZXQgc291cmNlID0gZE5vZGVzLmdldChsLnNvdXJjZSksIHRhcmdldCA9IGROb2Rlcy5nZXQobC50YXJnZXQpO1xuICAgICAgaWYgKHNvdXJjZSAhPT0gdm9pZCAwICYmIHRhcmdldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIGdsaW5rcy5wdXNoKHtcbiAgICAgICAgICBzb3VyY2UsXG4gICAgICAgICAgdGFyZ2V0LFxuICAgICAgICAgIGNvdW50OiBsLmNvdW50XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7IG5vZGVzOiBnbm9kZXMsIGxpbmtzOiBnbGlua3MgfTtcbiAgfVxuICBmdW5jdGlvbiBnZXRHcm91cHNUcmVlKCkge1xuICAgIGxldCBjaGlsZHJlbiA9IFtdO1xuICAgIGxldCBjO1xuICAgIGxldCBjYztcbiAgICBsZXQgY2x1c3RlcnNDb3VudHM7XG4gICAgY2x1c3RlcnNDb3VudHMgPSBjb21wdXRlQ2x1c3RlcnNOb2RlQ291bnRzKGZvcmNlLm5vZGVzKCkpO1xuICAgIGZvciAoYyBvZiBjbHVzdGVyc0NvdW50cy5rZXlzKCkpIHtcbiAgICAgIGNjID0gY2x1c3RlcnNDb3VudHMuZ2V0KGMpO1xuICAgICAgY2hpbGRyZW4ucHVzaCh7IGlkOiBjLCBzaXplOiBjYy5jb3VudCB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHsgaWQ6IFwiY2x1c3RlcnNUcmVlXCIsIGNoaWxkcmVuIH07XG4gIH1cbiAgZnVuY3Rpb24gZ2V0Rm9jaXNGcm9tVGVtcGxhdGUoKSB7XG4gICAgZm9jaS5ub25lID0geyB4OiAwLCB5OiAwIH07XG4gICAgdGVtcGxhdGVOb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgIGlmICh0ZW1wbGF0ZSA9PT0gXCJ0cmVlbWFwXCIpIHtcbiAgICAgICAgZm9jaVtkLmRhdGEuaWRdID0ge1xuICAgICAgICAgIHg6IGQueDAgKyAoZC54MSAtIGQueDApIC8gMiAtIG9mZnNldFswXSxcbiAgICAgICAgICB5OiBkLnkwICsgKGQueTEgLSBkLnkwKSAvIDIgLSBvZmZzZXRbMV1cbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvY2lbZC5pZF0gPSB7XG4gICAgICAgICAgeDogZC54IC0gb2Zmc2V0WzBdLFxuICAgICAgICAgIHk6IGQueSAtIG9mZnNldFsxXVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBmb2NpO1xuICB9XG4gIGZ1bmN0aW9uIGluaXRpYWxpemVXaXRoVHJlZW1hcCgpIHtcbiAgICBsZXQgc2ltID0gdHJlZW1hcCgpLnNpemUoZm9yY2Uuc2l6ZSgpKTtcbiAgICB0cmVlMiA9IGhpZXJhcmNoeShnZXRHcm91cHNUcmVlKCkpLnN1bSgoZCkgPT4gZC5yYWRpdXMpLnNvcnQoZnVuY3Rpb24oYTIsIGIpIHtcbiAgICAgIHJldHVybiBiLmhlaWdodCAtIGEyLmhlaWdodCB8fCBiLnZhbHVlIC0gYTIudmFsdWU7XG4gICAgfSk7XG4gICAgdGVtcGxhdGVOb2RlcyA9IHNpbSh0cmVlMikubGVhdmVzKCk7XG4gICAgZ2V0Rm9jaXNGcm9tVGVtcGxhdGUoKTtcbiAgfVxuICBmdW5jdGlvbiBjaGVja0xpbmtzQXNPYmplY3RzKCkge1xuICAgIGxldCBsaW5rQ291bnQgPSAwO1xuICAgIGlmIChub2Rlcy5sZW5ndGggPT09IDApXG4gICAgICByZXR1cm47XG4gICAgbGlua3MuZm9yRWFjaChmdW5jdGlvbihsaW5rKSB7XG4gICAgICBsZXQgc291cmNlLCB0YXJnZXQ7XG4gICAgICBpZiAoIW5vZGVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNvdXJjZSA9IGxpbmsuc291cmNlO1xuICAgICAgdGFyZ2V0ID0gbGluay50YXJnZXQ7XG4gICAgICBpZiAodHlwZW9mIGxpbmsuc291cmNlICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHNvdXJjZSA9IG5vZGVzLmZpbmQoKG4pID0+IG4uaWQgPT09IGxpbmsuc291cmNlKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgbGluay50YXJnZXQgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgdGFyZ2V0ID0gbm9kZXMuZmluZCgobikgPT4gbi5pZCA9PT0gbGluay50YXJnZXQpO1xuICAgICAgfVxuICAgICAgaWYgKHNvdXJjZSA9PT0gdm9pZCAwIHx8IHRhcmdldCA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHRocm93IEVycm9yKFxuICAgICAgICAgIFwiRXJyb3Igc2V0dGluZyBsaW5rcywgY291bGRudCBmaW5kIG5vZGVzIGZvciBhIGxpbmsgKHNlZSBpdCBvbiB0aGUgY29uc29sZSlcIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgbGluay5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBsaW5rLnRhcmdldCA9IHRhcmdldDtcbiAgICAgIGxpbmsuaW5kZXggPSBsaW5rQ291bnQrKztcbiAgICB9KTtcbiAgfVxuICBmdW5jdGlvbiBpbml0aWFsaXplV2l0aEZvcmNlKCkge1xuICAgIGxldCBuZXQ7XG4gICAgaWYgKCFub2RlcyB8fCAhbm9kZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNoZWNrTGlua3NBc09iamVjdHMoKTtcbiAgICBuZXQgPSBnZXRHcm91cHNHcmFwaCgpO1xuICAgIGlmIChjbHVzdGVycy5zaXplID4gMCkge1xuICAgICAgbmV0Lm5vZGVzLmZvckVhY2goKG4pID0+IHtcbiAgICAgICAgdmFyIF9hMiwgX2IyLCBfYywgX2Q7XG4gICAgICAgIG4uZnggPSAoX2IyID0gKF9hMiA9IGNsdXN0ZXJzLmdldChuLmlkKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5wb3NpdGlvbikgPT0gbnVsbCA/IHZvaWQgMCA6IF9iMi54O1xuICAgICAgICBuLmZ5ID0gKF9kID0gKF9jID0gY2x1c3RlcnMuZ2V0KG4uaWQpKSA9PSBudWxsID8gdm9pZCAwIDogX2MucG9zaXRpb24pID09IG51bGwgPyB2b2lkIDAgOiBfZC55O1xuICAgICAgfSk7XG4gICAgfVxuICAgIHRlbXBsYXRlRm9yY2UgPSBmb3JjZVNpbXVsYXRpb24obmV0Lm5vZGVzKS5mb3JjZShcInhcIiwgZm9yY2VYKHNpemVbMF0gLyAyKS5zdHJlbmd0aCgwLjEpKS5mb3JjZShcInlcIiwgZm9yY2VZKHNpemVbMV0gLyAyKS5zdHJlbmd0aCgwLjEpKS5mb3JjZShcImNvbGxpZGVcIiwgZm9yY2VDb2xsaWRlKChkKSA9PiBkLnIpLml0ZXJhdGlvbnMoNCkpLmZvcmNlKFwiY2hhcmdlXCIsIGZvcmNlTWFueUJvZHkoKS5zdHJlbmd0aChmb3JjZUNoYXJnZSkpLmZvcmNlKFxuICAgICAgXCJsaW5rc1wiLFxuICAgICAgZm9yY2VMaW5rKG5ldC5ub2Rlcy5sZW5ndGggPyBuZXQubGlua3MgOiBbXSkuZGlzdGFuY2UoZm9yY2VMaW5rRGlzdGFuY2UpLnN0cmVuZ3RoKGZvcmNlTGlua1N0cmVuZ3RoKVxuICAgICk7XG4gICAgdGVtcGxhdGVOb2RlcyA9IHRlbXBsYXRlRm9yY2Uubm9kZXMoKTtcbiAgICBnZXRGb2Npc0Zyb21UZW1wbGF0ZSgpO1xuICB9XG4gIGZvcmNlLnRlbXBsYXRlID0gZnVuY3Rpb24oeCkge1xuICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgIH1cbiAgICB0ZW1wbGF0ZSA9IHg7XG4gICAgaW5pdGlhbGl6ZSgpO1xuICAgIHJldHVybiBmb3JjZTtcbiAgfTtcbiAgZm9yY2UuZ3JvdXBCeSA9IGZ1bmN0aW9uKHgpIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBncm91cEJ5O1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHggPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGdyb3VwQnkgPSBmdW5jdGlvbihkKSB7XG4gICAgICAgIHJldHVybiBkW3hdO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBmb3JjZTtcbiAgICB9XG4gICAgZ3JvdXBCeSA9IHg7XG4gICAgcmV0dXJuIGZvcmNlO1xuICB9O1xuICBmb3JjZS5lbmFibGVHcm91cGluZyA9IGZ1bmN0aW9uKHgpIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBlbmFibGVHcm91cGluZztcbiAgICB9XG4gICAgZW5hYmxlR3JvdXBpbmcgPSB4O1xuICAgIHJldHVybiBmb3JjZTtcbiAgfTtcbiAgZm9yY2Uuc3RyZW5ndGggPSBmdW5jdGlvbih4KSB7XG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gc3RyZW5ndGg7XG4gICAgfVxuICAgIHN0cmVuZ3RoID0geDtcbiAgICByZXR1cm4gZm9yY2U7XG4gIH07XG4gIGZvcmNlLmdldExpbmtTdHJlbmd0aCA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZW5hYmxlR3JvdXBpbmcpIHtcbiAgICAgIGlmIChncm91cEJ5KGUuc291cmNlKSA9PT0gZ3JvdXBCeShlLnRhcmdldCkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBsaW5rU3RyZW5ndGhJbnRyYUNsdXN0ZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBsaW5rU3RyZW5ndGhJbnRyYUNsdXN0ZXIoZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGxpbmtTdHJlbmd0aEludHJhQ2x1c3RlcjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHR5cGVvZiBsaW5rU3RyZW5ndGhJbnRlckNsdXN0ZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBsaW5rU3RyZW5ndGhJbnRlckNsdXN0ZXIoZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGxpbmtTdHJlbmd0aEludGVyQ2x1c3RlcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodHlwZW9mIGxpbmtTdHJlbmd0aEludHJhQ2x1c3RlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBsaW5rU3RyZW5ndGhJbnRyYUNsdXN0ZXIoZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbGlua1N0cmVuZ3RoSW50cmFDbHVzdGVyO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgZm9yY2UuaWQgPSBmdW5jdGlvbihfKSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAoaWQgPSBfLCBmb3JjZSkgOiBpZDtcbiAgfTtcbiAgZm9yY2Uuc2l6ZSA9IGZ1bmN0aW9uKF8pIHtcbiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IChzaXplID0gXywgZm9yY2UpIDogc2l6ZTtcbiAgfTtcbiAgZm9yY2UubGlua1N0cmVuZ3RoSW50ZXJDbHVzdGVyID0gZnVuY3Rpb24oXykge1xuICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKGxpbmtTdHJlbmd0aEludGVyQ2x1c3RlciA9IF8sIGZvcmNlKSA6IGxpbmtTdHJlbmd0aEludGVyQ2x1c3RlcjtcbiAgfTtcbiAgZm9yY2UubGlua1N0cmVuZ3RoSW50cmFDbHVzdGVyID0gZnVuY3Rpb24oXykge1xuICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKGxpbmtTdHJlbmd0aEludHJhQ2x1c3RlciA9IF8sIGZvcmNlKSA6IGxpbmtTdHJlbmd0aEludHJhQ2x1c3RlcjtcbiAgfTtcbiAgZm9yY2Uubm9kZXMgPSBmdW5jdGlvbihfKSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAobm9kZXMgPSBfLCBmb3JjZSkgOiBub2RlcztcbiAgfTtcbiAgZm9yY2UubGlua3MgPSBmdW5jdGlvbihfKSB7XG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gbGlua3M7XG4gICAgfVxuICAgIGlmIChfID09PSBudWxsKSB7XG4gICAgICBsaW5rcyA9IFtdO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaW5rcyA9IF87XG4gICAgfVxuICAgIGluaXRpYWxpemUoKTtcbiAgICByZXR1cm4gZm9yY2U7XG4gIH07XG4gIGZvcmNlLnRlbXBsYXRlID0gZnVuY3Rpb24oeCkge1xuICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgIH1cbiAgICB0ZW1wbGF0ZSA9IHg7XG4gICAgaW5pdGlhbGl6ZSgpO1xuICAgIHJldHVybiBmb3JjZTtcbiAgfTtcbiAgZm9yY2UuZm9yY2VOb2RlU2l6ZSA9IGZ1bmN0aW9uKF8pIHtcbiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IChmb3JjZU5vZGVTaXplID0gdHlwZW9mIF8gPT09IFwiZnVuY3Rpb25cIiA/IF8gOiBjb25zdGFudCgrXyksIGluaXRpYWxpemUoKSwgZm9yY2UpIDogZm9yY2VOb2RlU2l6ZTtcbiAgfTtcbiAgZm9yY2Uubm9kZVNpemUgPSBmb3JjZS5mb3JjZU5vZGVTaXplO1xuICBmb3JjZS5mb3JjZUNoYXJnZSA9IGZ1bmN0aW9uKF8pIHtcbiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IChmb3JjZUNoYXJnZSA9IHR5cGVvZiBfID09PSBcImZ1bmN0aW9uXCIgPyBfIDogY29uc3RhbnQoK18pLCBpbml0aWFsaXplKCksIGZvcmNlKSA6IGZvcmNlQ2hhcmdlO1xuICB9O1xuICBmb3JjZS5mb3JjZUxpbmtEaXN0YW5jZSA9IGZ1bmN0aW9uKF8pIHtcbiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IChmb3JjZUxpbmtEaXN0YW5jZSA9IHR5cGVvZiBfID09PSBcImZ1bmN0aW9uXCIgPyBfIDogY29uc3RhbnQoK18pLCBpbml0aWFsaXplKCksIGZvcmNlKSA6IGZvcmNlTGlua0Rpc3RhbmNlO1xuICB9O1xuICBmb3JjZS5mb3JjZUxpbmtTdHJlbmd0aCA9IGZ1bmN0aW9uKF8pIHtcbiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IChmb3JjZUxpbmtTdHJlbmd0aCA9IHR5cGVvZiBfID09PSBcImZ1bmN0aW9uXCIgPyBfIDogY29uc3RhbnQoK18pLCBpbml0aWFsaXplKCksIGZvcmNlKSA6IGZvcmNlTGlua1N0cmVuZ3RoO1xuICB9O1xuICBmb3JjZS5vZmZzZXQgPSBmdW5jdGlvbihfKSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAob2Zmc2V0ID0gdHlwZW9mIF8gPT09IFwiZnVuY3Rpb25cIiA/IF8gOiBjb25zdGFudCgrXyksIGZvcmNlKSA6IG9mZnNldDtcbiAgfTtcbiAgZm9yY2UuZ2V0Rm9jaXMgPSBnZXRGb2Npc0Zyb21UZW1wbGF0ZTtcbiAgZm9yY2Uuc2V0Q2x1c3RlcnMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGNsdXN0ZXJzID0gdmFsdWU7XG4gICAgcmV0dXJuIGZvcmNlO1xuICB9O1xuICByZXR1cm4gZm9yY2U7XG59XG5mdW5jdGlvbiBmb3JjZURpcmVjdGVkKHtcbiAgZ3JhcGgsXG4gIG5vZGVMZXZlbFJhdGlvID0gMixcbiAgbW9kZSA9IG51bGwsXG4gIGRpbWVuc2lvbnMgPSAyLFxuICBub2RlU3RyZW5ndGggPSAtMjUwLFxuICBsaW5rRGlzdGFuY2UgPSA1MCxcbiAgY2x1c3RlclN0cmVuZ3RoID0gMC41LFxuICBsaW5rU3RyZW5ndGhJbnRlckNsdXN0ZXIgPSAwLjAxLFxuICBsaW5rU3RyZW5ndGhJbnRyYUNsdXN0ZXIgPSAwLjUsXG4gIGZvcmNlTGlua0Rpc3RhbmNlID0gMTAwLFxuICBmb3JjZUxpbmtTdHJlbmd0aCA9IDAuMSxcbiAgY2x1c3RlclR5cGUgPSBcImZvcmNlXCIsXG4gIGZvcmNlQ2hhcmdlID0gLTcwMCxcbiAgZ2V0Tm9kZVBvc2l0aW9uLFxuICBkcmFncyxcbiAgY2x1c3RlcnMsXG4gIGNsdXN0ZXJBdHRyaWJ1dGUsXG4gIGZvcmNlTGF5b3V0XG59KSB7XG4gIGNvbnN0IHsgbm9kZXMsIGVkZ2VzIH0gPSBidWlsZE5vZGVFZGdlcyhncmFwaCk7XG4gIGNvbnN0IGlzMmQgPSBkaW1lbnNpb25zID09PSAyO1xuICBjb25zdCBub2RlU3RyZW5ndGhBZGp1c3RtZW50ID0gaXMyZCAmJiBlZGdlcy5sZW5ndGggPiAyNSA/IG5vZGVTdHJlbmd0aCAqIDIgOiBub2RlU3RyZW5ndGg7XG4gIGxldCBmb3JjZVgkMTtcbiAgbGV0IGZvcmNlWSQxO1xuICBpZiAoZm9yY2VMYXlvdXQgPT09IFwiZm9yY2VEaXJlY3RlZDJkXCIpIHtcbiAgICBmb3JjZVgkMSA9IGZvcmNlWCgpO1xuICAgIGZvcmNlWSQxID0gZm9yY2VZKCk7XG4gIH0gZWxzZSB7XG4gICAgZm9yY2VYJDEgPSBmb3JjZVgoNjAwKS5zdHJlbmd0aCgwLjA1KTtcbiAgICBmb3JjZVkkMSA9IGZvcmNlWSg2MDApLnN0cmVuZ3RoKDAuMDUpO1xuICB9XG4gIGNvbnN0IHNpbSA9IGZvcmNlU2ltdWxhdGlvbigpLmZvcmNlKFwiY2VudGVyXCIsIGZvcmNlQ2VudGVyKDAsIDApKS5mb3JjZShcImxpbmtcIiwgZm9yY2VMaW5rKCkpLmZvcmNlKFwiY2hhcmdlXCIsIGZvcmNlTWFueUJvZHkoKS5zdHJlbmd0aChub2RlU3RyZW5ndGhBZGp1c3RtZW50KSkuZm9yY2UoXCJ4XCIsIGZvcmNlWCQxKS5mb3JjZShcInlcIiwgZm9yY2VZJDEpLmZvcmNlKFwielwiLCBmb3JjZVooKSkuZm9yY2UoXG4gICAgXCJjb2xsaWRlXCIsXG4gICAgZm9yY2VDb2xsaWRlKChkKSA9PiBkLnJhZGl1cyArIDEwKVxuICApLmZvcmNlKFxuICAgIFwiZGFnUmFkaWFsXCIsXG4gICAgZm9yY2VSYWRpYWwoe1xuICAgICAgbm9kZXMsXG4gICAgICBlZGdlcyxcbiAgICAgIG1vZGUsXG4gICAgICBub2RlTGV2ZWxSYXRpb1xuICAgIH0pXG4gICkuc3RvcCgpO1xuICBsZXQgZ3JvdXBpbmdGb3JjZTtcbiAgaWYgKGNsdXN0ZXJBdHRyaWJ1dGUpIHtcbiAgICBsZXQgZm9yY2VDaGFyZ2VBZGp1c3RtZW50ID0gZm9yY2VDaGFyZ2U7XG4gICAgaWYgKG5vZGVzID09IG51bGwgPyB2b2lkIDAgOiBub2Rlcy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGFkanVzdG1lbnRGYWN0b3IgPSBNYXRoLmNlaWwobm9kZXMubGVuZ3RoIC8gMjAwKTtcbiAgICAgIGZvcmNlQ2hhcmdlQWRqdXN0bWVudCA9IGZvcmNlQ2hhcmdlICogYWRqdXN0bWVudEZhY3RvcjtcbiAgICB9XG4gICAgZ3JvdXBpbmdGb3JjZSA9IGZvcmNlSW5BQm94KCkuc2V0Q2x1c3RlcnMoY2x1c3RlcnMpLnN0cmVuZ3RoKGNsdXN0ZXJTdHJlbmd0aCkudGVtcGxhdGUoY2x1c3RlclR5cGUpLmdyb3VwQnkoKGQpID0+IGQuZGF0YVtjbHVzdGVyQXR0cmlidXRlXSkubGlua3MoZWRnZXMpLnNpemUoWzEwMCwgMTAwXSkubGlua1N0cmVuZ3RoSW50ZXJDbHVzdGVyKGxpbmtTdHJlbmd0aEludGVyQ2x1c3RlcikubGlua1N0cmVuZ3RoSW50cmFDbHVzdGVyKGxpbmtTdHJlbmd0aEludHJhQ2x1c3RlcikuZm9yY2VMaW5rRGlzdGFuY2UoZm9yY2VMaW5rRGlzdGFuY2UpLmZvcmNlTGlua1N0cmVuZ3RoKGZvcmNlTGlua1N0cmVuZ3RoKS5mb3JjZUNoYXJnZShmb3JjZUNoYXJnZUFkanVzdG1lbnQpLmZvcmNlTm9kZVNpemUoKGQpID0+IGQucmFkaXVzKTtcbiAgfVxuICBsZXQgbGF5b3V0ID0gc2ltLm51bURpbWVuc2lvbnMoZGltZW5zaW9ucykubm9kZXMobm9kZXMpO1xuICBpZiAoZ3JvdXBpbmdGb3JjZSkge1xuICAgIGxheW91dCA9IGxheW91dC5mb3JjZShcImdyb3VwXCIsIGdyb3VwaW5nRm9yY2UpO1xuICB9XG4gIGlmIChsaW5rRGlzdGFuY2UpIHtcbiAgICBsZXQgbGlua0ZvcmNlID0gbGF5b3V0LmZvcmNlKFwibGlua1wiKTtcbiAgICBpZiAobGlua0ZvcmNlKSB7XG4gICAgICBsaW5rRm9yY2UuaWQoKGQpID0+IGQuaWQpLmxpbmtzKGVkZ2VzKS5kaXN0YW5jZShsaW5rRGlzdGFuY2UpO1xuICAgICAgaWYgKGdyb3VwaW5nRm9yY2UpIHtcbiAgICAgICAgbGlua0ZvcmNlID0gbGlua0ZvcmNlLnN0cmVuZ3RoKChncm91cGluZ0ZvcmNlID09IG51bGwgPyB2b2lkIDAgOiBncm91cGluZ0ZvcmNlLmdldExpbmtTdHJlbmd0aCkgPz8gMC4xKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgY29uc3Qgbm9kZU1hcCA9IG5ldyBNYXAobm9kZXMubWFwKChuKSA9PiBbbi5pZCwgbl0pKTtcbiAgcmV0dXJuIHtcbiAgICBzdGVwKCkge1xuICAgICAgd2hpbGUgKHNpbS5hbHBoYSgpID4gMC4wMSkge1xuICAgICAgICBzaW0udGljaygpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBnZXROb2RlUG9zaXRpb24oaWQpIHtcbiAgICAgIHZhciBfYTIsIF9iMjtcbiAgICAgIGlmIChnZXROb2RlUG9zaXRpb24pIHtcbiAgICAgICAgY29uc3QgcG9zID0gZ2V0Tm9kZVBvc2l0aW9uKGlkLCB7IGdyYXBoLCBkcmFncywgbm9kZXMsIGVkZ2VzIH0pO1xuICAgICAgICBpZiAocG9zKSB7XG4gICAgICAgICAgcmV0dXJuIHBvcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKChfYTIgPSBkcmFncyA9PSBudWxsID8gdm9pZCAwIDogZHJhZ3NbaWRdKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLnBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiAoX2IyID0gZHJhZ3MgPT0gbnVsbCA/IHZvaWQgMCA6IGRyYWdzW2lkXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iMi5wb3NpdGlvbjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub2RlTWFwLmdldChpZCk7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gY2lyY3VsYXIyZCh7XG4gIGdyYXBoLFxuICByYWRpdXMsXG4gIGRyYWdzLFxuICBnZXROb2RlUG9zaXRpb25cbn0pIHtcbiAgY29uc3QgbGF5b3V0ID0gY2lyY3VsYXIoZ3JhcGgsIHtcbiAgICBzY2FsZTogcmFkaXVzXG4gIH0pO1xuICBjb25zdCB7IG5vZGVzLCBlZGdlcyB9ID0gYnVpbGROb2RlRWRnZXMoZ3JhcGgpO1xuICByZXR1cm4ge1xuICAgIHN0ZXAoKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGdldE5vZGVQb3NpdGlvbihpZCkge1xuICAgICAgdmFyIF9hMiwgX2IyO1xuICAgICAgaWYgKGdldE5vZGVQb3NpdGlvbikge1xuICAgICAgICBjb25zdCBwb3MgPSBnZXROb2RlUG9zaXRpb24oaWQsIHsgZ3JhcGgsIGRyYWdzLCBub2RlcywgZWRnZXMgfSk7XG4gICAgICAgIGlmIChwb3MpIHtcbiAgICAgICAgICByZXR1cm4gcG9zO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKF9hMiA9IGRyYWdzID09IG51bGwgPyB2b2lkIDAgOiBkcmFnc1tpZF0pID09IG51bGwgPyB2b2lkIDAgOiBfYTIucG9zaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIChfYjIgPSBkcmFncyA9PSBudWxsID8gdm9pZCAwIDogZHJhZ3NbaWRdKSA9PSBudWxsID8gdm9pZCAwIDogX2IyLnBvc2l0aW9uO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGxheW91dCA9PSBudWxsID8gdm9pZCAwIDogbGF5b3V0W2lkXTtcbiAgICB9XG4gIH07XG59XG5jb25zdCBESVJFQ1RJT05fTUFQID0ge1xuICB0ZDoge1xuICAgIHg6IFwieFwiLFxuICAgIHk6IFwieVwiLFxuICAgIGZhY3RvcjogLTFcbiAgfSxcbiAgbHI6IHtcbiAgICB4OiBcInlcIixcbiAgICB5OiBcInhcIixcbiAgICBmYWN0b3I6IDFcbiAgfVxufTtcbmZ1bmN0aW9uIGhpZXJhcmNoaWNhbCh7XG4gIGdyYXBoLFxuICBkcmFncyxcbiAgbW9kZSA9IFwidGRcIixcbiAgbm9kZVNlcGFyYXRpb24gPSAxLFxuICBub2RlU2l6ZSA9IFs1MCwgNTBdLFxuICBnZXROb2RlUG9zaXRpb25cbn0pIHtcbiAgY29uc3QgeyBub2RlcywgZWRnZXMgfSA9IGJ1aWxkTm9kZUVkZ2VzKGdyYXBoKTtcbiAgY29uc3QgeyBkZXB0aHMgfSA9IGdldE5vZGVEZXB0aChub2RlcywgZWRnZXMpO1xuICBjb25zdCByb290Tm9kZXMgPSBPYmplY3Qua2V5cyhkZXB0aHMpLm1hcCgoZCkgPT4gZGVwdGhzW2RdKTtcbiAgY29uc3Qgcm9vdCA9IHN0cmF0aWZ5KCkuaWQoKGQpID0+IGQuZGF0YS5pZCkucGFyZW50SWQoKGQpID0+IHtcbiAgICB2YXIgX2EyLCBfYjIsIF9jO1xuICAgIHJldHVybiAoX2MgPSAoX2IyID0gKF9hMiA9IGQuaW5zKSA9PSBudWxsID8gdm9pZCAwIDogX2EyWzBdKSA9PSBudWxsID8gdm9pZCAwIDogX2IyLmRhdGEpID09IG51bGwgPyB2b2lkIDAgOiBfYy5pZDtcbiAgfSkocm9vdE5vZGVzKTtcbiAgY29uc3QgdHJlZVJvb3QgPSB0cmVlKCkuc2VwYXJhdGlvbigoKSA9PiBub2RlU2VwYXJhdGlvbikubm9kZVNpemUobm9kZVNpemUpKGhpZXJhcmNoeShyb290KSk7XG4gIGNvbnN0IHRyZWVOb2RlcyA9IHRyZWVSb290LmRlc2NlbmRhbnRzKCk7XG4gIGNvbnN0IHBhdGggPSBESVJFQ1RJT05fTUFQW21vZGVdO1xuICBjb25zdCBtYXBwZWROb2RlcyA9IG5ldyBNYXAoXG4gICAgbm9kZXMubWFwKChuKSA9PiB7XG4gICAgICBjb25zdCB7IHgsIHkgfSA9IHRyZWVOb2Rlcy5maW5kKCh0KSA9PiB0LmRhdGEuaWQgPT09IG4uaWQpO1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgbi5pZCxcbiAgICAgICAge1xuICAgICAgICAgIC4uLm4sXG4gICAgICAgICAgW3BhdGgueF06IHggKiBwYXRoLmZhY3RvcixcbiAgICAgICAgICBbcGF0aC55XTogeSAqIHBhdGguZmFjdG9yLFxuICAgICAgICAgIHo6IDBcbiAgICAgICAgfVxuICAgICAgXTtcbiAgICB9KVxuICApO1xuICByZXR1cm4ge1xuICAgIHN0ZXAoKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGdldE5vZGVQb3NpdGlvbihpZCkge1xuICAgICAgdmFyIF9hMiwgX2IyO1xuICAgICAgaWYgKGdldE5vZGVQb3NpdGlvbikge1xuICAgICAgICBjb25zdCBwb3MgPSBnZXROb2RlUG9zaXRpb24oaWQsIHsgZ3JhcGgsIGRyYWdzLCBub2RlcywgZWRnZXMgfSk7XG4gICAgICAgIGlmIChwb3MpIHtcbiAgICAgICAgICByZXR1cm4gcG9zO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKF9hMiA9IGRyYWdzID09IG51bGwgPyB2b2lkIDAgOiBkcmFnc1tpZF0pID09IG51bGwgPyB2b2lkIDAgOiBfYTIucG9zaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIChfYjIgPSBkcmFncyA9PSBudWxsID8gdm9pZCAwIDogZHJhZ3NbaWRdKSA9PSBudWxsID8gdm9pZCAwIDogX2IyLnBvc2l0aW9uO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hcHBlZE5vZGVzLmdldChpZCk7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gbm9vdmVybGFwKHtcbiAgZ3JhcGgsXG4gIG1hcmdpbixcbiAgZHJhZ3MsXG4gIGdldE5vZGVQb3NpdGlvbixcbiAgcmF0aW8sXG4gIGdyaWRTaXplLFxuICBtYXhJdGVyYXRpb25zXG59KSB7XG4gIGNvbnN0IHsgbm9kZXMsIGVkZ2VzIH0gPSBidWlsZE5vZGVFZGdlcyhncmFwaCk7XG4gIGNvbnN0IGxheW91dCA9IG5vdmVybGFwTGF5b3V0KGdyYXBoLCB7XG4gICAgbWF4SXRlcmF0aW9ucyxcbiAgICBpbnB1dFJlZHVjZXI6IChfa2V5LCBhdHRyKSA9PiAoe1xuICAgICAgLi4uYXR0cixcbiAgICAgIC8vIEhhdmUgdG8gc3BlY2lmeSBkZWZhdWx0cyBmb3IgdGhlIGVuZ2luZVxuICAgICAgeDogYXR0ci54IHx8IDAsXG4gICAgICB5OiBhdHRyLnkgfHwgMFxuICAgIH0pLFxuICAgIHNldHRpbmdzOiB7XG4gICAgICByYXRpbyxcbiAgICAgIG1hcmdpbixcbiAgICAgIGdyaWRTaXplXG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBzdGVwKCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBnZXROb2RlUG9zaXRpb24oaWQpIHtcbiAgICAgIHZhciBfYTIsIF9iMjtcbiAgICAgIGlmIChnZXROb2RlUG9zaXRpb24pIHtcbiAgICAgICAgY29uc3QgcG9zID0gZ2V0Tm9kZVBvc2l0aW9uKGlkLCB7IGdyYXBoLCBkcmFncywgbm9kZXMsIGVkZ2VzIH0pO1xuICAgICAgICBpZiAocG9zKSB7XG4gICAgICAgICAgcmV0dXJuIHBvcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKChfYTIgPSBkcmFncyA9PSBudWxsID8gdm9pZCAwIDogZHJhZ3NbaWRdKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLnBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiAoX2IyID0gZHJhZ3MgPT0gbnVsbCA/IHZvaWQgMCA6IGRyYWdzW2lkXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iMi5wb3NpdGlvbjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsYXlvdXQgPT0gbnVsbCA/IHZvaWQgMCA6IGxheW91dFtpZF07XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gZm9yY2VBdGxhczIoe1xuICBncmFwaCxcbiAgZHJhZ3MsXG4gIGl0ZXJhdGlvbnMsXG4gIC4uLnJlc3Rcbn0pIHtcbiAgcmFuZG9tLmFzc2lnbihncmFwaCk7XG4gIGNvbnN0IGxheW91dCA9IGZvcmNlQXRsYXMyTGF5b3V0KGdyYXBoLCB7XG4gICAgaXRlcmF0aW9ucyxcbiAgICBzZXR0aW5nczogcmVzdFxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBzdGVwKCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBnZXROb2RlUG9zaXRpb24oaWQpIHtcbiAgICAgIHZhciBfYTI7XG4gICAgICByZXR1cm4gKChfYTIgPSBkcmFncyA9PSBudWxsID8gdm9pZCAwIDogZHJhZ3NbaWRdKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLnBvc2l0aW9uKSB8fCAobGF5b3V0ID09IG51bGwgPyB2b2lkIDAgOiBsYXlvdXRbaWRdKTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBjdXN0b20oeyBncmFwaCwgZHJhZ3MsIGdldE5vZGVQb3NpdGlvbiB9KSB7XG4gIGNvbnN0IHsgbm9kZXMsIGVkZ2VzIH0gPSBidWlsZE5vZGVFZGdlcyhncmFwaCk7XG4gIHJldHVybiB7XG4gICAgc3RlcCgpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgZ2V0Tm9kZVBvc2l0aW9uKGlkKSB7XG4gICAgICByZXR1cm4gZ2V0Tm9kZVBvc2l0aW9uKGlkLCB7IGdyYXBoLCBkcmFncywgbm9kZXMsIGVkZ2VzIH0pO1xuICAgIH1cbiAgfTtcbn1cbmNvbnN0IEZPUkNFX0xBWU9VVFMgPSBbXG4gIFwiZm9yY2VEaXJlY3RlZDJkXCIsXG4gIFwidHJlZVRkMmRcIixcbiAgXCJ0cmVlTHIyZFwiLFxuICBcInJhZGlhbE91dDJkXCIsXG4gIFwidHJlZVRkM2RcIixcbiAgXCJ0cmVlTHIzZFwiLFxuICBcInJhZGlhbE91dDNkXCIsXG4gIFwiZm9yY2VEaXJlY3RlZDNkXCJcbl07XG5mdW5jdGlvbiBsYXlvdXRQcm92aWRlcih7XG4gIHR5cGUsXG4gIC4uLnJlc3Rcbn0pIHtcbiAgaWYgKEZPUkNFX0xBWU9VVFMuaW5jbHVkZXModHlwZSkpIHtcbiAgICBjb25zdCB7IG5vZGVTdHJlbmd0aCwgbGlua0Rpc3RhbmNlLCBub2RlTGV2ZWxSYXRpbyB9ID0gcmVzdDtcbiAgICBpZiAodHlwZSA9PT0gXCJmb3JjZURpcmVjdGVkMmRcIikge1xuICAgICAgcmV0dXJuIGZvcmNlRGlyZWN0ZWQoe1xuICAgICAgICAuLi5yZXN0LFxuICAgICAgICBkaW1lbnNpb25zOiAyLFxuICAgICAgICBub2RlTGV2ZWxSYXRpbzogbm9kZUxldmVsUmF0aW8gfHwgMixcbiAgICAgICAgbm9kZVN0cmVuZ3RoOiBub2RlU3RyZW5ndGggfHwgLTI1MCxcbiAgICAgICAgbGlua0Rpc3RhbmNlLFxuICAgICAgICBmb3JjZUxheW91dDogdHlwZVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInRyZWVUZDJkXCIpIHtcbiAgICAgIHJldHVybiBmb3JjZURpcmVjdGVkKHtcbiAgICAgICAgLi4ucmVzdCxcbiAgICAgICAgbW9kZTogXCJ0ZFwiLFxuICAgICAgICBkaW1lbnNpb25zOiAyLFxuICAgICAgICBub2RlTGV2ZWxSYXRpbzogbm9kZUxldmVsUmF0aW8gfHwgNSxcbiAgICAgICAgbm9kZVN0cmVuZ3RoOiBub2RlU3RyZW5ndGggfHwgLTI1MCxcbiAgICAgICAgbGlua0Rpc3RhbmNlOiBsaW5rRGlzdGFuY2UgfHwgNTAsXG4gICAgICAgIGZvcmNlTGF5b3V0OiB0eXBlXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwidHJlZUxyMmRcIikge1xuICAgICAgcmV0dXJuIGZvcmNlRGlyZWN0ZWQoe1xuICAgICAgICAuLi5yZXN0LFxuICAgICAgICBtb2RlOiBcImxyXCIsXG4gICAgICAgIGRpbWVuc2lvbnM6IDIsXG4gICAgICAgIG5vZGVMZXZlbFJhdGlvOiBub2RlTGV2ZWxSYXRpbyB8fCA1LFxuICAgICAgICBub2RlU3RyZW5ndGg6IG5vZGVTdHJlbmd0aCB8fCAtMjUwLFxuICAgICAgICBsaW5rRGlzdGFuY2U6IGxpbmtEaXN0YW5jZSB8fCA1MCxcbiAgICAgICAgZm9yY2VMYXlvdXQ6IHR5cGVcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJyYWRpYWxPdXQyZFwiKSB7XG4gICAgICByZXR1cm4gZm9yY2VEaXJlY3RlZCh7XG4gICAgICAgIC4uLnJlc3QsXG4gICAgICAgIG1vZGU6IFwicmFkaWFsb3V0XCIsXG4gICAgICAgIGRpbWVuc2lvbnM6IDIsXG4gICAgICAgIG5vZGVMZXZlbFJhdGlvOiBub2RlTGV2ZWxSYXRpbyB8fCA1LFxuICAgICAgICBub2RlU3RyZW5ndGg6IG5vZGVTdHJlbmd0aCB8fCAtNTAwLFxuICAgICAgICBsaW5rRGlzdGFuY2U6IGxpbmtEaXN0YW5jZSB8fCAxMDAsXG4gICAgICAgIGZvcmNlTGF5b3V0OiB0eXBlXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwidHJlZVRkM2RcIikge1xuICAgICAgcmV0dXJuIGZvcmNlRGlyZWN0ZWQoe1xuICAgICAgICAuLi5yZXN0LFxuICAgICAgICBtb2RlOiBcInRkXCIsXG4gICAgICAgIGRpbWVuc2lvbnM6IDMsXG4gICAgICAgIG5vZGVMZXZlbFJhdGlvOiBub2RlTGV2ZWxSYXRpbyB8fCAyLFxuICAgICAgICBub2RlU3RyZW5ndGg6IG5vZGVTdHJlbmd0aCB8fCAtNTAwLFxuICAgICAgICBsaW5rRGlzdGFuY2U6IGxpbmtEaXN0YW5jZSB8fCA1MFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInRyZWVMcjNkXCIpIHtcbiAgICAgIHJldHVybiBmb3JjZURpcmVjdGVkKHtcbiAgICAgICAgLi4ucmVzdCxcbiAgICAgICAgbW9kZTogXCJsclwiLFxuICAgICAgICBkaW1lbnNpb25zOiAzLFxuICAgICAgICBub2RlTGV2ZWxSYXRpbzogbm9kZUxldmVsUmF0aW8gfHwgMixcbiAgICAgICAgbm9kZVN0cmVuZ3RoOiBub2RlU3RyZW5ndGggfHwgLTUwMCxcbiAgICAgICAgbGlua0Rpc3RhbmNlOiBsaW5rRGlzdGFuY2UgfHwgNTAsXG4gICAgICAgIGZvcmNlTGF5b3V0OiB0eXBlXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwicmFkaWFsT3V0M2RcIikge1xuICAgICAgcmV0dXJuIGZvcmNlRGlyZWN0ZWQoe1xuICAgICAgICAuLi5yZXN0LFxuICAgICAgICBtb2RlOiBcInJhZGlhbG91dFwiLFxuICAgICAgICBkaW1lbnNpb25zOiAzLFxuICAgICAgICBub2RlTGV2ZWxSYXRpbzogbm9kZUxldmVsUmF0aW8gfHwgMixcbiAgICAgICAgbm9kZVN0cmVuZ3RoOiBub2RlU3RyZW5ndGggfHwgLTUwMCxcbiAgICAgICAgbGlua0Rpc3RhbmNlOiBsaW5rRGlzdGFuY2UgfHwgMTAwLFxuICAgICAgICBmb3JjZUxheW91dDogdHlwZVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcImZvcmNlRGlyZWN0ZWQzZFwiKSB7XG4gICAgICByZXR1cm4gZm9yY2VEaXJlY3RlZCh7XG4gICAgICAgIC4uLnJlc3QsXG4gICAgICAgIGRpbWVuc2lvbnM6IDMsXG4gICAgICAgIG5vZGVMZXZlbFJhdGlvOiBub2RlTGV2ZWxSYXRpbyB8fCAyLFxuICAgICAgICBub2RlU3RyZW5ndGg6IG5vZGVTdHJlbmd0aCB8fCAtMjUwLFxuICAgICAgICBsaW5rRGlzdGFuY2UsXG4gICAgICAgIGZvcmNlTGF5b3V0OiB0eXBlXG4gICAgICB9KTtcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJjaXJjdWxhcjJkXCIpIHtcbiAgICBjb25zdCB7IHJhZGl1cyB9ID0gcmVzdDtcbiAgICByZXR1cm4gY2lyY3VsYXIyZCh7XG4gICAgICAuLi5yZXN0LFxuICAgICAgcmFkaXVzOiByYWRpdXMgfHwgMzAwXG4gICAgfSk7XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJoaWVyYXJjaGljYWxUZFwiKSB7XG4gICAgcmV0dXJuIGhpZXJhcmNoaWNhbCh7IC4uLnJlc3QsIG1vZGU6IFwidGRcIiB9KTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBcImhpZXJhcmNoaWNhbExyXCIpIHtcbiAgICByZXR1cm4gaGllcmFyY2hpY2FsKHsgLi4ucmVzdCwgbW9kZTogXCJsclwiIH0pO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwibm9vdmVybGFwXCIpIHtcbiAgICBjb25zdCB7IGdyYXBoLCBtYXhJdGVyYXRpb25zLCByYXRpbywgbWFyZ2luLCBncmlkU2l6ZSwgLi4uc2V0dGluZ3MgfSA9IHJlc3Q7XG4gICAgcmV0dXJuIG5vb3ZlcmxhcCh7XG4gICAgICB0eXBlOiBcIm5vb3ZlcmxhcFwiLFxuICAgICAgZ3JhcGgsXG4gICAgICBtYXJnaW46IG1hcmdpbiB8fCAxMCxcbiAgICAgIG1heEl0ZXJhdGlvbnM6IG1heEl0ZXJhdGlvbnMgfHwgNTAsXG4gICAgICByYXRpbzogcmF0aW8gfHwgMTAsXG4gICAgICBncmlkU2l6ZTogZ3JpZFNpemUgfHwgMjAsXG4gICAgICAuLi5zZXR0aW5nc1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiZm9yY2VhdGxhczJcIikge1xuICAgIGNvbnN0IHsgZ3JhcGgsIGl0ZXJhdGlvbnMsIGdyYXZpdHksIHNjYWxpbmdSYXRpbywgLi4uc2V0dGluZ3MgfSA9IHJlc3Q7XG4gICAgcmV0dXJuIGZvcmNlQXRsYXMyKHtcbiAgICAgIHR5cGU6IFwiZm9yY2VhdGxhczJcIixcbiAgICAgIGdyYXBoLFxuICAgICAgLi4uc2V0dGluZ3MsXG4gICAgICBzY2FsaW5nUmF0aW86IHNjYWxpbmdSYXRpbyB8fCAxMDAsXG4gICAgICBncmF2aXR5OiBncmF2aXR5IHx8IDEwLFxuICAgICAgaXRlcmF0aW9uczogaXRlcmF0aW9ucyB8fCA1MFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiY3VzdG9tXCIpIHtcbiAgICByZXR1cm4gY3VzdG9tKHtcbiAgICAgIHR5cGU6IFwiY3VzdG9tXCIsXG4gICAgICAuLi5yZXN0XG4gICAgfSk7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGBMYXlvdXQgJHt0eXBlfSBub3QgZm91bmQuYCk7XG59XG5mdW5jdGlvbiByZWNvbW1lbmRMYXlvdXQobm9kZXMsIGVkZ2VzKSB7XG4gIGNvbnN0IHsgaW52YWxpZCB9ID0gZ2V0Tm9kZURlcHRoKG5vZGVzLCBlZGdlcyk7XG4gIGNvbnN0IG5vZGVDb3VudCA9IG5vZGVzLmxlbmd0aDtcbiAgaWYgKCFpbnZhbGlkKSB7XG4gICAgaWYgKG5vZGVDb3VudCA+IDEwMCkge1xuICAgICAgcmV0dXJuIFwicmFkaWFsT3V0MmRcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFwidHJlZVRkMmRcIjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFwiZm9yY2VEaXJlY3RlZDJkXCI7XG59XG5mdW5jdGlvbiBjYWxjTGFiZWxWaXNpYmlsaXR5KHtcbiAgbm9kZUNvdW50LFxuICBub2RlUG9zaXRpb24sXG4gIGxhYmVsVHlwZSxcbiAgY2FtZXJhXG59KSB7XG4gIHJldHVybiAoc2hhcGUsIHNpemUpID0+IHtcbiAgICB2YXIgX2EyO1xuICAgIGlmIChjYW1lcmEgJiYgbm9kZVBvc2l0aW9uICYmICgoX2EyID0gY2FtZXJhID09IG51bGwgPyB2b2lkIDAgOiBjYW1lcmEucG9zaXRpb24pID09IG51bGwgPyB2b2lkIDAgOiBfYTIueikgLyAoY2FtZXJhID09IG51bGwgPyB2b2lkIDAgOiBjYW1lcmEuem9vbSkgLSAobm9kZVBvc2l0aW9uID09IG51bGwgPyB2b2lkIDAgOiBub2RlUG9zaXRpb24ueikgPiA2ZTMpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGxhYmVsVHlwZSA9PT0gXCJhbGxcIikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIGlmIChsYWJlbFR5cGUgPT09IFwibm9kZXNcIiAmJiBzaGFwZSA9PT0gXCJub2RlXCIpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSBpZiAobGFiZWxUeXBlID09PSBcImVkZ2VzXCIgJiYgc2hhcGUgPT09IFwiZWRnZVwiKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGxhYmVsVHlwZSA9PT0gXCJhdXRvXCIgJiYgc2hhcGUgPT09IFwibm9kZVwiKSB7XG4gICAgICBpZiAoc2l6ZSA+IDcpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2UgaWYgKGNhbWVyYSAmJiBub2RlUG9zaXRpb24gJiYgY2FtZXJhLnBvc2l0aW9uLnogLyBjYW1lcmEuem9vbSAtIG5vZGVQb3NpdGlvbi56IDwgM2UzKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG59XG5mdW5jdGlvbiBnZXRMYWJlbE9mZnNldEJ5VHlwZShvZmZzZXQsIHBvc2l0aW9uKSB7XG4gIHN3aXRjaCAocG9zaXRpb24pIHtcbiAgICBjYXNlIFwiYWJvdmVcIjpcbiAgICAgIHJldHVybiBvZmZzZXQ7XG4gICAgY2FzZSBcImJlbG93XCI6XG4gICAgICByZXR1cm4gLW9mZnNldDtcbiAgICBjYXNlIFwiaW5saW5lXCI6XG4gICAgY2FzZSBcIm5hdHVyYWxcIjpcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIDA7XG4gIH1cbn1cbmZ1bmN0aW9uIHBhZ2VSYW5rU2l6aW5nKHtcbiAgZ3JhcGhcbn0pIHtcbiAgY29uc3QgcmFua3MgPSBwYWdlcmFuayhncmFwaCk7XG4gIHJldHVybiB7XG4gICAgcmFua3MsXG4gICAgZ2V0U2l6ZUZvck5vZGU6IChub2RlSUQpID0+IHJhbmtzW25vZGVJRF0gKiA4MFxuICB9O1xufVxuZnVuY3Rpb24gY2VudHJhbGl0eVNpemluZyh7XG4gIGdyYXBoXG59KSB7XG4gIGNvbnN0IHJhbmtzID0gZGVncmVlQ2VudHJhbGl0eShncmFwaCk7XG4gIHJldHVybiB7XG4gICAgcmFua3MsXG4gICAgZ2V0U2l6ZUZvck5vZGU6IChub2RlSUQpID0+IHJhbmtzW25vZGVJRF0gKiAyMFxuICB9O1xufVxuZnVuY3Rpb24gYXR0cmlidXRlU2l6aW5nKHtcbiAgZ3JhcGgsXG4gIGF0dHJpYnV0ZSxcbiAgZGVmYXVsdFNpemVcbn0pIHtcbiAgY29uc3QgbWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgaWYgKGF0dHJpYnV0ZSkge1xuICAgIGdyYXBoLmZvckVhY2hOb2RlKChpZCwgbm9kZSkgPT4ge1xuICAgICAgdmFyIF9hMjtcbiAgICAgIGNvbnN0IHNpemUgPSAoX2EyID0gbm9kZS5kYXRhKSA9PSBudWxsID8gdm9pZCAwIDogX2EyW2F0dHJpYnV0ZV07XG4gICAgICBpZiAoaXNOYU4oc2l6ZSkpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBBdHRyaWJ1dGUgJHtzaXplfSBpcyBub3QgYSBudW1iZXIgZm9yIG5vZGUgJHtub2RlLmlkfWApO1xuICAgICAgfVxuICAgICAgbWFwLnNldChpZCwgc2l6ZSB8fCAwKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLndhcm4oXCJBdHRyaWJ1dGUgc2l6aW5nIGNvbmZpZ3VyZWQgYnV0IG5vIGF0dHJpYnV0ZSBwcm92aWRlZFwiKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGdldFNpemVGb3JOb2RlOiAobm9kZUlkKSA9PiB7XG4gICAgICBpZiAoIWF0dHJpYnV0ZSB8fCAhbWFwKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0U2l6ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYXAuZ2V0KG5vZGVJZCk7XG4gICAgfVxuICB9O1xufVxuY29uc3QgcHJvdmlkZXJzID0ge1xuICBwYWdlcmFuazogcGFnZVJhbmtTaXppbmcsXG4gIGNlbnRyYWxpdHk6IGNlbnRyYWxpdHlTaXppbmcsXG4gIGF0dHJpYnV0ZTogYXR0cmlidXRlU2l6aW5nLFxuICBub25lOiAoeyBkZWZhdWx0U2l6ZSB9KSA9PiAoe1xuICAgIGdldFNpemVGb3JOb2RlOiAoX2lkKSA9PiBkZWZhdWx0U2l6ZVxuICB9KVxufTtcbmZ1bmN0aW9uIG5vZGVTaXplUHJvdmlkZXIoeyB0eXBlLCAuLi5yZXN0IH0pIHtcbiAgdmFyIF9hMjtcbiAgY29uc3QgcHJvdmlkZXIgPSAoX2EyID0gcHJvdmlkZXJzW3R5cGVdKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmNhbGwocHJvdmlkZXJzLCByZXN0KTtcbiAgaWYgKCFwcm92aWRlciAmJiB0eXBlICE9PSBcImRlZmF1bHRcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBzaXppbmcgc3RyYXRlZ3k6ICR7dHlwZX1gKTtcbiAgfVxuICBjb25zdCB7IGdyYXBoLCBtaW5TaXplLCBtYXhTaXplIH0gPSByZXN0O1xuICBjb25zdCBzaXplcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGxldCBtaW47XG4gIGxldCBtYXg7XG4gIGdyYXBoLmZvckVhY2hOb2RlKChpZCwgbm9kZSkgPT4ge1xuICAgIGxldCBzaXplO1xuICAgIGlmICh0eXBlID09PSBcImRlZmF1bHRcIikge1xuICAgICAgc2l6ZSA9IG5vZGUuc2l6ZSB8fCByZXN0LmRlZmF1bHRTaXplO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaXplID0gcHJvdmlkZXIuZ2V0U2l6ZUZvck5vZGUoaWQpO1xuICAgIH1cbiAgICBpZiAobWluID09PSB2b2lkIDAgfHwgc2l6ZSA8IG1pbikge1xuICAgICAgbWluID0gc2l6ZTtcbiAgICB9XG4gICAgaWYgKG1heCA9PT0gdm9pZCAwIHx8IHNpemUgPiBtYXgpIHtcbiAgICAgIG1heCA9IHNpemU7XG4gICAgfVxuICAgIHNpemVzLnNldChpZCwgc2l6ZSk7XG4gIH0pO1xuICBpZiAodHlwZSAhPT0gXCJub25lXCIpIHtcbiAgICBjb25zdCBzY2FsZSA9IHNjYWxlTGluZWFyKCkuZG9tYWluKFttaW4sIG1heF0pLnJhbmdlUm91bmQoW21pblNpemUsIG1heFNpemVdKTtcbiAgICBmb3IgKGNvbnN0IFtub2RlSWQsIHNpemVdIG9mIHNpemVzKSB7XG4gICAgICBzaXplcy5zZXQobm9kZUlkLCBzY2FsZShzaXplKSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBzaXplcztcbn1cbmZ1bmN0aW9uIGJ1aWxkR3JhcGgoZ3JhcGgsIG5vZGVzLCBlZGdlcykge1xuICBncmFwaC5jbGVhcigpO1xuICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICB0cnkge1xuICAgICAgZ3JhcGguYWRkTm9kZShub2RlLmlkLCBub2RlKTtcbiAgICB9IGNhdGNoICh7IG1lc3NhZ2UgfSkge1xuICAgICAgY29uc29sZS5lcnJvcihgW0dyYXBoXSAke21lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG4gIGZvciAoY29uc3QgZWRnZSBvZiBlZGdlcykge1xuICAgIHRyeSB7XG4gICAgICBncmFwaC5hZGRFZGdlKGVkZ2Uuc291cmNlLCBlZGdlLnRhcmdldCwgZWRnZSk7XG4gICAgfSBjYXRjaCAoeyBtZXNzYWdlIH0pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtHcmFwaF0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZ3JhcGg7XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm1HcmFwaCh7XG4gIGdyYXBoLFxuICBsYXlvdXQsXG4gIHNpemluZ1R5cGUsXG4gIGxhYmVsVHlwZSxcbiAgc2l6aW5nQXR0cmlidXRlLFxuICBkZWZhdWx0Tm9kZVNpemUsXG4gIG1pbk5vZGVTaXplLFxuICBtYXhOb2RlU2l6ZSxcbiAgY2x1c3RlckF0dHJpYnV0ZVxufSkge1xuICBjb25zdCBub2RlcyA9IFtdO1xuICBjb25zdCBlZGdlcyA9IFtdO1xuICBjb25zdCBtYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICBjb25zdCBzaXplcyA9IG5vZGVTaXplUHJvdmlkZXIoe1xuICAgIGdyYXBoLFxuICAgIHR5cGU6IHNpemluZ1R5cGUsXG4gICAgYXR0cmlidXRlOiBzaXppbmdBdHRyaWJ1dGUsXG4gICAgbWluU2l6ZTogbWluTm9kZVNpemUsXG4gICAgbWF4U2l6ZTogbWF4Tm9kZVNpemUsXG4gICAgZGVmYXVsdFNpemU6IGRlZmF1bHROb2RlU2l6ZVxuICB9KTtcbiAgY29uc3Qgbm9kZUNvdW50ID0gZ3JhcGgubm9kZXMoKS5sZW5ndGg7XG4gIGNvbnN0IGNoZWNrVmlzaWJpbGl0eSA9IGNhbGNMYWJlbFZpc2liaWxpdHkoeyBub2RlQ291bnQsIGxhYmVsVHlwZSB9KTtcbiAgZ3JhcGguZm9yRWFjaE5vZGUoKGlkLCBub2RlKSA9PiB7XG4gICAgY29uc3QgcG9zaXRpb24gPSBsYXlvdXQuZ2V0Tm9kZVBvc2l0aW9uKGlkKTtcbiAgICBjb25zdCB7IGRhdGEsIGZpbGwsIGljb24sIGxhYmVsLCBzaXplLCAuLi5yZXN0IH0gPSBub2RlO1xuICAgIGNvbnN0IG5vZGVTaXplID0gc2l6ZXMuZ2V0KG5vZGUuaWQpO1xuICAgIGNvbnN0IGxhYmVsVmlzaWJsZSA9IGNoZWNrVmlzaWJpbGl0eShcIm5vZGVcIiwgbm9kZVNpemUpO1xuICAgIGNvbnN0IG5vZGVMaW5rcyA9IGdyYXBoLmluYm91bmROZWlnaGJvcnMobm9kZS5pZCkgfHwgW107XG4gICAgY29uc3QgcGFyZW50cyA9IG5vZGVMaW5rcy5tYXAoKG4yKSA9PiBncmFwaC5nZXROb2RlQXR0cmlidXRlcyhuMikpO1xuICAgIGNvbnN0IG4gPSB7XG4gICAgICAuLi5ub2RlLFxuICAgICAgc2l6ZTogbm9kZVNpemUsXG4gICAgICBsYWJlbFZpc2libGUsXG4gICAgICBsYWJlbCxcbiAgICAgIGljb24sXG4gICAgICBmaWxsLFxuICAgICAgY2x1c3RlcjogY2x1c3RlckF0dHJpYnV0ZSA/IGRhdGFbY2x1c3RlckF0dHJpYnV0ZV0gOiB2b2lkIDAsXG4gICAgICBwYXJlbnRzLFxuICAgICAgZGF0YToge1xuICAgICAgICAuLi5yZXN0LFxuICAgICAgICAuLi5kYXRhID8/IHt9XG4gICAgICB9LFxuICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgLi4ucG9zaXRpb24sXG4gICAgICAgIHg6IHBvc2l0aW9uLnggfHwgMCxcbiAgICAgICAgeTogcG9zaXRpb24ueSB8fCAwLFxuICAgICAgICB6OiBwb3NpdGlvbi56IHx8IDFcbiAgICAgIH1cbiAgICB9O1xuICAgIG1hcC5zZXQobm9kZS5pZCwgbik7XG4gICAgbm9kZXMucHVzaChuKTtcbiAgfSk7XG4gIGdyYXBoLmZvckVhY2hFZGdlKChfaWQsIGxpbmspID0+IHtcbiAgICBjb25zdCBmcm9tID0gbWFwLmdldChsaW5rLnNvdXJjZSk7XG4gICAgY29uc3QgdG8gPSBtYXAuZ2V0KGxpbmsudGFyZ2V0KTtcbiAgICBpZiAoZnJvbSAmJiB0bykge1xuICAgICAgY29uc3QgeyBkYXRhLCBpZCwgbGFiZWwsIHNpemUsIC4uLnJlc3QgfSA9IGxpbms7XG4gICAgICBjb25zdCBsYWJlbFZpc2libGUgPSBjaGVja1Zpc2liaWxpdHkoXCJlZGdlXCIsIHNpemUpO1xuICAgICAgZWRnZXMucHVzaCh7XG4gICAgICAgIC4uLmxpbmssXG4gICAgICAgIGlkLFxuICAgICAgICBsYWJlbCxcbiAgICAgICAgbGFiZWxWaXNpYmxlLFxuICAgICAgICBzaXplLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgLi4ucmVzdCxcbiAgICAgICAgICBpZCxcbiAgICAgICAgICAuLi5kYXRhIHx8IHt9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiB7XG4gICAgbm9kZXMsXG4gICAgZWRnZXNcbiAgfTtcbn1cbmNvbnN0IGFuaW1hdGlvbkNvbmZpZyA9IHtcbiAgbWFzczogMTAsXG4gIHRlbnNpb246IDFlMyxcbiAgZnJpY3Rpb246IDMwMCxcbiAgLy8gRGVjcmVhc2luZyBwcmVjaXNpb24gdG8gaW1wcm92ZSBwZXJmb3JtYW5jZSBmcm9tIDAuMDAwMDFcbiAgcHJlY2lzaW9uOiAwLjFcbn07XG5mdW5jdGlvbiBnZXRBcnJvd1ZlY3RvcnMocGxhY2VtZW50LCBjdXJ2ZSwgYXJyb3dMZW5ndGgpIHtcbiAgY29uc3QgY3VydmVMZW5ndGggPSBjdXJ2ZS5nZXRMZW5ndGgoKTtcbiAgY29uc3QgYWJzU2l6ZSA9IHBsYWNlbWVudCA9PT0gXCJlbmRcIiA/IGN1cnZlTGVuZ3RoIDogY3VydmVMZW5ndGggLyAyO1xuICBjb25zdCBvZmZzZXQgPSBwbGFjZW1lbnQgPT09IFwiZW5kXCIgPyBhcnJvd0xlbmd0aCAvIDIgOiAwO1xuICBjb25zdCB1ID0gKGFic1NpemUgLSBvZmZzZXQpIC8gY3VydmVMZW5ndGg7XG4gIGNvbnN0IHBvc2l0aW9uID0gY3VydmUuZ2V0UG9pbnRBdCh1KTtcbiAgY29uc3Qgcm90YXRpb24gPSBjdXJ2ZS5nZXRUYW5nZW50QXQodSk7XG4gIHJldHVybiBbcG9zaXRpb24sIHJvdGF0aW9uXTtcbn1cbmZ1bmN0aW9uIGdldEFycm93U2l6ZShzaXplKSB7XG4gIHJldHVybiBbc2l6ZSArIDYsIDIgKyBzaXplIC8gMS41XTtcbn1cbmNvbnN0IE1VTFRJX0VER0VfT0ZGU0VUX0ZBQ1RPUiA9IDAuNztcbmZ1bmN0aW9uIGdldE1pZFBvaW50KGZyb20sIHRvLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IGZyb21WZWN0b3IgPSBuZXcgVmVjdG9yMyhmcm9tLngsIGZyb20ueSB8fCAwLCBmcm9tLnogfHwgMCk7XG4gIGNvbnN0IHRvVmVjdG9yID0gbmV3IFZlY3RvcjModG8ueCwgdG8ueSB8fCAwLCB0by56IHx8IDApO1xuICBjb25zdCBtaWRWZWN0b3IgPSBuZXcgVmVjdG9yMygpLmFkZFZlY3RvcnMoZnJvbVZlY3RvciwgdG9WZWN0b3IpLmRpdmlkZVNjYWxhcigyKTtcbiAgcmV0dXJuIG1pZFZlY3Rvci5zZXRMZW5ndGgobWlkVmVjdG9yLmxlbmd0aCgpICsgb2Zmc2V0KTtcbn1cbmZ1bmN0aW9uIGdldEN1cnZlUG9pbnRzKGZyb20sIHRvLCBvZmZzZXQgPSAtMSkge1xuICBjb25zdCBmcm9tVmVjdG9yID0gZnJvbS5jbG9uZSgpO1xuICBjb25zdCB0b1ZlY3RvciA9IHRvLmNsb25lKCk7XG4gIGNvbnN0IHYgPSBuZXcgVmVjdG9yMygpLnN1YlZlY3RvcnModG9WZWN0b3IsIGZyb21WZWN0b3IpO1xuICBjb25zdCB2bGVuID0gdi5sZW5ndGgoKTtcbiAgY29uc3Qgdm4gPSB2LmNsb25lKCkubm9ybWFsaXplKCk7XG4gIGNvbnN0IHZ2ID0gbmV3IFZlY3RvcjMoKS5zdWJWZWN0b3JzKHRvVmVjdG9yLCBmcm9tVmVjdG9yKS5kaXZpZGVTY2FsYXIoMik7XG4gIGNvbnN0IGsgPSBNYXRoLmFicyh2bi54KSAlIDE7XG4gIGNvbnN0IGIgPSBuZXcgVmVjdG9yMygtdm4ueSwgdm4ueCAtIGsgKiB2bi56LCBrICogdm4ueSkubm9ybWFsaXplKCk7XG4gIGNvbnN0IHZtID0gbmV3IFZlY3RvcjMoKS5hZGQoZnJvbVZlY3RvcikuYWRkKHZ2KS5hZGQoYi5tdWx0aXBseVNjYWxhcih2bGVuIC8gNCkubXVsdGlwbHlTY2FsYXIob2Zmc2V0KSk7XG4gIHJldHVybiBbZnJvbSwgdm0sIHRvXTtcbn1cbmZ1bmN0aW9uIGdldEN1cnZlKGZyb20sIGZyb21PZmZzZXQsIHRvLCB0b09mZnNldCwgY3VydmVkLCBjdXJ2ZU9mZnNldCkge1xuICBjb25zdCBvZmZzZXRGcm9tID0gZ2V0UG9pbnRCZXR3ZWVuKGZyb20sIHRvLCBmcm9tT2Zmc2V0KTtcbiAgY29uc3Qgb2Zmc2V0VG8gPSBnZXRQb2ludEJldHdlZW4odG8sIGZyb20sIHRvT2Zmc2V0KTtcbiAgcmV0dXJuIGN1cnZlZCA/IG5ldyBRdWFkcmF0aWNCZXppZXJDdXJ2ZTMoXG4gICAgLi4uZ2V0Q3VydmVQb2ludHMob2Zmc2V0RnJvbSwgb2Zmc2V0VG8sIGN1cnZlT2Zmc2V0KVxuICApIDogbmV3IExpbmVDdXJ2ZTMob2Zmc2V0RnJvbSwgb2Zmc2V0VG8pO1xufVxuZnVuY3Rpb24gZ2V0VmVjdG9yKG5vZGUpIHtcbiAgcmV0dXJuIG5ldyBWZWN0b3IzKG5vZGUucG9zaXRpb24ueCwgbm9kZS5wb3NpdGlvbi55LCBub2RlLnBvc2l0aW9uLnogfHwgMCk7XG59XG5mdW5jdGlvbiBnZXRQb2ludEJldHdlZW4oZnJvbSwgdG8sIG9mZnNldCkge1xuICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7XG4gIHJldHVybiBmcm9tLmNsb25lKCkuYWRkKFxuICAgIHRvLmNsb25lKCkuc3ViKGZyb20pLm11bHRpcGx5U2NhbGFyKG9mZnNldCAvIGRpc3RhbmNlKVxuICApO1xufVxuZnVuY3Rpb24gdXBkYXRlTm9kZVBvc2l0aW9uKG5vZGUsIG9mZnNldCkge1xuICByZXR1cm4ge1xuICAgIC4uLm5vZGUsXG4gICAgcG9zaXRpb246IHtcbiAgICAgIC4uLm5vZGUucG9zaXRpb24sXG4gICAgICB4OiBub2RlLnBvc2l0aW9uLnggKyBvZmZzZXQueCxcbiAgICAgIHk6IG5vZGUucG9zaXRpb24ueSArIG9mZnNldC55LFxuICAgICAgejogbm9kZS5wb3NpdGlvbi56ICsgb2Zmc2V0LnpcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBjYWxjdWxhdGVFZGdlQ3VydmVPZmZzZXQoeyBlZGdlLCBlZGdlcywgY3VydmVkIH0pIHtcbiAgbGV0IHVwZGF0ZWRDdXJ2ZWQgPSBjdXJ2ZWQ7XG4gIGxldCBjdXJ2ZU9mZnNldDtcbiAgY29uc3QgcGFyYWxsZWxFZGdlcyA9IGVkZ2VzLmZpbHRlcigoZSkgPT4gZS50YXJnZXQgPT09IGVkZ2UudGFyZ2V0ICYmIGUuc291cmNlID09PSBlZGdlLnNvdXJjZSkubWFwKChlKSA9PiBlLmlkKTtcbiAgaWYgKHBhcmFsbGVsRWRnZXMubGVuZ3RoID4gMSkge1xuICAgIHVwZGF0ZWRDdXJ2ZWQgPSB0cnVlO1xuICAgIGNvbnN0IGVkZ2VJbmRleCA9IHBhcmFsbGVsRWRnZXMuaW5kZXhPZihlZGdlLmlkKTtcbiAgICBpZiAocGFyYWxsZWxFZGdlcy5sZW5ndGggPT09IDIpIHtcbiAgICAgIGN1cnZlT2Zmc2V0ID0gZWRnZUluZGV4ID09PSAwID8gTVVMVElfRURHRV9PRkZTRVRfRkFDVE9SIDogLU1VTFRJX0VER0VfT0ZGU0VUX0ZBQ1RPUjtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VydmVPZmZzZXQgPSAoZWRnZUluZGV4IC0gTWF0aC5mbG9vcihwYXJhbGxlbEVkZ2VzLmxlbmd0aCAvIDIpKSAqIE1VTFRJX0VER0VfT0ZGU0VUX0ZBQ1RPUjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgY3VydmVkOiB1cGRhdGVkQ3VydmVkLCBjdXJ2ZU9mZnNldCB9O1xufVxuZnVuY3Rpb24gZ2V0TGF5b3V0Q2VudGVyKG5vZGVzKSB7XG4gIGxldCBtaW5YID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO1xuICBsZXQgbWF4WCA9IE51bWJlci5ORUdBVElWRV9JTkZJTklUWTtcbiAgbGV0IG1pblkgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7XG4gIGxldCBtYXhZID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO1xuICBsZXQgbWluWiA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcbiAgbGV0IG1heFogPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7XG4gIGZvciAobGV0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICBtaW5YID0gTWF0aC5taW4obWluWCwgbm9kZS5wb3NpdGlvbi54KTtcbiAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgbm9kZS5wb3NpdGlvbi54KTtcbiAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgbm9kZS5wb3NpdGlvbi55KTtcbiAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgbm9kZS5wb3NpdGlvbi55KTtcbiAgICBtaW5aID0gTWF0aC5taW4obWluWiwgbm9kZS5wb3NpdGlvbi56KTtcbiAgICBtYXhaID0gTWF0aC5tYXgobWF4Wiwgbm9kZS5wb3NpdGlvbi56KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGhlaWdodDogbWF4WSAtIG1pblksXG4gICAgd2lkdGg6IG1heFggLSBtaW5YLFxuICAgIG1pblgsXG4gICAgbWF4WCxcbiAgICBtaW5ZLFxuICAgIG1heFksXG4gICAgbWluWixcbiAgICBtYXhaLFxuICAgIHg6IChtYXhYICsgbWluWCkgLyAyLFxuICAgIHk6IChtYXhZICsgbWluWSkgLyAyLFxuICAgIHo6IChtYXhaICsgbWluWikgLyAyXG4gIH07XG59XG5mdW5jdGlvbiBidWlsZENsdXN0ZXJHcm91cHMobm9kZXMsIGNsdXN0ZXJBdHRyaWJ1dGUpIHtcbiAgaWYgKCFjbHVzdGVyQXR0cmlidXRlKSB7XG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIH1cbiAgcmV0dXJuIG5vZGVzLnJlZHVjZSgoZW50cnlNYXAsIGUpID0+IHtcbiAgICBjb25zdCB2YWwgPSBlLmRhdGFbY2x1c3RlckF0dHJpYnV0ZV07XG4gICAgaWYgKHZhbCkge1xuICAgICAgZW50cnlNYXAuc2V0KHZhbCwgWy4uLmVudHJ5TWFwLmdldCh2YWwpIHx8IFtdLCBlXSk7XG4gICAgfVxuICAgIHJldHVybiBlbnRyeU1hcDtcbiAgfSwgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSk7XG59XG5mdW5jdGlvbiBjYWxjdWxhdGVDbHVzdGVycyh7XG4gIG5vZGVzLFxuICBjbHVzdGVyQXR0cmlidXRlXG59KSB7XG4gIGNvbnN0IHJlc3VsdCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGlmIChjbHVzdGVyQXR0cmlidXRlKSB7XG4gICAgY29uc3QgZ3JvdXBzID0gYnVpbGRDbHVzdGVyR3JvdXBzKG5vZGVzLCBjbHVzdGVyQXR0cmlidXRlKTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIG5vZGVzMl0gb2YgZ3JvdXBzKSB7XG4gICAgICBjb25zdCBwb3NpdGlvbiA9IGdldExheW91dENlbnRlcihub2RlczIpO1xuICAgICAgcmVzdWx0LnNldChrZXksIHtcbiAgICAgICAgbGFiZWw6IGtleSxcbiAgICAgICAgbm9kZXM6IG5vZGVzMixcbiAgICAgICAgcG9zaXRpb25cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuY29uc3QgdXNlSG92ZXJJbnRlbnQgPSAoe1xuICBzZW5zaXRpdml0eSA9IDcsXG4gIGludGVydmFsID0gNTAsXG4gIHRpbWVvdXQgPSAwLFxuICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICBvblBvaW50ZXJPdmVyLFxuICBvblBvaW50ZXJPdXRcbn0pID0+IHtcbiAgY29uc3QgbW91c2VPdmVyID0gdXNlUmVmKGZhbHNlKTtcbiAgY29uc3QgdGltZXIgPSB1c2VSZWYobnVsbCk7XG4gIGNvbnN0IHN0YXRlID0gdXNlUmVmKDApO1xuICBjb25zdCBjb29yZHMgPSB1c2VSZWYoe1xuICAgIHg6IG51bGwsXG4gICAgeTogbnVsbCxcbiAgICBweDogbnVsbCxcbiAgICBweTogbnVsbFxuICB9KTtcbiAgY29uc3Qgb25Nb3VzZU1vdmUgPSB1c2VDYWxsYmFjaygoZXZlbnQpID0+IHtcbiAgICBjb29yZHMuY3VycmVudC54ID0gZXZlbnQuY2xpZW50WDtcbiAgICBjb29yZHMuY3VycmVudC55ID0gZXZlbnQuY2xpZW50WTtcbiAgfSwgW10pO1xuICBjb25zdCBjb21wYXJlUG9zaXRpb24gPSB1c2VDYWxsYmFjayhcbiAgICAoZXZlbnQpID0+IHtcbiAgICAgIHRpbWVyLmN1cnJlbnQgPSBjbGVhclRpbWVvdXQodGltZXIuY3VycmVudCk7XG4gICAgICBjb25zdCB7IHB4LCB4LCBweSwgeSB9ID0gY29vcmRzLmN1cnJlbnQ7XG4gICAgICBpZiAoTWF0aC5hYnMocHggLSB4KSArIE1hdGguYWJzKHB5IC0geSkgPCBzZW5zaXRpdml0eSkge1xuICAgICAgICBzdGF0ZS5jdXJyZW50ID0gMTtcbiAgICAgICAgb25Qb2ludGVyT3ZlcihldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb29yZHMuY3VycmVudC5weCA9IHg7XG4gICAgICAgIGNvb3Jkcy5jdXJyZW50LnB5ID0geTtcbiAgICAgICAgdGltZXIuY3VycmVudCA9IHNldFRpbWVvdXQoKCkgPT4gY29tcGFyZVBvc2l0aW9uKGV2ZW50KSwgaW50ZXJ2YWwpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2ludGVydmFsLCBvblBvaW50ZXJPdmVyLCBzZW5zaXRpdml0eV1cbiAgKTtcbiAgY29uc3QgY2xlYW51cCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjbGVhclRpbWVvdXQodGltZXIuY3VycmVudCk7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgb25Nb3VzZU1vdmUsIGZhbHNlKTtcbiAgICB9XG4gIH0sIFtvbk1vdXNlTW92ZV0pO1xuICBjb25zdCBwb2ludGVyT3ZlciA9IHVzZUNhbGxiYWNrKFxuICAgIChldmVudCkgPT4ge1xuICAgICAgaWYgKCFkaXNhYmxlZDIpIHtcbiAgICAgICAgbW91c2VPdmVyLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgIGlmIChzdGF0ZS5jdXJyZW50ICE9PSAxKSB7XG4gICAgICAgICAgY29vcmRzLmN1cnJlbnQucHggPSBldmVudC5wb2ludGVyLng7XG4gICAgICAgICAgY29vcmRzLmN1cnJlbnQucHkgPSBldmVudC5wb2ludGVyLnk7XG4gICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgb25Nb3VzZU1vdmUsIGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGltZXIuY3VycmVudCA9IHNldFRpbWVvdXQoKCkgPT4gY29tcGFyZVBvc2l0aW9uKGV2ZW50KSwgdGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIFtjbGVhbnVwLCBjb21wYXJlUG9zaXRpb24sIGRpc2FibGVkMiwgb25Nb3VzZU1vdmUsIHRpbWVvdXRdXG4gICk7XG4gIGNvbnN0IGRlbGF5ID0gdXNlQ2FsbGJhY2soXG4gICAgKGV2ZW50KSA9PiB7XG4gICAgICB0aW1lci5jdXJyZW50ID0gY2xlYXJUaW1lb3V0KHRpbWVyLmN1cnJlbnQpO1xuICAgICAgc3RhdGUuY3VycmVudCA9IDA7XG4gICAgICBvblBvaW50ZXJPdXQoZXZlbnQpO1xuICAgIH0sXG4gICAgW29uUG9pbnRlck91dF1cbiAgKTtcbiAgY29uc3QgcG9pbnRlck91dCA9IHVzZUNhbGxiYWNrKFxuICAgIChldmVudCkgPT4ge1xuICAgICAgbW91c2VPdmVyLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIGNsZWFudXAoKTtcbiAgICAgIGlmIChzdGF0ZS5jdXJyZW50ID09PSAxKSB7XG4gICAgICAgIHRpbWVyLmN1cnJlbnQgPSBzZXRUaW1lb3V0KCgpID0+IGRlbGF5KGV2ZW50KSwgdGltZW91dCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbY2xlYW51cCwgZGVsYXksIHRpbWVvdXRdXG4gICk7XG4gIHJldHVybiB7XG4gICAgcG9pbnRlck92ZXIsXG4gICAgcG9pbnRlck91dFxuICB9O1xufTtcbmNvbnN0IHVzZURyYWcgPSAoe1xuICBkcmFnZ2FibGUsXG4gIHNldCxcbiAgcG9zaXRpb24sXG4gIGJvdW5kcyxcbiAgb25EcmFnU3RhcnQsXG4gIG9uRHJhZ0VuZFxufSkgPT4ge1xuICBjb25zdCBjYW1lcmEgPSB1c2VUaHJlZSgoc3RhdGUpID0+IHN0YXRlLmNhbWVyYSk7XG4gIGNvbnN0IHJheWNhc3RlciA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUucmF5Y2FzdGVyKTtcbiAgY29uc3Qgc2l6ZSA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuc2l6ZSk7XG4gIGNvbnN0IGdsID0gdXNlVGhyZWUoKHN0YXRlKSA9PiBzdGF0ZS5nbCk7XG4gIGNvbnN0IHsgbW91c2UyRCwgbW91c2UzRCwgb2Zmc2V0LCBub3JtYWwsIHBsYW5lIH0gPSB1c2VNZW1vKFxuICAgICgpID0+ICh7XG4gICAgICAvLyBOb3JtYWxpemVkIDJEIHNjcmVlbiBzcGFjZSBtb3VzZSBjb29yZHNcbiAgICAgIG1vdXNlMkQ6IG5ldyBWZWN0b3IyKCksXG4gICAgICAvLyAzRCB3b3JsZCBzcGFjZSBtb3VzZSBjb29yZHNcbiAgICAgIG1vdXNlM0Q6IG5ldyBWZWN0b3IzKCksXG4gICAgICAvLyBEcmFnIHBvaW50IG9mZnNldCBmcm9tIG9iamVjdCBvcmlnaW5cbiAgICAgIG9mZnNldDogbmV3IFZlY3RvcjMoKSxcbiAgICAgIC8vIE5vcm1hbCBvZiB0aGUgZHJhZyBwbGFuZVxuICAgICAgbm9ybWFsOiBuZXcgVmVjdG9yMygpLFxuICAgICAgLy8gRHJhZyBwbGFuZVxuICAgICAgcGxhbmU6IG5ldyBQbGFuZSgpXG4gICAgfSksXG4gICAgW11cbiAgKTtcbiAgY29uc3QgY2xpZW50UmVjdCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gZ2wuZG9tRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICBbZ2wuZG9tRWxlbWVudF1cbiAgKTtcbiAgcmV0dXJuIHVzZUdlc3R1cmUoXG4gICAge1xuICAgICAgb25EcmFnU3RhcnQ6ICh7IGV2ZW50IH0pID0+IHtcbiAgICAgICAgY29uc3QgeyBldmVudE9iamVjdCwgcG9pbnQgfSA9IGV2ZW50O1xuICAgICAgICBldmVudE9iamVjdC5nZXRXb3JsZFBvc2l0aW9uKG9mZnNldCkuc3ViKHBvaW50KTtcbiAgICAgICAgbW91c2UzRC5jb3B5KHBvaW50KTtcbiAgICAgICAgb25EcmFnU3RhcnQoKTtcbiAgICAgIH0sXG4gICAgICBvbkRyYWc6ICh7IHh5LCBidXR0b25zLCBjYW5jZWwgfSkgPT4ge1xuICAgICAgICBpZiAoYnV0dG9ucyAhPT0gMSkge1xuICAgICAgICAgIGNhbmNlbCgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBueCA9ICh4eVswXSAtICgoY2xpZW50UmVjdCA9PSBudWxsID8gdm9pZCAwIDogY2xpZW50UmVjdC5sZWZ0KSA/PyAwKSkgLyBzaXplLndpZHRoICogMiAtIDE7XG4gICAgICAgIGNvbnN0IG55ID0gLSgoeHlbMV0gLSAoKGNsaWVudFJlY3QgPT0gbnVsbCA/IHZvaWQgMCA6IGNsaWVudFJlY3QudG9wKSA/PyAwKSkgLyBzaXplLmhlaWdodCkgKiAyICsgMTtcbiAgICAgICAgbW91c2UyRC5zZXQobngsIG55KTtcbiAgICAgICAgcmF5Y2FzdGVyLnNldEZyb21DYW1lcmEobW91c2UyRCwgY2FtZXJhKTtcbiAgICAgICAgY2FtZXJhLmdldFdvcmxkRGlyZWN0aW9uKG5vcm1hbCkubmVnYXRlKCk7XG4gICAgICAgIHBsYW5lLnNldEZyb21Ob3JtYWxBbmRDb3BsYW5hclBvaW50KG5vcm1hbCwgbW91c2UzRCk7XG4gICAgICAgIHJheWNhc3Rlci5yYXkuaW50ZXJzZWN0UGxhbmUocGxhbmUsIG1vdXNlM0QpO1xuICAgICAgICBjb25zdCB1cGRhdGVkID0gbmV3IFZlY3RvcjMocG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcG9zaXRpb24ueikuY29weShtb3VzZTNEKS5hZGQob2Zmc2V0KTtcbiAgICAgICAgaWYgKGJvdW5kcykge1xuICAgICAgICAgIGNvbnN0IGNlbnRlciA9IG5ldyBWZWN0b3IzKFxuICAgICAgICAgICAgKGJvdW5kcy5taW5YICsgYm91bmRzLm1heFgpIC8gMixcbiAgICAgICAgICAgIChib3VuZHMubWluWSArIGJvdW5kcy5tYXhZKSAvIDIsXG4gICAgICAgICAgICAoYm91bmRzLm1pblogKyBib3VuZHMubWF4WikgLyAyXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCByYWRpdXMgPSAoYm91bmRzLm1heFggLSBib3VuZHMubWluWCkgLyAyO1xuICAgICAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHVwZGF0ZWQuY2xvbmUoKS5zdWIoY2VudGVyKTtcbiAgICAgICAgICBjb25zdCBkaXN0YW5jZSA9IGRpcmVjdGlvbi5sZW5ndGgoKTtcbiAgICAgICAgICBpZiAoZGlzdGFuY2UgPiByYWRpdXMpIHtcbiAgICAgICAgICAgIGRpcmVjdGlvbi5ub3JtYWxpemUoKS5tdWx0aXBseVNjYWxhcihyYWRpdXMpO1xuICAgICAgICAgICAgdXBkYXRlZC5jb3B5KGNlbnRlcikuYWRkKGRpcmVjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXQodXBkYXRlZCk7XG4gICAgICB9LFxuICAgICAgb25EcmFnRW5kXG4gICAgfSxcbiAgICB7IGRyYWc6IHsgZW5hYmxlZDogZHJhZ2dhYmxlLCB0aHJlc2hvbGQ6IDEwIH0gfVxuICApO1xufTtcbmZ1bmN0aW9uIGZpbmRQYXRoKGdyYXBoLCBzb3VyY2UsIHRhcmdldCkge1xuICByZXR1cm4gYmlkaXJlY3Rpb25hbChncmFwaCwgc291cmNlLCB0YXJnZXQpO1xufVxuY29uc3QgeyBQcm92aWRlciwgdXNlU3RvcmUgfSA9IGNyZWF0ZUNvbnRleHQoKTtcbmNvbnN0IGNyZWF0ZVN0b3JlID0gKHtcbiAgYWN0aXZlcyA9IFtdLFxuICBzZWxlY3Rpb25zID0gW10sXG4gIGNvbGxhcHNlZE5vZGVJZHMgPSBbXSxcbiAgdGhlbWVcbn0pID0+IGNyZWF0ZSgoc2V0KSA9PiAoe1xuICB0aGVtZToge1xuICAgIC4uLnRoZW1lLFxuICAgIGVkZ2U6IHtcbiAgICAgIC4uLnRoZW1lLmVkZ2UsXG4gICAgICBsYWJlbDoge1xuICAgICAgICAuLi50aGVtZS5lZGdlLmxhYmVsLFxuICAgICAgICBmb250U2l6ZTogdGhlbWUuZWRnZS5sYWJlbC5mb250U2l6ZSA/PyA2XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBlZGdlczogW10sXG4gIG5vZGVzOiBbXSxcbiAgY29sbGFwc2VkTm9kZUlkcyxcbiAgY2x1c3RlcnM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCksXG4gIHBhbm5pbmc6IGZhbHNlLFxuICBkcmFnZ2luZ0lkczogW10sXG4gIGFjdGl2ZXMsXG4gIGVkZ2VDb250ZXh0TWVudXM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksXG4gIGVkZ2VNZXNoZXM6IFtdLFxuICBzZWxlY3Rpb25zLFxuICBob3ZlcmVkTm9kZUlkOiBudWxsLFxuICBkcmFnczoge30sXG4gIGdyYXBoOiBuZXcgR3JhcGgoeyBtdWx0aTogdHJ1ZSB9KSxcbiAgc2V0VGhlbWU6ICh0aGVtZTIpID0+IHNldCgoc3RhdGUpID0+ICh7IC4uLnN0YXRlLCB0aGVtZTogdGhlbWUyIH0pKSxcbiAgc2V0Q2x1c3RlcnM6IChjbHVzdGVycykgPT4gc2V0KChzdGF0ZSkgPT4gKHsgLi4uc3RhdGUsIGNsdXN0ZXJzIH0pKSxcbiAgc2V0RWRnZUNvbnRleHRNZW51czogKGVkZ2VDb250ZXh0TWVudXMpID0+IHNldCgoc3RhdGUpID0+ICh7XG4gICAgLi4uc3RhdGUsXG4gICAgZWRnZUNvbnRleHRNZW51c1xuICB9KSksXG4gIHNldEVkZ2VNZXNoZXM6IChlZGdlTWVzaGVzKSA9PiBzZXQoKHN0YXRlKSA9PiAoeyAuLi5zdGF0ZSwgZWRnZU1lc2hlcyB9KSksXG4gIHNldFBhbm5pbmc6IChwYW5uaW5nKSA9PiBzZXQoKHN0YXRlKSA9PiAoeyAuLi5zdGF0ZSwgcGFubmluZyB9KSksXG4gIHNldERyYWdzOiAoZHJhZ3MpID0+IHNldCgoc3RhdGUpID0+ICh7IC4uLnN0YXRlLCBkcmFncyB9KSksXG4gIGFkZERyYWdnaW5nSWQ6IChpZCkgPT4gc2V0KChzdGF0ZSkgPT4gKHsgLi4uc3RhdGUsIGRyYWdnaW5nSWRzOiBbLi4uc3RhdGUuZHJhZ2dpbmdJZHMsIGlkXSB9KSksXG4gIHJlbW92ZURyYWdnaW5nSWQ6IChpZCkgPT4gc2V0KChzdGF0ZSkgPT4gKHtcbiAgICAuLi5zdGF0ZSxcbiAgICBkcmFnZ2luZ0lkczogc3RhdGUuZHJhZ2dpbmdJZHMuZmlsdGVyKChkcmFnKSA9PiBkcmFnICE9PSBpZClcbiAgfSkpLFxuICBzZXRBY3RpdmVzOiAoYWN0aXZlczIpID0+IHNldCgoc3RhdGUpID0+ICh7IC4uLnN0YXRlLCBhY3RpdmVzOiBhY3RpdmVzMiB9KSksXG4gIHNldFNlbGVjdGlvbnM6IChzZWxlY3Rpb25zMikgPT4gc2V0KChzdGF0ZSkgPT4gKHsgLi4uc3RhdGUsIHNlbGVjdGlvbnM6IHNlbGVjdGlvbnMyIH0pKSxcbiAgc2V0SG92ZXJlZE5vZGVJZDogKGhvdmVyZWROb2RlSWQpID0+IHNldCgoc3RhdGUpID0+ICh7IC4uLnN0YXRlLCBob3ZlcmVkTm9kZUlkIH0pKSxcbiAgc2V0Tm9kZXM6IChub2RlcykgPT4gc2V0KChzdGF0ZSkgPT4gKHtcbiAgICAuLi5zdGF0ZSxcbiAgICBub2RlcyxcbiAgICBjZW50ZXJQb3NpdGlvbjogZ2V0TGF5b3V0Q2VudGVyKG5vZGVzKVxuICB9KSksXG4gIHNldEVkZ2VzOiAoZWRnZXMpID0+IHNldCgoc3RhdGUpID0+ICh7IC4uLnN0YXRlLCBlZGdlcyB9KSksXG4gIHNldE5vZGVQb3NpdGlvbjogKGlkLCBwb3NpdGlvbikgPT4gc2V0KChzdGF0ZSkgPT4ge1xuICAgIHZhciBfYTIsIF9iMjtcbiAgICBjb25zdCBub2RlID0gc3RhdGUubm9kZXMuZmluZCgobikgPT4gbi5pZCA9PT0gaWQpO1xuICAgIGNvbnN0IG9yaWdpbmFsVmVjdG9yID0gZ2V0VmVjdG9yKG5vZGUpO1xuICAgIGNvbnN0IG5ld1ZlY3RvciA9IG5ldyBWZWN0b3IzKHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIHBvc2l0aW9uLnopO1xuICAgIGNvbnN0IG9mZnNldCA9IG5ld1ZlY3Rvci5zdWIob3JpZ2luYWxWZWN0b3IpO1xuICAgIGNvbnN0IG5vZGVzID0gWy4uLnN0YXRlLm5vZGVzXTtcbiAgICBpZiAoKF9hMiA9IHN0YXRlLnNlbGVjdGlvbnMpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuaW5jbHVkZXMoaWQpKSB7XG4gICAgICAoX2IyID0gc3RhdGUuc2VsZWN0aW9ucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9iMi5mb3JFYWNoKChpZDIpID0+IHtcbiAgICAgICAgY29uc3Qgbm9kZTIgPSBzdGF0ZS5ub2Rlcy5maW5kKChuKSA9PiBuLmlkID09PSBpZDIpO1xuICAgICAgICBpZiAobm9kZTIpIHtcbiAgICAgICAgICBjb25zdCBub2RlSW5kZXggPSBzdGF0ZS5ub2Rlcy5pbmRleE9mKG5vZGUyKTtcbiAgICAgICAgICBub2Rlc1tub2RlSW5kZXhdID0gdXBkYXRlTm9kZVBvc2l0aW9uKG5vZGUyLCBvZmZzZXQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgbm9kZUluZGV4ID0gc3RhdGUubm9kZXMuaW5kZXhPZihub2RlKTtcbiAgICAgIG5vZGVzW25vZGVJbmRleF0gPSB1cGRhdGVOb2RlUG9zaXRpb24obm9kZSwgb2Zmc2V0KTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgZHJhZ3M6IHtcbiAgICAgICAgLi4uc3RhdGUuZHJhZ3MsXG4gICAgICAgIFtpZF06IG5vZGVcbiAgICAgIH0sXG4gICAgICBub2Rlc1xuICAgIH07XG4gIH0pLFxuICBzZXRDb2xsYXBzZWROb2RlSWRzOiAobm9kZUlkcyA9IFtdKSA9PiBzZXQoKHN0YXRlKSA9PiAoeyAuLi5zdGF0ZSwgY29sbGFwc2VkTm9kZUlkczogbm9kZUlkcyB9KSksXG4gIC8vIFVwZGF0ZSB0aGUgcG9zaXRpb24gb2YgYSBjbHVzdGVyIHdpdGggbm9kZXMgaW5zaWRlIGl0XG4gIHNldENsdXN0ZXJQb3NpdGlvbjogKGlkLCBwb3NpdGlvbikgPT4gc2V0KChzdGF0ZSkgPT4ge1xuICAgIGNvbnN0IGNsdXN0ZXJzID0gbmV3IE1hcChzdGF0ZS5jbHVzdGVycyk7XG4gICAgY29uc3QgY2x1c3RlciA9IGNsdXN0ZXJzLmdldChpZCk7XG4gICAgaWYgKGNsdXN0ZXIpIHtcbiAgICAgIGNvbnN0IG9sZFBvcyA9IGNsdXN0ZXIucG9zaXRpb247XG4gICAgICBjb25zdCBvZmZzZXQgPSBuZXcgVmVjdG9yMyhcbiAgICAgICAgcG9zaXRpb24ueCAtIG9sZFBvcy54LFxuICAgICAgICBwb3NpdGlvbi55IC0gb2xkUG9zLnksXG4gICAgICAgIHBvc2l0aW9uLnogLSAob2xkUG9zLnogPz8gMClcbiAgICAgICk7XG4gICAgICBjb25zdCBub2RlcyA9IFsuLi5zdGF0ZS5ub2Rlc107XG4gICAgICBjb25zdCBkcmFncyA9IHsgLi4uc3RhdGUuZHJhZ3MgfTtcbiAgICAgIG5vZGVzLmZvckVhY2goKG5vZGUsIGluZGV4KSA9PiB7XG4gICAgICAgIGlmIChub2RlLmNsdXN0ZXIgPT09IGlkKSB7XG4gICAgICAgICAgbm9kZXNbaW5kZXhdID0ge1xuICAgICAgICAgICAgLi4ubm9kZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgIC4uLm5vZGUucG9zaXRpb24sXG4gICAgICAgICAgICAgIHg6IG5vZGUucG9zaXRpb24ueCArIG9mZnNldC54LFxuICAgICAgICAgICAgICB5OiBub2RlLnBvc2l0aW9uLnkgKyBvZmZzZXQueSxcbiAgICAgICAgICAgICAgejogbm9kZS5wb3NpdGlvbi56ICsgKG9mZnNldC56ID8/IDApXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBkcmFnc1tub2RlLmlkXSA9IG5vZGU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgY29uc3QgY2x1c3Rlck5vZGVzID0gbm9kZXMuZmlsdGVyKFxuICAgICAgICAobm9kZSkgPT4gbm9kZS5jbHVzdGVyID09PSBpZFxuICAgICAgKTtcbiAgICAgIGNvbnN0IG5ld0NsdXN0ZXJQb3NpdGlvbiA9IGdldExheW91dENlbnRlcihjbHVzdGVyTm9kZXMpO1xuICAgICAgY2x1c3RlcnMuc2V0KGlkLCB7XG4gICAgICAgIC4uLmNsdXN0ZXIsXG4gICAgICAgIHBvc2l0aW9uOiBuZXdDbHVzdGVyUG9zaXRpb25cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGRyYWdzOiB7XG4gICAgICAgICAgLi4uZHJhZ3MsXG4gICAgICAgICAgW2lkXTogY2x1c3RlclxuICAgICAgICB9LFxuICAgICAgICBjbHVzdGVycyxcbiAgICAgICAgbm9kZXNcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBzdGF0ZTtcbiAgfSlcbn0pKTtcbmZ1bmN0aW9uIGdldEhpZGRlbkNoaWxkcmVuKHtcbiAgbm9kZUlkLFxuICBub2RlcyxcbiAgZWRnZXMsXG4gIGN1cnJlbnRIaWRkZW5Ob2RlcyxcbiAgY3VycmVudEhpZGRlbkVkZ2VzXG59KSB7XG4gIGNvbnN0IGhpZGRlbk5vZGVzID0gW107XG4gIGNvbnN0IGhpZGRlbkVkZ2VzID0gW107XG4gIGNvbnN0IGN1ckhpZGRlbk5vZGVJZHMgPSBjdXJyZW50SGlkZGVuTm9kZXMubWFwKChuKSA9PiBuLmlkKTtcbiAgY29uc3QgY3VySGlkZGVuRWRnZUlkcyA9IGN1cnJlbnRIaWRkZW5FZGdlcy5tYXAoKGUpID0+IGUuaWQpO1xuICBjb25zdCBvdXRib3VuZEVkZ2VzID0gZWRnZXMuZmlsdGVyKChsKSA9PiBsLnNvdXJjZSA9PT0gbm9kZUlkKTtcbiAgY29uc3Qgb3V0Ym91bmRFZGdlTm9kZUlkcyA9IG91dGJvdW5kRWRnZXMubWFwKChsKSA9PiBsLnRhcmdldCk7XG4gIGhpZGRlbkVkZ2VzLnB1c2goLi4ub3V0Ym91bmRFZGdlcyk7XG4gIGZvciAoY29uc3Qgb3V0Ym91bmRFZGdlTm9kZUlkIG9mIG91dGJvdW5kRWRnZU5vZGVJZHMpIHtcbiAgICBjb25zdCBpbmNvbWluZ0VkZ2VzID0gZWRnZXMuZmlsdGVyKFxuICAgICAgKGwpID0+IGwudGFyZ2V0ID09PSBvdXRib3VuZEVkZ2VOb2RlSWQgJiYgbC5zb3VyY2UgIT09IG5vZGVJZFxuICAgICk7XG4gICAgbGV0IGhpZGVOb2RlID0gZmFsc2U7XG4gICAgaWYgKGluY29taW5nRWRnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBoaWRlTm9kZSA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChpbmNvbWluZ0VkZ2VzLmxlbmd0aCA+IDAgJiYgIWN1ckhpZGRlbk5vZGVJZHMuaW5jbHVkZXMob3V0Ym91bmRFZGdlTm9kZUlkKSkge1xuICAgICAgY29uc3QgaW5ib3VuZE5vZGVMaW5rSWRzID0gaW5jb21pbmdFZGdlcy5tYXAoKGwpID0+IGwuaWQpO1xuICAgICAgaWYgKGluYm91bmROb2RlTGlua0lkcy5ldmVyeSgoaSkgPT4gY3VySGlkZGVuRWRnZUlkcy5pbmNsdWRlcyhpKSkpIHtcbiAgICAgICAgaGlkZU5vZGUgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaGlkZU5vZGUpIHtcbiAgICAgIGNvbnN0IG5vZGUgPSBub2Rlcy5maW5kKChuKSA9PiBuLmlkID09PSBvdXRib3VuZEVkZ2VOb2RlSWQpO1xuICAgICAgaWYgKG5vZGUpIHtcbiAgICAgICAgaGlkZGVuTm9kZXMucHVzaChub2RlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5lc3RlZCA9IGdldEhpZGRlbkNoaWxkcmVuKHtcbiAgICAgICAgbm9kZUlkOiBvdXRib3VuZEVkZ2VOb2RlSWQsXG4gICAgICAgIG5vZGVzLFxuICAgICAgICBlZGdlcyxcbiAgICAgICAgY3VycmVudEhpZGRlbkVkZ2VzOiBoaWRkZW5FZGdlcyxcbiAgICAgICAgY3VycmVudEhpZGRlbk5vZGVzOiBoaWRkZW5Ob2Rlc1xuICAgICAgfSk7XG4gICAgICBoaWRkZW5FZGdlcy5wdXNoKC4uLm5lc3RlZC5oaWRkZW5FZGdlcyk7XG4gICAgICBoaWRkZW5Ob2Rlcy5wdXNoKC4uLm5lc3RlZC5oaWRkZW5Ob2Rlcyk7XG4gICAgfVxuICB9XG4gIGNvbnN0IHVuaXF1ZUVkZ2VzID0gT2JqZWN0LnZhbHVlcyhcbiAgICBoaWRkZW5FZGdlcy5yZWR1Y2UoXG4gICAgICAoYWNjLCBuZXh0KSA9PiAoe1xuICAgICAgICAuLi5hY2MsXG4gICAgICAgIFtuZXh0LmlkXTogbmV4dFxuICAgICAgfSksXG4gICAgICB7fVxuICAgIClcbiAgKTtcbiAgY29uc3QgdW5pcXVlTm9kZXMgPSBPYmplY3QudmFsdWVzKFxuICAgIGhpZGRlbk5vZGVzLnJlZHVjZShcbiAgICAgIChhY2MsIG5leHQpID0+ICh7XG4gICAgICAgIC4uLmFjYyxcbiAgICAgICAgW25leHQuaWRdOiBuZXh0XG4gICAgICB9KSxcbiAgICAgIHt9XG4gICAgKVxuICApO1xuICByZXR1cm4ge1xuICAgIGhpZGRlbkVkZ2VzOiB1bmlxdWVFZGdlcyxcbiAgICBoaWRkZW5Ob2RlczogdW5pcXVlTm9kZXNcbiAgfTtcbn1cbmNvbnN0IGdldFZpc2libGVFbnRpdGllcyA9ICh7XG4gIGNvbGxhcHNlZElkcyxcbiAgbm9kZXMsXG4gIGVkZ2VzXG59KSA9PiB7XG4gIGNvbnN0IGN1ckhpZGRlbk5vZGVzID0gW107XG4gIGNvbnN0IGN1ckhpZGRlbkVkZ2VzID0gW107XG4gIGZvciAoY29uc3QgY29sbGFwc2VkSWQgb2YgY29sbGFwc2VkSWRzKSB7XG4gICAgY29uc3QgeyBoaWRkZW5FZGdlcywgaGlkZGVuTm9kZXMgfSA9IGdldEhpZGRlbkNoaWxkcmVuKHtcbiAgICAgIG5vZGVJZDogY29sbGFwc2VkSWQsXG4gICAgICBub2RlcyxcbiAgICAgIGVkZ2VzLFxuICAgICAgY3VycmVudEhpZGRlbkVkZ2VzOiBjdXJIaWRkZW5FZGdlcyxcbiAgICAgIGN1cnJlbnRIaWRkZW5Ob2RlczogY3VySGlkZGVuTm9kZXNcbiAgICB9KTtcbiAgICBjdXJIaWRkZW5Ob2Rlcy5wdXNoKC4uLmhpZGRlbk5vZGVzKTtcbiAgICBjdXJIaWRkZW5FZGdlcy5wdXNoKC4uLmhpZGRlbkVkZ2VzKTtcbiAgfVxuICBjb25zdCBoaWRkZW5Ob2RlSWRzID0gY3VySGlkZGVuTm9kZXMubWFwKChuKSA9PiBuLmlkKTtcbiAgY29uc3QgaGlkZGVuRWRnZUlkcyA9IGN1ckhpZGRlbkVkZ2VzLm1hcCgoZSkgPT4gZS5pZCk7XG4gIGNvbnN0IHZpc2libGVOb2RlcyA9IG5vZGVzLmZpbHRlcigobikgPT4gIWhpZGRlbk5vZGVJZHMuaW5jbHVkZXMobi5pZCkpO1xuICBjb25zdCB2aXNpYmxlRWRnZXMgPSBlZGdlcy5maWx0ZXIoKGUpID0+ICFoaWRkZW5FZGdlSWRzLmluY2x1ZGVzKGUuaWQpKTtcbiAgcmV0dXJuIHtcbiAgICB2aXNpYmxlTm9kZXMsXG4gICAgdmlzaWJsZUVkZ2VzXG4gIH07XG59O1xuY29uc3QgZ2V0RXhwYW5kUGF0aCA9ICh7XG4gIG5vZGVJZCxcbiAgZWRnZXMsXG4gIHZpc2libGVFZGdlSWRzXG59KSA9PiB7XG4gIGNvbnN0IHBhcmVudElkcyA9IFtdO1xuICBjb25zdCBpbmJvdW5kRWRnZXMgPSBlZGdlcy5maWx0ZXIoKGwpID0+IGwudGFyZ2V0ID09PSBub2RlSWQpO1xuICBjb25zdCBpbmJvdW5kRWRnZUlkcyA9IGluYm91bmRFZGdlcy5tYXAoKGUpID0+IGUuaWQpO1xuICBjb25zdCBoYXNWaXNpYmxlSW5ib3VuZEVkZ2UgPSBpbmJvdW5kRWRnZUlkcy5zb21lKFxuICAgIChpZCkgPT4gdmlzaWJsZUVkZ2VJZHMuaW5jbHVkZXMoaWQpXG4gICk7XG4gIGlmIChoYXNWaXNpYmxlSW5ib3VuZEVkZ2UpIHtcbiAgICByZXR1cm4gcGFyZW50SWRzO1xuICB9XG4gIGNvbnN0IGluYm91bmRFZGdlTm9kZUlkcyA9IGluYm91bmRFZGdlcy5tYXAoKGwpID0+IGwuc291cmNlKTtcbiAgbGV0IGFkZGVkUGFyZW50ID0gZmFsc2U7XG4gIGZvciAoY29uc3QgaW5ib3VuZE5vZGVJZCBvZiBpbmJvdW5kRWRnZU5vZGVJZHMpIHtcbiAgICBpZiAoIWFkZGVkUGFyZW50KSB7XG4gICAgICBwYXJlbnRJZHMucHVzaChcbiAgICAgICAgLi4uW1xuICAgICAgICAgIGluYm91bmROb2RlSWQsXG4gICAgICAgICAgLi4uZ2V0RXhwYW5kUGF0aCh7IG5vZGVJZDogaW5ib3VuZE5vZGVJZCwgZWRnZXMsIHZpc2libGVFZGdlSWRzIH0pXG4gICAgICAgIF1cbiAgICAgICk7XG4gICAgICBhZGRlZFBhcmVudCA9IHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJlbnRJZHM7XG59O1xuY29uc3QgdXNlQ29sbGFwc2UgPSAoe1xuICBjb2xsYXBzZWROb2RlSWRzID0gW10sXG4gIG5vZGVzID0gW10sXG4gIGVkZ2VzID0gW11cbn0pID0+IHtcbiAgY29uc3QgZ2V0SXNDb2xsYXBzZWQgPSB1c2VDYWxsYmFjayhcbiAgICAobm9kZUlkKSA9PiB7XG4gICAgICBjb25zdCB7IHZpc2libGVOb2RlcyB9ID0gZ2V0VmlzaWJsZUVudGl0aWVzKHtcbiAgICAgICAgbm9kZXMsXG4gICAgICAgIGVkZ2VzLFxuICAgICAgICBjb2xsYXBzZWRJZHM6IGNvbGxhcHNlZE5vZGVJZHNcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdmlzaWJsZU5vZGVJZHMgPSB2aXNpYmxlTm9kZXMubWFwKChuKSA9PiBuLmlkKTtcbiAgICAgIHJldHVybiAhdmlzaWJsZU5vZGVJZHMuaW5jbHVkZXMobm9kZUlkKTtcbiAgICB9LFxuICAgIFtjb2xsYXBzZWROb2RlSWRzLCBlZGdlcywgbm9kZXNdXG4gICk7XG4gIGNvbnN0IGdldEV4cGFuZFBhdGhJZHMgPSB1c2VDYWxsYmFjayhcbiAgICAobm9kZUlkKSA9PiB7XG4gICAgICBjb25zdCB7IHZpc2libGVFZGdlcyB9ID0gZ2V0VmlzaWJsZUVudGl0aWVzKHtcbiAgICAgICAgbm9kZXMsXG4gICAgICAgIGVkZ2VzLFxuICAgICAgICBjb2xsYXBzZWRJZHM6IGNvbGxhcHNlZE5vZGVJZHNcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdmlzaWJsZUVkZ2VJZHMgPSB2aXNpYmxlRWRnZXMubWFwKChlKSA9PiBlLmlkKTtcbiAgICAgIHJldHVybiBnZXRFeHBhbmRQYXRoKHsgbm9kZUlkLCBlZGdlcywgdmlzaWJsZUVkZ2VJZHMgfSk7XG4gICAgfSxcbiAgICBbY29sbGFwc2VkTm9kZUlkcywgZWRnZXMsIG5vZGVzXVxuICApO1xuICByZXR1cm4ge1xuICAgIGdldElzQ29sbGFwc2VkLFxuICAgIGdldEV4cGFuZFBhdGhJZHNcbiAgfTtcbn07XG5jb25zdCB1c2VHcmFwaCA9ICh7XG4gIGxheW91dFR5cGUsXG4gIHNpemluZ1R5cGUsXG4gIGxhYmVsVHlwZSxcbiAgc2l6aW5nQXR0cmlidXRlLFxuICBjbHVzdGVyQXR0cmlidXRlLFxuICBzZWxlY3Rpb25zLFxuICBub2RlcyxcbiAgZWRnZXMsXG4gIGFjdGl2ZXMsXG4gIGNvbGxhcHNlZE5vZGVJZHMsXG4gIGRlZmF1bHROb2RlU2l6ZSxcbiAgbWF4Tm9kZVNpemUsXG4gIG1pbk5vZGVTaXplLFxuICBsYXlvdXRPdmVycmlkZXMsXG4gIGNvbnN0cmFpbkRyYWdnaW5nXG59KSA9PiB7XG4gIGNvbnN0IGdyYXBoID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5ncmFwaCk7XG4gIGNvbnN0IGNsdXN0ZXJzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5jbHVzdGVycyk7XG4gIGNvbnN0IHN0b3JlZE5vZGVzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5ub2Rlcyk7XG4gIGNvbnN0IHNldENsdXN0ZXJzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5zZXRDbHVzdGVycyk7XG4gIGNvbnN0IHN0YXRlQ29sbGFwc2VkTm9kZUlkcyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuY29sbGFwc2VkTm9kZUlkcyk7XG4gIGNvbnN0IHNldEVkZ2VzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5zZXRFZGdlcyk7XG4gIGNvbnN0IHN0YXRlTm9kZXMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLm5vZGVzKTtcbiAgY29uc3Qgc2V0Tm9kZXMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnNldE5vZGVzKTtcbiAgY29uc3Qgc2V0U2VsZWN0aW9ucyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuc2V0U2VsZWN0aW9ucyk7XG4gIGNvbnN0IHNldEFjdGl2ZXMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnNldEFjdGl2ZXMpO1xuICBjb25zdCBkcmFncyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuZHJhZ3MpO1xuICBjb25zdCBzZXREcmFncyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuc2V0RHJhZ3MpO1xuICBjb25zdCBzZXRDb2xsYXBzZWROb2RlSWRzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5zZXRDb2xsYXBzZWROb2RlSWRzKTtcbiAgY29uc3QgbGF5b3V0TW91bnRlZCA9IHVzZVJlZihmYWxzZSk7XG4gIGNvbnN0IGxheW91dCA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgY2FtZXJhID0gdXNlVGhyZWUoKHN0YXRlKSA9PiBzdGF0ZS5jYW1lcmEpO1xuICBjb25zdCBkcmFnUmVmID0gdXNlUmVmKGRyYWdzKTtcbiAgY29uc3QgY2x1c3RlcnNSZWYgPSB1c2VSZWYoW10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHZhciBfYTI7XG4gICAgaWYgKCFjbHVzdGVyQXR0cmlidXRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGV4aXN0ZWROb2Rlc0lkcyA9IHN0b3JlZE5vZGVzLm1hcCgobikgPT4gbi5pZCk7XG4gICAgY29uc3QgbmV3Tm9kZSA9IG5vZGVzLmZpbmQoKG4pID0+ICFleGlzdGVkTm9kZXNJZHMuaW5jbHVkZXMobi5pZCkpO1xuICAgIGlmIChuZXdOb2RlKSB7XG4gICAgICBjb25zdCBjbHVzdGVyTmFtZSA9IG5ld05vZGUuZGF0YVtjbHVzdGVyQXR0cmlidXRlXTtcbiAgICAgIGNvbnN0IGNsdXN0ZXIgPSBjbHVzdGVycy5nZXQoY2x1c3Rlck5hbWUpO1xuICAgICAgY29uc3QgZHJhZ3MyID0geyAuLi5kcmFnUmVmLmN1cnJlbnQgfTtcbiAgICAgIChfYTIgPSBjbHVzdGVyID09IG51bGwgPyB2b2lkIDAgOiBjbHVzdGVyLm5vZGVzKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmZvckVhY2goKG5vZGUpID0+IGRyYWdzMltub2RlLmlkXSA9IHZvaWQgMCk7XG4gICAgICBkcmFnUmVmLmN1cnJlbnQgPSBkcmFnczI7XG4gICAgICBzZXREcmFncyhkcmFnczIpO1xuICAgIH1cbiAgfSwgW3N0b3JlZE5vZGVzLCBub2RlcywgY2x1c3RlckF0dHJpYnV0ZSwgY2x1c3RlcnMsIHNldERyYWdzXSk7XG4gIGNvbnN0IHsgdmlzaWJsZUVkZ2VzLCB2aXNpYmxlTm9kZXMgfSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gZ2V0VmlzaWJsZUVudGl0aWVzKHtcbiAgICAgIGNvbGxhcHNlZElkczogc3RhdGVDb2xsYXBzZWROb2RlSWRzLFxuICAgICAgbm9kZXMsXG4gICAgICBlZGdlc1xuICAgIH0pLFxuICAgIFtzdGF0ZUNvbGxhcHNlZE5vZGVJZHMsIG5vZGVzLCBlZGdlc11cbiAgKTtcbiAgY29uc3QgdXBkYXRlRHJhZ3MgPSB1c2VDYWxsYmFjayhcbiAgICAobm9kZXMyKSA9PiB7XG4gICAgICBjb25zdCBkcmFnczIgPSB7IC4uLmRyYWdSZWYuY3VycmVudCB9O1xuICAgICAgbm9kZXMyLmZvckVhY2goKG5vZGUpID0+IGRyYWdzMltub2RlLmlkXSA9IG5vZGUpO1xuICAgICAgZHJhZ1JlZi5jdXJyZW50ID0gZHJhZ3MyO1xuICAgICAgc2V0RHJhZ3MoZHJhZ3MyKTtcbiAgICB9LFxuICAgIFtzZXREcmFnc11cbiAgKTtcbiAgY29uc3QgdXBkYXRlTGF5b3V0ID0gdXNlQ2FsbGJhY2soXG4gICAgYXN5bmMgKGN1ckxheW91dCkgPT4ge1xuICAgICAgbGF5b3V0LmN1cnJlbnQgPSBjdXJMYXlvdXQgfHwgbGF5b3V0UHJvdmlkZXIoe1xuICAgICAgICAuLi5sYXlvdXRPdmVycmlkZXMsXG4gICAgICAgIHR5cGU6IGxheW91dFR5cGUsXG4gICAgICAgIGdyYXBoLFxuICAgICAgICBkcmFnczogZHJhZ1JlZi5jdXJyZW50LFxuICAgICAgICBjbHVzdGVyczogY2x1c3RlcnNSZWYgPT0gbnVsbCA/IHZvaWQgMCA6IGNsdXN0ZXJzUmVmLmN1cnJlbnQsXG4gICAgICAgIGNsdXN0ZXJBdHRyaWJ1dGVcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgdGljayhsYXlvdXQuY3VycmVudCk7XG4gICAgICBjb25zdCByZXN1bHQgPSB0cmFuc2Zvcm1HcmFwaCh7XG4gICAgICAgIGdyYXBoLFxuICAgICAgICBsYXlvdXQ6IGxheW91dC5jdXJyZW50LFxuICAgICAgICBzaXppbmdUeXBlLFxuICAgICAgICBsYWJlbFR5cGUsXG4gICAgICAgIHNpemluZ0F0dHJpYnV0ZSxcbiAgICAgICAgbWF4Tm9kZVNpemUsXG4gICAgICAgIG1pbk5vZGVTaXplLFxuICAgICAgICBkZWZhdWx0Tm9kZVNpemUsXG4gICAgICAgIGNsdXN0ZXJBdHRyaWJ1dGVcbiAgICAgIH0pO1xuICAgICAgY29uc3QgbmV3Q2x1c3RlcnMgPSBjYWxjdWxhdGVDbHVzdGVycyh7XG4gICAgICAgIG5vZGVzOiByZXN1bHQubm9kZXMsXG4gICAgICAgIGNsdXN0ZXJBdHRyaWJ1dGVcbiAgICAgIH0pO1xuICAgICAgaWYgKGNvbnN0cmFpbkRyYWdnaW5nKSB7XG4gICAgICAgIG5ld0NsdXN0ZXJzLmZvckVhY2goKGNsdXN0ZXIpID0+IHtcbiAgICAgICAgICB2YXIgX2EyLCBfYjI7XG4gICAgICAgICAgY29uc3QgcHJldkNsdXN0ZXIgPSBjbHVzdGVyc1JlZi5jdXJyZW50LmdldChjbHVzdGVyLmxhYmVsKTtcbiAgICAgICAgICBpZiAoKHByZXZDbHVzdGVyID09IG51bGwgPyB2b2lkIDAgOiBwcmV2Q2x1c3Rlci5ub2Rlcy5sZW5ndGgpID09PSBjbHVzdGVyLm5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgY2x1c3Rlci5wb3NpdGlvbiA9ICgoX2IyID0gKF9hMiA9IGNsdXN0ZXJzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuZ2V0KGNsdXN0ZXIubGFiZWwpKSA9PSBudWxsID8gdm9pZCAwIDogX2IyLnBvc2l0aW9uKSA/PyBjbHVzdGVyLnBvc2l0aW9uO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBzZXRFZGdlcyhyZXN1bHQuZWRnZXMpO1xuICAgICAgc2V0Tm9kZXMocmVzdWx0Lm5vZGVzKTtcbiAgICAgIHNldENsdXN0ZXJzKG5ld0NsdXN0ZXJzKTtcbiAgICAgIGlmIChjbHVzdGVyQXR0cmlidXRlKSB7XG4gICAgICAgIHVwZGF0ZURyYWdzKHJlc3VsdC5ub2Rlcyk7XG4gICAgICB9XG4gICAgfSxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gICAgW1xuICAgICAgbGF5b3V0T3ZlcnJpZGVzLFxuICAgICAgbGF5b3V0VHlwZSxcbiAgICAgIGNsdXN0ZXJBdHRyaWJ1dGUsXG4gICAgICBzaXppbmdUeXBlLFxuICAgICAgbGFiZWxUeXBlLFxuICAgICAgc2l6aW5nQXR0cmlidXRlLFxuICAgICAgbWF4Tm9kZVNpemUsXG4gICAgICBtaW5Ob2RlU2l6ZSxcbiAgICAgIGRlZmF1bHROb2RlU2l6ZSxcbiAgICAgIHNldEVkZ2VzLFxuICAgICAgc2V0Tm9kZXMsXG4gICAgICBzZXRDbHVzdGVyc1xuICAgIF1cbiAgKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBkcmFnUmVmLmN1cnJlbnQgPSBkcmFncztcbiAgfSwgW2RyYWdzLCBjbHVzdGVyQXR0cmlidXRlLCB1cGRhdGVMYXlvdXRdKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjbHVzdGVyc1JlZi5jdXJyZW50ID0gY2x1c3RlcnM7XG4gIH0sIFtjbHVzdGVyc10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IG5vZGVzMiA9IHN0YXRlTm9kZXMubWFwKChub2RlKSA9PiAoe1xuICAgICAgLi4ubm9kZSxcbiAgICAgIGxhYmVsVmlzaWJsZTogY2FsY0xhYmVsVmlzaWJpbGl0eSh7XG4gICAgICAgIG5vZGVDb3VudDogc3RhdGVOb2RlcyA9PSBudWxsID8gdm9pZCAwIDogc3RhdGVOb2Rlcy5sZW5ndGgsXG4gICAgICAgIGxhYmVsVHlwZSxcbiAgICAgICAgY2FtZXJhLFxuICAgICAgICBub2RlUG9zaXRpb246IG5vZGUgPT0gbnVsbCA/IHZvaWQgMCA6IG5vZGUucG9zaXRpb25cbiAgICAgIH0pKFwibm9kZVwiLCBub2RlID09IG51bGwgPyB2b2lkIDAgOiBub2RlLnNpemUpXG4gICAgfSkpO1xuICAgIGNvbnN0IGlzVmlzaWJpbGl0eVVwZGF0ZWQgPSBub2RlczIuc29tZShcbiAgICAgIChub2RlLCBpKSA9PiBub2RlLmxhYmVsVmlzaWJsZSAhPT0gc3RhdGVOb2Rlc1tpXS5sYWJlbFZpc2libGVcbiAgICApO1xuICAgIGlmIChpc1Zpc2liaWxpdHlVcGRhdGVkKSB7XG4gICAgICBzZXROb2Rlcyhub2RlczIpO1xuICAgIH1cbiAgfSwgW2NhbWVyYSwgY2FtZXJhLnpvb20sIGNhbWVyYS5wb3NpdGlvbi56LCBzZXROb2Rlcywgc3RhdGVOb2RlcywgbGFiZWxUeXBlXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGxheW91dE1vdW50ZWQuY3VycmVudCkge1xuICAgICAgc2V0U2VsZWN0aW9ucyhzZWxlY3Rpb25zKTtcbiAgICB9XG4gIH0sIFtzZWxlY3Rpb25zLCBzZXRTZWxlY3Rpb25zXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGxheW91dE1vdW50ZWQuY3VycmVudCkge1xuICAgICAgc2V0QWN0aXZlcyhhY3RpdmVzKTtcbiAgICB9XG4gIH0sIFthY3RpdmVzLCBzZXRBY3RpdmVzXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgYXN5bmMgZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgICAgbGF5b3V0TW91bnRlZC5jdXJyZW50ID0gZmFsc2U7XG4gICAgICBidWlsZEdyYXBoKGdyYXBoLCB2aXNpYmxlTm9kZXMsIHZpc2libGVFZGdlcyk7XG4gICAgICBhd2FpdCB1cGRhdGVMYXlvdXQoKTtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBsYXlvdXRNb3VudGVkLmN1cnJlbnQgPSB0cnVlKTtcbiAgICB9XG4gICAgdXBkYXRlKCk7XG4gIH0sIFt2aXNpYmxlTm9kZXMsIHZpc2libGVFZGdlc10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChsYXlvdXRNb3VudGVkLmN1cnJlbnQpIHtcbiAgICAgIHNldENvbGxhcHNlZE5vZGVJZHMoY29sbGFwc2VkTm9kZUlkcyk7XG4gICAgfVxuICB9LCBbY29sbGFwc2VkTm9kZUlkcywgc2V0Q29sbGFwc2VkTm9kZUlkc10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChsYXlvdXRNb3VudGVkLmN1cnJlbnQpIHtcbiAgICAgIGRyYWdSZWYuY3VycmVudCA9IHt9O1xuICAgICAgc2V0RHJhZ3Moe30pO1xuICAgICAgdXBkYXRlTGF5b3V0KCk7XG4gICAgfVxuICB9LCBbbGF5b3V0VHlwZSwgdXBkYXRlTGF5b3V0LCBzZXREcmFnc10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChsYXlvdXRNb3VudGVkLmN1cnJlbnQpIHtcbiAgICAgIHVwZGF0ZUxheW91dChsYXlvdXQuY3VycmVudCk7XG4gICAgfVxuICB9LCBbc2l6aW5nVHlwZSwgc2l6aW5nQXR0cmlidXRlLCBsYWJlbFR5cGUsIHVwZGF0ZUxheW91dF0pO1xuICByZXR1cm4ge1xuICAgIHVwZGF0ZUxheW91dFxuICB9O1xufTtcbmNvbnN0IExhYmVsID0gKHtcbiAgdGV4dCxcbiAgZm9udFNpemUgPSA3LFxuICBmb250VXJsLFxuICBjb2xvciA9IFwiIzJBNjQ3NVwiLFxuICBvcGFjaXR5ID0gMSxcbiAgc3Ryb2tlLFxuICBhY3RpdmUsXG4gIGVsbGlwc2lzID0gNzUsXG4gIHJvdGF0aW9uXG59KSA9PiB7XG4gIGNvbnN0IHNob3J0VGV4dCA9IGVsbGlwc2lzICYmICFhY3RpdmUgPyBlbGxpcHNpemUodGV4dCwgZWxsaXBzaXMpIDogdGV4dDtcbiAgY29uc3Qgbm9ybWFsaXplZENvbG9yID0gdXNlTWVtbygoKSA9PiBuZXcgQ29sb3IoY29sb3IpLCBbY29sb3JdKTtcbiAgY29uc3Qgbm9ybWFsaXplZFN0cm9rZSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gc3Ryb2tlID8gbmV3IENvbG9yKHN0cm9rZSkgOiB2b2lkIDAsXG4gICAgW3N0cm9rZV1cbiAgKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goQmlsbGJvYXJkLCB7IHBvc2l0aW9uOiBbMCwgMCwgMV0sIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgIFRleHQsXG4gICAge1xuICAgICAgZm9udDogZm9udFVybCxcbiAgICAgIGZvbnRTaXplLFxuICAgICAgY29sb3I6IG5vcm1hbGl6ZWRDb2xvcixcbiAgICAgIGZpbGxPcGFjaXR5OiBvcGFjaXR5LFxuICAgICAgdGV4dEFsaWduOiBcImNlbnRlclwiLFxuICAgICAgb3V0bGluZVdpZHRoOiBzdHJva2UgPyAxIDogMCxcbiAgICAgIG91dGxpbmVDb2xvcjogbm9ybWFsaXplZFN0cm9rZSxcbiAgICAgIGRlcHRoT2Zmc2V0OiAwLFxuICAgICAgbWF4V2lkdGg6IDEwMCxcbiAgICAgIG92ZXJmbG93V3JhcDogXCJicmVhay13b3JkXCIsXG4gICAgICByb3RhdGlvbixcbiAgICAgIGNoaWxkcmVuOiBzaG9ydFRleHRcbiAgICB9XG4gICkgfSk7XG59O1xuY29uc3QgUmluZyQxID0gKHtcbiAgY29sb3IgPSBcIiNEOEU2RUFcIixcbiAgc2l6ZSA9IDEsXG4gIG9wYWNpdHkgPSAwLjUsXG4gIGFuaW1hdGVkLFxuICBzdHJva2VXaWR0aCA9IDUsXG4gIGlubmVyUmFkaXVzID0gNCxcbiAgc2VnbWVudHMgPSAyNVxufSkgPT4ge1xuICBjb25zdCBub3JtYWxpemVkQ29sb3IgPSB1c2VNZW1vKCgpID0+IG5ldyBDb2xvcihjb2xvciksIFtjb2xvcl0pO1xuICBjb25zdCB7IHJpbmdTaXplLCByaW5nT3BhY2l0eSB9ID0gdXNlU3ByaW5nKHtcbiAgICBmcm9tOiB7XG4gICAgICByaW5nT3BhY2l0eTogMCxcbiAgICAgIHJpbmdTaXplOiBbMWUtNSwgMWUtNSwgMWUtNV1cbiAgICB9LFxuICAgIHRvOiB7XG4gICAgICByaW5nT3BhY2l0eTogb3BhY2l0eSxcbiAgICAgIHJpbmdTaXplOiBbc2l6ZSAvIDIsIHNpemUgLyAyLCAxXVxuICAgIH0sXG4gICAgY29uZmlnOiB7XG4gICAgICAuLi5hbmltYXRpb25Db25maWcsXG4gICAgICBkdXJhdGlvbjogYW5pbWF0ZWQgPyB2b2lkIDAgOiAwXG4gICAgfVxuICB9KTtcbiAgY29uc3Qgc3Ryb2tlV2lkdGhGcmFjdGlvbiA9IHN0cm9rZVdpZHRoIC8gMTA7XG4gIGNvbnN0IG91dGVyUmFkaXVzID0gaW5uZXJSYWRpdXMgKyBzdHJva2VXaWR0aEZyYWN0aW9uO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChCaWxsYm9hcmQsIHsgcG9zaXRpb246IFswLCAwLCAxXSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3hzKGEubWVzaCwgeyBzY2FsZTogcmluZ1NpemUsIGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgIFwicmluZ0dlb21ldHJ5XCIsXG4gICAgICB7XG4gICAgICAgIGF0dGFjaDogXCJnZW9tZXRyeVwiLFxuICAgICAgICBhcmdzOiBbaW5uZXJSYWRpdXMsIG91dGVyUmFkaXVzLCBzZWdtZW50c11cbiAgICAgIH1cbiAgICApLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICBhLm1lc2hCYXNpY01hdGVyaWFsLFxuICAgICAge1xuICAgICAgICBhdHRhY2g6IFwibWF0ZXJpYWxcIixcbiAgICAgICAgY29sb3I6IG5vcm1hbGl6ZWRDb2xvcixcbiAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICAgIG9wYWNpdHk6IHJpbmdPcGFjaXR5LFxuICAgICAgICBzaWRlOiBEb3VibGVTaWRlLFxuICAgICAgICBmb2c6IHRydWVcbiAgICAgIH1cbiAgICApXG4gIF0gfSkgfSk7XG59O1xuY29uc3QgU3BoZXJlID0gKHtcbiAgY29sb3IsXG4gIGlkLFxuICBzaXplLFxuICBzZWxlY3RlZCxcbiAgb3BhY2l0eSA9IDEsXG4gIGFuaW1hdGVkXG59KSA9PiB7XG4gIGNvbnN0IHsgc2NhbGUsIG5vZGVPcGFjaXR5IH0gPSB1c2VTcHJpbmcoe1xuICAgIGZyb206IHtcbiAgICAgIC8vIE5vdGU6IFRoaXMgcHJldmVudHMgaW5jb3JyZWN0IHNjYWxpbmcgdy8gMFxuICAgICAgc2NhbGU6IFsxZS01LCAxZS01LCAxZS01XSxcbiAgICAgIG5vZGVPcGFjaXR5OiAwXG4gICAgfSxcbiAgICB0bzoge1xuICAgICAgc2NhbGU6IFtzaXplLCBzaXplLCBzaXplXSxcbiAgICAgIG5vZGVPcGFjaXR5OiBvcGFjaXR5XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIC4uLmFuaW1hdGlvbkNvbmZpZyxcbiAgICAgIGR1cmF0aW9uOiBhbmltYXRlZCA/IHZvaWQgMCA6IDBcbiAgICB9XG4gIH0pO1xuICBjb25zdCBub3JtYWxpemVkQ29sb3IgPSB1c2VNZW1vKCgpID0+IG5ldyBDb2xvcihjb2xvciksIFtjb2xvcl0pO1xuICBjb25zdCB0aGVtZSA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUudGhlbWUpO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4cyhhLm1lc2gsIHsgdXNlckRhdGE6IHsgaWQsIHR5cGU6IFwibm9kZVwiIH0sIHNjYWxlLCBjaGlsZHJlbjogW1xuICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcInNwaGVyZUdlb21ldHJ5XCIsIHsgYXR0YWNoOiBcImdlb21ldHJ5XCIsIGFyZ3M6IFsxLCAyNSwgMjVdIH0pLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgYS5tZXNoUGhvbmdNYXRlcmlhbCxcbiAgICAgICAge1xuICAgICAgICAgIGF0dGFjaDogXCJtYXRlcmlhbFwiLFxuICAgICAgICAgIHNpZGU6IERvdWJsZVNpZGUsXG4gICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICAgICAgZm9nOiB0cnVlLFxuICAgICAgICAgIG9wYWNpdHk6IG5vZGVPcGFjaXR5LFxuICAgICAgICAgIGNvbG9yOiBub3JtYWxpemVkQ29sb3JcbiAgICAgICAgfVxuICAgICAgKVxuICAgIF0gfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgIFJpbmckMSxcbiAgICAgIHtcbiAgICAgICAgb3BhY2l0eTogc2VsZWN0ZWQgPyAwLjUgOiAwLFxuICAgICAgICBzaXplLFxuICAgICAgICBhbmltYXRlZCxcbiAgICAgICAgY29sb3I6IHNlbGVjdGVkID8gdGhlbWUucmluZy5hY3RpdmVGaWxsIDogdGhlbWUucmluZy5maWxsXG4gICAgICB9XG4gICAgKVxuICBdIH0pO1xufTtcbmNvbnN0IENhbWVyYUNvbnRyb2xzQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQkMSh7XG4gIGNvbnRyb2xzOiBudWxsLFxuICByZXNldENvbnRyb2xzOiAoKSA9PiB2b2lkIDAsXG4gIHpvb21JbjogKCkgPT4gdm9pZCAwLFxuICB6b29tT3V0OiAoKSA9PiB2b2lkIDAsXG4gIGRvbGx5SW46ICgpID0+IHZvaWQgMCxcbiAgZG9sbHlPdXQ6ICgpID0+IHZvaWQgMCxcbiAgcGFuTGVmdDogKCkgPT4gdm9pZCAwLFxuICBwYW5SaWdodDogKCkgPT4gdm9pZCAwLFxuICBwYW5VcDogKCkgPT4gdm9pZCAwLFxuICBwYW5Eb3duOiAoKSA9PiB2b2lkIDAsXG4gIGZyZWV6ZTogKCkgPT4gdm9pZCAwLFxuICB1bkZyZWV6ZTogKCkgPT4gdm9pZCAwXG59KTtcbmNvbnN0IHVzZUNhbWVyYUNvbnRyb2xzID0gKCkgPT4ge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChDYW1lcmFDb250cm9sc0NvbnRleHQpO1xuICBpZiAoY29udGV4dCA9PT0gdm9pZCAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJgdXNlQ2FtZXJhQ29udHJvbHNgIGhvb2sgbXVzdCBiZSB1c2VkIHdpdGhpbiBhIGBDb250cm9sc1Byb3ZpZGVyYCBjb21wb25lbnRcIlxuICAgICk7XG4gIH1cbiAgcmV0dXJuIGNvbnRleHQ7XG59O1xuVGhyZWVDYW1lcmFDb250cm9scy5pbnN0YWxsKHtcbiAgVEhSRUU6IHtcbiAgICBNT1VTRSxcbiAgICBWZWN0b3IyLFxuICAgIFZlY3RvcjMsXG4gICAgVmVjdG9yNCxcbiAgICBRdWF0ZXJuaW9uLFxuICAgIE1hdHJpeDQsXG4gICAgU3BoZXJpY2FsLFxuICAgIEJveDMsXG4gICAgU3BoZXJlOiBTcGhlcmUkMSxcbiAgICBSYXljYXN0ZXIsXG4gICAgTWF0aFV0aWxzOiB7XG4gICAgICBERUcyUkFEOiAoX2EgPSBNYXRoVXRpbHMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5ERUcyUkFELFxuICAgICAgY2xhbXA6IChfYiA9IE1hdGhVdGlscykgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLmNsYW1wXG4gICAgfVxuICB9XG59KTtcbmV4dGVuZCh7IFRocmVlQ2FtZXJhQ29udHJvbHMgfSk7XG5jb25zdCBLRVlfQ09ERVMgPSB7XG4gIEFSUk9XX0xFRlQ6IDM3LFxuICBBUlJPV19VUDogMzgsXG4gIEFSUk9XX1JJR0hUOiAzOSxcbiAgQVJST1dfRE9XTjogNDBcbn07XG5jb25zdCBsZWZ0S2V5ID0gbmV3IGhvbGRFdmVudC5LZXlib2FyZEtleUhvbGQoS0VZX0NPREVTLkFSUk9XX0xFRlQsIDEwMCk7XG5jb25zdCByaWdodEtleSA9IG5ldyBob2xkRXZlbnQuS2V5Ym9hcmRLZXlIb2xkKEtFWV9DT0RFUy5BUlJPV19SSUdIVCwgMTAwKTtcbmNvbnN0IHVwS2V5ID0gbmV3IGhvbGRFdmVudC5LZXlib2FyZEtleUhvbGQoS0VZX0NPREVTLkFSUk9XX1VQLCAxMDApO1xuY29uc3QgZG93bktleSA9IG5ldyBob2xkRXZlbnQuS2V5Ym9hcmRLZXlIb2xkKEtFWV9DT0RFUy5BUlJPV19ET1dOLCAxMDApO1xuY29uc3QgQ2FtZXJhQ29udHJvbHMgPSBmb3J3YXJkUmVmKFxuICAoe1xuICAgIG1vZGUgPSBcInJvdGF0ZVwiLFxuICAgIGNoaWxkcmVuLFxuICAgIGFuaW1hdGVkLFxuICAgIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gICAgbWluRGlzdGFuY2UgPSAxZTMsXG4gICAgbWF4RGlzdGFuY2UgPSA1ZTRcbiAgfSwgcmVmKSA9PiB7XG4gICAgY29uc3QgY2FtZXJhUmVmID0gdXNlUmVmKG51bGwpO1xuICAgIGNvbnN0IGNhbWVyYSA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuY2FtZXJhKTtcbiAgICBjb25zdCBnbCA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuZ2wpO1xuICAgIGNvbnN0IGlzT3JiaXRpbmcgPSBtb2RlID09PSBcIm9yYml0XCI7XG4gICAgY29uc3Qgc2V0UGFubmluZyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuc2V0UGFubmluZyk7XG4gICAgY29uc3QgaXNEcmFnZ2luZyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuZHJhZ2dpbmdJZHMubGVuZ3RoID4gMCk7XG4gICAgY29uc3QgY2FtZXJhU3BlZWRSZWYgPSB1c2VSZWYoMCk7XG4gICAgdXNlRnJhbWUoKF9zdGF0ZSwgZGVsdGEpID0+IHtcbiAgICAgIHZhciBfYTIsIF9iMjtcbiAgICAgIGlmICgoX2EyID0gY2FtZXJhUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuZW5hYmxlZCkge1xuICAgICAgICAoX2IyID0gY2FtZXJhUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYjIudXBkYXRlKGRlbHRhKTtcbiAgICAgIH1cbiAgICAgIGlmIChpc09yYml0aW5nKSB7XG4gICAgICAgIGNhbWVyYVJlZi5jdXJyZW50LmF6aW11dGhBbmdsZSArPSAyMCAqIGRlbHRhICogTWF0aFV0aWxzLkRFRzJSQUQ7XG4gICAgICB9XG4gICAgfSwgLTEpO1xuICAgIHVzZUVmZmVjdCgoKSA9PiAoKSA9PiB7XG4gICAgICB2YXIgX2EyO1xuICAgICAgcmV0dXJuIChfYTIgPSBjYW1lcmFSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5kaXNwb3NlKCk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IHpvb21JbiA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgIHZhciBfYTI7XG4gICAgICAoX2EyID0gY2FtZXJhUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuem9vbShjYW1lcmEuem9vbSAvIDIsIGFuaW1hdGVkKTtcbiAgICB9LCBbYW5pbWF0ZWQsIGNhbWVyYS56b29tXSk7XG4gICAgY29uc3Qgem9vbU91dCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgIHZhciBfYTI7XG4gICAgICAoX2EyID0gY2FtZXJhUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuem9vbSgtY2FtZXJhLnpvb20gLyAyLCBhbmltYXRlZCk7XG4gICAgfSwgW2FuaW1hdGVkLCBjYW1lcmEuem9vbV0pO1xuICAgIGNvbnN0IGRvbGx5SW4gPSB1c2VDYWxsYmFjayhcbiAgICAgIChkaXN0YW5jZSkgPT4ge1xuICAgICAgICB2YXIgX2EyO1xuICAgICAgICAoX2EyID0gY2FtZXJhUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuZG9sbHkoZGlzdGFuY2UsIGFuaW1hdGVkKTtcbiAgICAgIH0sXG4gICAgICBbYW5pbWF0ZWRdXG4gICAgKTtcbiAgICBjb25zdCBkb2xseU91dCA9IHVzZUNhbGxiYWNrKFxuICAgICAgKGRpc3RhbmNlKSA9PiB7XG4gICAgICAgIHZhciBfYTI7XG4gICAgICAgIChfYTIgPSBjYW1lcmFSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5kb2xseShkaXN0YW5jZSwgYW5pbWF0ZWQpO1xuICAgICAgfSxcbiAgICAgIFthbmltYXRlZF1cbiAgICApO1xuICAgIGNvbnN0IHBhblJpZ2h0ID0gdXNlQ2FsbGJhY2soXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgdmFyIF9hMjtcbiAgICAgICAgaWYgKCFpc09yYml0aW5nKSB7XG4gICAgICAgICAgKF9hMiA9IGNhbWVyYVJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EyLnRydWNrKC0wLjAzICogZXZlbnQuZGVsdGFUaW1lLCAwLCBhbmltYXRlZCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBbYW5pbWF0ZWQsIGlzT3JiaXRpbmddXG4gICAgKTtcbiAgICBjb25zdCBwYW5MZWZ0ID0gdXNlQ2FsbGJhY2soXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgdmFyIF9hMjtcbiAgICAgICAgaWYgKCFpc09yYml0aW5nKSB7XG4gICAgICAgICAgKF9hMiA9IGNhbWVyYVJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EyLnRydWNrKDAuMDMgKiBldmVudC5kZWx0YVRpbWUsIDAsIGFuaW1hdGVkKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIFthbmltYXRlZCwgaXNPcmJpdGluZ11cbiAgICApO1xuICAgIGNvbnN0IHBhblVwID0gdXNlQ2FsbGJhY2soXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgdmFyIF9hMjtcbiAgICAgICAgaWYgKCFpc09yYml0aW5nKSB7XG4gICAgICAgICAgKF9hMiA9IGNhbWVyYVJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EyLnRydWNrKDAsIDAuMDMgKiBldmVudC5kZWx0YVRpbWUsIGFuaW1hdGVkKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIFthbmltYXRlZCwgaXNPcmJpdGluZ11cbiAgICApO1xuICAgIGNvbnN0IHBhbkRvd24gPSB1c2VDYWxsYmFjayhcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICB2YXIgX2EyO1xuICAgICAgICBpZiAoIWlzT3JiaXRpbmcpIHtcbiAgICAgICAgICAoX2EyID0gY2FtZXJhUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTIudHJ1Y2soMCwgLTAuMDMgKiBldmVudC5kZWx0YVRpbWUsIGFuaW1hdGVkKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIFthbmltYXRlZCwgaXNPcmJpdGluZ11cbiAgICApO1xuICAgIGNvbnN0IG9uS2V5RG93biA9IHVzZUNhbGxiYWNrKFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChldmVudC5jb2RlID09PSBcIlNwYWNlXCIpIHtcbiAgICAgICAgICBpZiAobW9kZSA9PT0gXCJyb3RhdGVcIikge1xuICAgICAgICAgICAgY2FtZXJhUmVmLmN1cnJlbnQubW91c2VCdXR0b25zLmxlZnQgPSBUaHJlZUNhbWVyYUNvbnRyb2xzLkFDVElPTi5UUlVDSztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FtZXJhUmVmLmN1cnJlbnQubW91c2VCdXR0b25zLmxlZnQgPSBUaHJlZUNhbWVyYUNvbnRyb2xzLkFDVElPTi5ST1RBVEU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgW21vZGVdXG4gICAgKTtcbiAgICBjb25zdCBvbktleVVwID0gdXNlQ2FsbGJhY2soXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09IFwiU3BhY2VcIikge1xuICAgICAgICAgIGlmIChtb2RlID09PSBcInJvdGF0ZVwiKSB7XG4gICAgICAgICAgICBjYW1lcmFSZWYuY3VycmVudC5tb3VzZUJ1dHRvbnMubGVmdCA9IFRocmVlQ2FtZXJhQ29udHJvbHMuQUNUSU9OLlJPVEFURTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FtZXJhUmVmLmN1cnJlbnQubW91c2VCdXR0b25zLmxlZnQgPSBUaHJlZUNhbWVyYUNvbnRyb2xzLkFDVElPTi5UUlVDSztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBbbW9kZV1cbiAgICApO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICBpZiAoIWRpc2FibGVkMikge1xuICAgICAgICBsZWZ0S2V5LmFkZEV2ZW50TGlzdGVuZXIoXCJob2xkaW5nXCIsIHBhbkxlZnQpO1xuICAgICAgICByaWdodEtleS5hZGRFdmVudExpc3RlbmVyKFwiaG9sZGluZ1wiLCBwYW5SaWdodCk7XG4gICAgICAgIHVwS2V5LmFkZEV2ZW50TGlzdGVuZXIoXCJob2xkaW5nXCIsIHBhblVwKTtcbiAgICAgICAgZG93bktleS5hZGRFdmVudExpc3RlbmVyKFwiaG9sZGluZ1wiLCBwYW5Eb3duKTtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIG9uS2V5VXApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBsZWZ0S2V5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJob2xkaW5nXCIsIHBhbkxlZnQpO1xuICAgICAgICByaWdodEtleS5yZW1vdmVFdmVudExpc3RlbmVyKFwiaG9sZGluZ1wiLCBwYW5SaWdodCk7XG4gICAgICAgIHVwS2V5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJob2xkaW5nXCIsIHBhblVwKTtcbiAgICAgICAgZG93bktleS5yZW1vdmVFdmVudExpc3RlbmVyKFwiaG9sZGluZ1wiLCBwYW5Eb3duKTtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIG9uS2V5VXApO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sIFtkaXNhYmxlZDIsIG9uS2V5RG93biwgb25LZXlVcCwgcGFuRG93biwgcGFuTGVmdCwgcGFuUmlnaHQsIHBhblVwXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmIChkaXNhYmxlZDIpIHtcbiAgICAgICAgY2FtZXJhUmVmLmN1cnJlbnQubW91c2VCdXR0b25zLmxlZnQgPSBUaHJlZUNhbWVyYUNvbnRyb2xzLkFDVElPTi5OT05FO1xuICAgICAgICBjYW1lcmFSZWYuY3VycmVudC5tb3VzZUJ1dHRvbnMubWlkZGxlID0gVGhyZWVDYW1lcmFDb250cm9scy5BQ1RJT04uTk9ORTtcbiAgICAgICAgY2FtZXJhUmVmLmN1cnJlbnQubW91c2VCdXR0b25zLndoZWVsID0gVGhyZWVDYW1lcmFDb250cm9scy5BQ1RJT04uTk9ORTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbWVyYVJlZi5jdXJyZW50Lm1vdXNlQnV0dG9ucy5sZWZ0ID0gVGhyZWVDYW1lcmFDb250cm9scy5BQ1RJT04uVFJVQ0s7XG4gICAgICAgIGNhbWVyYVJlZi5jdXJyZW50Lm1vdXNlQnV0dG9ucy5taWRkbGUgPSBUaHJlZUNhbWVyYUNvbnRyb2xzLkFDVElPTi5UUlVDSztcbiAgICAgICAgY2FtZXJhUmVmLmN1cnJlbnQubW91c2VCdXR0b25zLndoZWVsID0gVGhyZWVDYW1lcmFDb250cm9scy5BQ1RJT04uRE9MTFk7XG4gICAgICB9XG4gICAgfSwgW2Rpc2FibGVkMl0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICBjb25zdCBvbkNvbnRyb2wgPSAoKSA9PiBzZXRQYW5uaW5nKHRydWUpO1xuICAgICAgY29uc3Qgb25Db250cm9sRW5kID0gKCkgPT4gc2V0UGFubmluZyhmYWxzZSk7XG4gICAgICBjb25zdCByZWYyID0gY2FtZXJhUmVmLmN1cnJlbnQ7XG4gICAgICBpZiAocmVmMikge1xuICAgICAgICByZWYyLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250cm9sXCIsIG9uQ29udHJvbCk7XG4gICAgICAgIHJlZjIuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRyb2xlbmRcIiwgb25Db250cm9sRW5kKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChyZWYyKSB7XG4gICAgICAgICAgcmVmMi5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udHJvbFwiLCBvbkNvbnRyb2wpO1xuICAgICAgICAgIHJlZjIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRyb2xlbmRcIiwgb25Db250cm9sRW5kKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LCBbY2FtZXJhUmVmLCBzZXRQYW5uaW5nXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmIChpc0RyYWdnaW5nKSB7XG4gICAgICAgIGNhbWVyYVJlZi5jdXJyZW50Lm1vdXNlQnV0dG9ucy5sZWZ0ID0gVGhyZWVDYW1lcmFDb250cm9scy5BQ1RJT04uTk9ORTtcbiAgICAgICAgY2FtZXJhUmVmLmN1cnJlbnQudG91Y2hlcy5vbmUgPSBUaHJlZUNhbWVyYUNvbnRyb2xzLkFDVElPTi5OT05FO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKG1vZGUgPT09IFwicm90YXRlXCIpIHtcbiAgICAgICAgICBjYW1lcmFSZWYuY3VycmVudC5tb3VzZUJ1dHRvbnMubGVmdCA9IFRocmVlQ2FtZXJhQ29udHJvbHMuQUNUSU9OLlJPVEFURTtcbiAgICAgICAgICBjYW1lcmFSZWYuY3VycmVudC50b3VjaGVzLm9uZSA9IFRocmVlQ2FtZXJhQ29udHJvbHMuQUNUSU9OLlRPVUNIX1JPVEFURTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjYW1lcmFSZWYuY3VycmVudC50b3VjaGVzLm9uZSA9IFRocmVlQ2FtZXJhQ29udHJvbHMuQUNUSU9OLlRPVUNIX1RSVUNLO1xuICAgICAgICAgIGNhbWVyYVJlZi5jdXJyZW50Lm1vdXNlQnV0dG9ucy5sZWZ0ID0gVGhyZWVDYW1lcmFDb250cm9scy5BQ1RJT04uVFJVQ0s7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBbaXNEcmFnZ2luZywgbW9kZV0pO1xuICAgIHVzZUhvdGtleXMoW1xuICAgICAge1xuICAgICAgICBuYW1lOiBcIlpvb20gSW5cIixcbiAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgICAgICAgY2F0ZWdvcnk6IFwiR3JhcGhcIixcbiAgICAgICAga2V5czogXCJjb21tYW5kK3NoaWZ0K2lcIixcbiAgICAgICAgY2FsbGJhY2s6IChldmVudCkgPT4ge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgem9vbUluKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6IFwiWm9vbSBPdXRcIixcbiAgICAgICAgY2F0ZWdvcnk6IFwiR3JhcGhcIixcbiAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgICAgICAga2V5czogXCJjb21tYW5kK3NoaWZ0K29cIixcbiAgICAgICAgY2FsbGJhY2s6IChldmVudCkgPT4ge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgem9vbU91dCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgXSk7XG4gICAgY29uc3QgdmFsdWVzID0gdXNlTWVtbyhcbiAgICAgICgpID0+ICh7XG4gICAgICAgIGNvbnRyb2xzOiBjYW1lcmFSZWYuY3VycmVudCxcbiAgICAgICAgem9vbUluOiAoKSA9PiB6b29tSW4oKSxcbiAgICAgICAgem9vbU91dDogKCkgPT4gem9vbU91dCgpLFxuICAgICAgICBkb2xseUluOiAoZGlzdGFuY2UgPSAxZTMpID0+IGRvbGx5SW4oZGlzdGFuY2UpLFxuICAgICAgICBkb2xseU91dDogKGRpc3RhbmNlID0gLTFlMykgPT4gZG9sbHlPdXQoZGlzdGFuY2UpLFxuICAgICAgICBwYW5MZWZ0OiAoZGVsdGFUaW1lID0gMTAwKSA9PiBwYW5MZWZ0KHsgZGVsdGFUaW1lIH0pLFxuICAgICAgICBwYW5SaWdodDogKGRlbHRhVGltZSA9IDEwMCkgPT4gcGFuUmlnaHQoeyBkZWx0YVRpbWUgfSksXG4gICAgICAgIHBhbkRvd246IChkZWx0YVRpbWUgPSAxMDApID0+IHBhbkRvd24oeyBkZWx0YVRpbWUgfSksXG4gICAgICAgIHBhblVwOiAoZGVsdGFUaW1lID0gMTAwKSA9PiBwYW5VcCh7IGRlbHRhVGltZSB9KSxcbiAgICAgICAgcmVzZXRDb250cm9sczogKGFuaW1hdGVkMikgPT4ge1xuICAgICAgICAgIHZhciBfYTI7XG4gICAgICAgICAgcmV0dXJuIChfYTIgPSBjYW1lcmFSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5yZXNldChhbmltYXRlZDIpO1xuICAgICAgICB9LFxuICAgICAgICBmcmVlemU6ICgpID0+IHtcbiAgICAgICAgICBpZiAoY2FtZXJhUmVmLmN1cnJlbnQudHJ1Y2tTcGVlZCkge1xuICAgICAgICAgICAgY2FtZXJhU3BlZWRSZWYuY3VycmVudCA9IGNhbWVyYVJlZi5jdXJyZW50LnRydWNrU3BlZWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhbWVyYVJlZi5jdXJyZW50LnRydWNrU3BlZWQgPSAwO1xuICAgICAgICB9LFxuICAgICAgICB1bkZyZWV6ZTogKCkgPT4gY2FtZXJhUmVmLmN1cnJlbnQudHJ1Y2tTcGVlZCA9IGNhbWVyYVNwZWVkUmVmLmN1cnJlbnRcbiAgICAgIH0pLFxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICBbem9vbUluLCB6b29tT3V0LCBwYW5MZWZ0LCBwYW5SaWdodCwgcGFuRG93biwgcGFuVXAsIGNhbWVyYVJlZi5jdXJyZW50XVxuICAgICk7XG4gICAgdXNlSW1wZXJhdGl2ZUhhbmRsZShyZWYsICgpID0+IHZhbHVlcyk7XG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzKENhbWVyYUNvbnRyb2xzQ29udGV4dC5Qcm92aWRlciwgeyB2YWx1ZTogdmFsdWVzLCBjaGlsZHJlbjogW1xuICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgXCJ0aHJlZUNhbWVyYUNvbnRyb2xzXCIsXG4gICAgICAgIHtcbiAgICAgICAgICByZWY6IGNhbWVyYVJlZixcbiAgICAgICAgICBhcmdzOiBbY2FtZXJhLCBnbC5kb21FbGVtZW50XSxcbiAgICAgICAgICBzbW9vdGhUaW1lOiAwLjEsXG4gICAgICAgICAgbWluRGlzdGFuY2UsXG4gICAgICAgICAgZG9sbHlUb0N1cnNvcjogdHJ1ZSxcbiAgICAgICAgICBtYXhEaXN0YW5jZVxuICAgICAgICB9XG4gICAgICApLFxuICAgICAgY2hpbGRyZW5cbiAgICBdIH0pO1xuICB9XG4pO1xuZnVuY3Rpb24gdmlzaWJsZUhlaWdodEF0WkRlcHRoKGRlcHRoLCBjYW1lcmEpIHtcbiAgY29uc3QgY2FtZXJhT2Zmc2V0ID0gY2FtZXJhLnBvc2l0aW9uLno7XG4gIGlmIChkZXB0aCA8IGNhbWVyYU9mZnNldClcbiAgICBkZXB0aCAtPSBjYW1lcmFPZmZzZXQ7XG4gIGVsc2VcbiAgICBkZXB0aCArPSBjYW1lcmFPZmZzZXQ7XG4gIGNvbnN0IHZGT1YgPSBjYW1lcmEuZm92IC8gY2FtZXJhLnpvb20gKiBNYXRoLlBJIC8gMTgwO1xuICByZXR1cm4gMiAqIE1hdGgudGFuKHZGT1YgLyAyKSAqIE1hdGguYWJzKGRlcHRoKTtcbn1cbmZ1bmN0aW9uIHZpc2libGVXaWR0aEF0WkRlcHRoKGRlcHRoLCBjYW1lcmEpIHtcbiAgY29uc3QgaGVpZ2h0ID0gdmlzaWJsZUhlaWdodEF0WkRlcHRoKGRlcHRoLCBjYW1lcmEpO1xuICByZXR1cm4gaGVpZ2h0ICogY2FtZXJhLmFzcGVjdDtcbn1cbmZ1bmN0aW9uIGlzTm9kZUluVmlldyhjYW1lcmEsIG5vZGVQb3NpdGlvbikge1xuICB2YXIgX2EyLCBfYjIsIF9jLCBfZDtcbiAgY29uc3QgdmlzaWJsZVdpZHRoID0gdmlzaWJsZVdpZHRoQXRaRGVwdGgoMSwgY2FtZXJhKTtcbiAgY29uc3QgdmlzaWJsZUhlaWdodCA9IHZpc2libGVIZWlnaHRBdFpEZXB0aCgxLCBjYW1lcmEpO1xuICBjb25zdCB2aXNpYmxlQXJlYSA9IHtcbiAgICB4MDogKChfYTIgPSBjYW1lcmEgPT0gbnVsbCA/IHZvaWQgMCA6IGNhbWVyYS5wb3NpdGlvbikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi54KSAtIHZpc2libGVXaWR0aCAvIDIsXG4gICAgeDE6ICgoX2IyID0gY2FtZXJhID09IG51bGwgPyB2b2lkIDAgOiBjYW1lcmEucG9zaXRpb24pID09IG51bGwgPyB2b2lkIDAgOiBfYjIueCkgKyB2aXNpYmxlV2lkdGggLyAyLFxuICAgIHkwOiAoKF9jID0gY2FtZXJhID09IG51bGwgPyB2b2lkIDAgOiBjYW1lcmEucG9zaXRpb24pID09IG51bGwgPyB2b2lkIDAgOiBfYy55KSAtIHZpc2libGVIZWlnaHQgLyAyLFxuICAgIHkxOiAoKF9kID0gY2FtZXJhID09IG51bGwgPyB2b2lkIDAgOiBjYW1lcmEucG9zaXRpb24pID09IG51bGwgPyB2b2lkIDAgOiBfZC55KSArIHZpc2libGVIZWlnaHQgLyAyXG4gIH07XG4gIHJldHVybiAobm9kZVBvc2l0aW9uID09IG51bGwgPyB2b2lkIDAgOiBub2RlUG9zaXRpb24ueCkgPiB2aXNpYmxlQXJlYS54MCAmJiAobm9kZVBvc2l0aW9uID09IG51bGwgPyB2b2lkIDAgOiBub2RlUG9zaXRpb24ueCkgPCB2aXNpYmxlQXJlYS54MSAmJiAobm9kZVBvc2l0aW9uID09IG51bGwgPyB2b2lkIDAgOiBub2RlUG9zaXRpb24ueSkgPiB2aXNpYmxlQXJlYS55MCAmJiAobm9kZVBvc2l0aW9uID09IG51bGwgPyB2b2lkIDAgOiBub2RlUG9zaXRpb24ueSkgPCB2aXNpYmxlQXJlYS55MTtcbn1cbmZ1bmN0aW9uIGdldENsb3Nlc3RBeGlzKGFuZ2xlLCBheGVzKSB7XG4gIHJldHVybiBheGVzLnJlZHVjZShcbiAgICAocHJldiwgY3VycikgPT4gTWF0aC5hYnMoY3VyciAtIGFuZ2xlICUgTWF0aC5QSSkgPCBNYXRoLmFicyhwcmV2IC0gYW5nbGUgJSBNYXRoLlBJKSA/IGN1cnIgOiBwcmV2XG4gICk7XG59XG5mdW5jdGlvbiBnZXREZWdyZWVzVG9DbG9zZXN0MmRBeGlzKGhvcml6b250YWxBbmdsZSwgdmVydGljYWxBbmdsZSkge1xuICBjb25zdCBjbG9zZXN0SG9yaXpvbnRhbEF4aXMgPSBnZXRDbG9zZXN0QXhpcyhob3Jpem9udGFsQW5nbGUsIFswLCBNYXRoLlBJXSk7XG4gIGNvbnN0IGNsb3Nlc3RWZXJ0aWNhbEF4aXMgPSBnZXRDbG9zZXN0QXhpcyh2ZXJ0aWNhbEFuZ2xlLCBbXG4gICAgTWF0aC5QSSAvIDIsXG4gICAgMyAqIE1hdGguUEkgLyAyXG4gIF0pO1xuICByZXR1cm4ge1xuICAgIGhvcml6b250YWxSb3RhdGlvbjogY2xvc2VzdEhvcml6b250YWxBeGlzIC0gaG9yaXpvbnRhbEFuZ2xlICUgTWF0aC5QSSxcbiAgICB2ZXJ0aWNhbFJvdGF0aW9uOiBjbG9zZXN0VmVydGljYWxBeGlzIC0gdmVydGljYWxBbmdsZSAlIE1hdGguUElcbiAgfTtcbn1cbmNvbnN0IFBBRERJTkcgPSA1MDtcbmNvbnN0IHVzZUNlbnRlckdyYXBoID0gKHtcbiAgYW5pbWF0ZWQsXG4gIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gIGxheW91dFR5cGVcbn0pID0+IHtcbiAgY29uc3Qgbm9kZXMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLm5vZGVzKTtcbiAgY29uc3QgW2lzQ2VudGVyZWQsIHNldElzQ2VudGVyZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBpbnZhbGlkYXRlID0gdXNlVGhyZWUoKHN0YXRlKSA9PiBzdGF0ZS5pbnZhbGlkYXRlKTtcbiAgY29uc3QgeyBjb250cm9scyB9ID0gdXNlQ2FtZXJhQ29udHJvbHMoKTtcbiAgY29uc3QgY2FtZXJhID0gdXNlVGhyZWUoKHN0YXRlKSA9PiBzdGF0ZS5jYW1lcmEpO1xuICBjb25zdCBtb3VudGVkID0gdXNlUmVmKGZhbHNlKTtcbiAgY29uc3QgY2VudGVyTm9kZXMgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAobm9kZXMyLCBvcHRzKSA9PiB7XG4gICAgICBjb25zdCBhbmltYXRlZDIgPSAob3B0cyA9PSBudWxsID8gdm9pZCAwIDogb3B0cy5hbmltYXRlZCkgIT09IHZvaWQgMCA/IG9wdHMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdHMuYW5pbWF0ZWQgOiB0cnVlO1xuICAgICAgY29uc3QgY2VudGVyT25seUlmTm9kZXNOb3RJblZpZXcgPSAob3B0cyA9PSBudWxsID8gdm9pZCAwIDogb3B0cy5jZW50ZXJPbmx5SWZOb2Rlc05vdEluVmlldykgIT09IHZvaWQgMCA/IG9wdHMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdHMuY2VudGVyT25seUlmTm9kZXNOb3RJblZpZXcgOiBmYWxzZTtcbiAgICAgIGlmICghbW91bnRlZC5jdXJyZW50IHx8ICFjZW50ZXJPbmx5SWZOb2Rlc05vdEluVmlldyB8fCBjZW50ZXJPbmx5SWZOb2Rlc05vdEluVmlldyAmJiAobm9kZXMyID09IG51bGwgPyB2b2lkIDAgOiBub2RlczIuc29tZSgobm9kZSkgPT4gIWlzTm9kZUluVmlldyhjYW1lcmEsIG5vZGUucG9zaXRpb24pKSkpIHtcbiAgICAgICAgY29uc3QgeyB4LCB5LCB6IH0gPSBnZXRMYXlvdXRDZW50ZXIobm9kZXMyKTtcbiAgICAgICAgYXdhaXQgY29udHJvbHMuc2V0VGFyZ2V0KHgsIHksIHosIGFuaW1hdGVkMik7XG4gICAgICAgIGlmICghaXNDZW50ZXJlZCkge1xuICAgICAgICAgIHNldElzQ2VudGVyZWQodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaW52YWxpZGF0ZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICAgIFtpbnZhbGlkYXRlLCBjb250cm9scywgbm9kZXNdXG4gICk7XG4gIGNvbnN0IGZpdE5vZGVzSW5WaWV3ID0gdXNlQ2FsbGJhY2soXG4gICAgYXN5bmMgKG5vZGVzMiwgb3B0cyA9IHsgYW5pbWF0ZWQ6IHRydWUsIGZpdE9ubHlJZk5vZGVzTm90SW5WaWV3OiBmYWxzZSB9KSA9PiB7XG4gICAgICBjb25zdCB7IGZpdE9ubHlJZk5vZGVzTm90SW5WaWV3IH0gPSBvcHRzO1xuICAgICAgaWYgKCFmaXRPbmx5SWZOb2Rlc05vdEluVmlldyB8fCBmaXRPbmx5SWZOb2Rlc05vdEluVmlldyAmJiAobm9kZXMyID09IG51bGwgPyB2b2lkIDAgOiBub2RlczIuc29tZSgobm9kZSkgPT4gIWlzTm9kZUluVmlldyhjYW1lcmEsIG5vZGUucG9zaXRpb24pKSkpIHtcbiAgICAgICAgY29uc3QgeyBtaW5YLCBtYXhYLCBtaW5ZLCBtYXhZLCBtaW5aLCBtYXhaIH0gPSBnZXRMYXlvdXRDZW50ZXIobm9kZXMyKTtcbiAgICAgICAgaWYgKCFsYXlvdXRUeXBlLmluY2x1ZGVzKFwiM2RcIikpIHtcbiAgICAgICAgICBjb25zdCB7IGhvcml6b250YWxSb3RhdGlvbiwgdmVydGljYWxSb3RhdGlvbiB9ID0gZ2V0RGVncmVlc1RvQ2xvc2VzdDJkQXhpcyhcbiAgICAgICAgICAgIGNvbnRyb2xzID09IG51bGwgPyB2b2lkIDAgOiBjb250cm9scy5hemltdXRoQW5nbGUsXG4gICAgICAgICAgICBjb250cm9scyA9PSBudWxsID8gdm9pZCAwIDogY29udHJvbHMucG9sYXJBbmdsZVxuICAgICAgICAgICk7XG4gICAgICAgICAgdm9pZCAoY29udHJvbHMgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbnRyb2xzLnJvdGF0ZShob3Jpem9udGFsUm90YXRpb24sIHZlcnRpY2FsUm90YXRpb24sIHRydWUpKTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCAoY29udHJvbHMgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbnRyb2xzLnpvb21UbygxLCBvcHRzID09IG51bGwgPyB2b2lkIDAgOiBvcHRzLmFuaW1hdGVkKSk7XG4gICAgICAgIGF3YWl0IChjb250cm9scyA9PSBudWxsID8gdm9pZCAwIDogY29udHJvbHMuZml0VG9Cb3goXG4gICAgICAgICAgbmV3IEJveDMoXG4gICAgICAgICAgICBuZXcgVmVjdG9yMyhtaW5YLCBtaW5ZLCBtaW5aKSxcbiAgICAgICAgICAgIG5ldyBWZWN0b3IzKG1heFgsIG1heFksIG1heFopXG4gICAgICAgICAgKSxcbiAgICAgICAgICBvcHRzID09IG51bGwgPyB2b2lkIDAgOiBvcHRzLmFuaW1hdGVkLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvdmVyOiBmYWxzZSxcbiAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiBQQURESU5HLFxuICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBQQURESU5HLFxuICAgICAgICAgICAgcGFkZGluZ0JvdHRvbTogUEFERElORyxcbiAgICAgICAgICAgIHBhZGRpbmdUb3A6IFBBRERJTkdcbiAgICAgICAgICB9XG4gICAgICAgICkpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2NhbWVyYSwgY29udHJvbHMsIGxheW91dFR5cGVdXG4gICk7XG4gIGNvbnN0IGdldE5vZGVzQnlJZCA9IHVzZUNhbGxiYWNrKFxuICAgIChub2RlSWRzKSA9PiB7XG4gICAgICBsZXQgbWFwcGVkTm9kZXMgPSBudWxsO1xuICAgICAgaWYgKG5vZGVJZHMgPT0gbnVsbCA/IHZvaWQgMCA6IG5vZGVJZHMubGVuZ3RoKSB7XG4gICAgICAgIG1hcHBlZE5vZGVzID0gbm9kZUlkcy5yZWR1Y2UoKGFjYywgaWQpID0+IHtcbiAgICAgICAgICBjb25zdCBub2RlID0gbm9kZXMuZmluZCgobikgPT4gbi5pZCA9PT0gaWQpO1xuICAgICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgICBhY2MucHVzaChub2RlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICBgQXR0ZW1wdGVkIHRvIGNlbnRlciAke2lkfSBidXQgaXQgd2FzIG5vdCBmb3VuZCBpbiB0aGUgbm9kZXNgXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCBbXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWFwcGVkTm9kZXM7XG4gICAgfSxcbiAgICBbbm9kZXNdXG4gICk7XG4gIGNvbnN0IGNlbnRlck5vZGVzQnlJZCA9IHVzZUNhbGxiYWNrKFxuICAgIChub2RlSWRzLCBvcHRzKSA9PiB7XG4gICAgICBjb25zdCBtYXBwZWROb2RlcyA9IGdldE5vZGVzQnlJZChub2RlSWRzKTtcbiAgICAgIGNlbnRlck5vZGVzKG1hcHBlZE5vZGVzIHx8IG5vZGVzLCB7XG4gICAgICAgIGFuaW1hdGVkLFxuICAgICAgICBjZW50ZXJPbmx5SWZOb2Rlc05vdEluVmlldzogb3B0cyA9PSBudWxsID8gdm9pZCAwIDogb3B0cy5jZW50ZXJPbmx5SWZOb2Rlc05vdEluVmlld1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBbYW5pbWF0ZWQsIGNlbnRlck5vZGVzLCBnZXROb2Rlc0J5SWQsIG5vZGVzXVxuICApO1xuICBjb25zdCBmaXROb2Rlc0luVmlld0J5SWQgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAobm9kZUlkcywgb3B0cykgPT4ge1xuICAgICAgY29uc3QgbWFwcGVkTm9kZXMgPSBnZXROb2Rlc0J5SWQobm9kZUlkcyk7XG4gICAgICBhd2FpdCBmaXROb2Rlc0luVmlldyhtYXBwZWROb2RlcyB8fCBub2RlcywgeyBhbmltYXRlZCwgLi4ub3B0cyB9KTtcbiAgICB9LFxuICAgIFthbmltYXRlZCwgZml0Tm9kZXNJblZpZXcsIGdldE5vZGVzQnlJZCwgbm9kZXNdXG4gICk7XG4gIHVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgYXN5bmMgZnVuY3Rpb24gbG9hZCgpIHtcbiAgICAgIGlmIChjb250cm9scyAmJiAobm9kZXMgPT0gbnVsbCA/IHZvaWQgMCA6IG5vZGVzLmxlbmd0aCkpIHtcbiAgICAgICAgaWYgKCFtb3VudGVkLmN1cnJlbnQpIHtcbiAgICAgICAgICBhd2FpdCBjZW50ZXJOb2Rlcyhub2RlcywgeyBhbmltYXRlZDogZmFsc2UgfSk7XG4gICAgICAgICAgYXdhaXQgZml0Tm9kZXNJblZpZXcobm9kZXMsIHsgYW5pbWF0ZWQ6IGZhbHNlIH0pO1xuICAgICAgICAgIG1vdW50ZWQuY3VycmVudCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgbG9hZCgpO1xuICB9LCBbY29udHJvbHMsIGNlbnRlck5vZGVzLCBub2RlcywgYW5pbWF0ZWQsIGNhbWVyYSwgZml0Tm9kZXNJblZpZXddKTtcbiAgdXNlSG90a2V5cyhbXG4gICAge1xuICAgICAgbmFtZTogXCJDZW50ZXJcIixcbiAgICAgIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gICAgICBjYXRlZ29yeTogXCJHcmFwaFwiLFxuICAgICAga2V5czogW1wiY29tbWFuZCtzaGlmdCtjXCJdLFxuICAgICAgY2FsbGJhY2s6ICgpID0+IGNlbnRlck5vZGVzKG5vZGVzKVxuICAgIH1cbiAgXSk7XG4gIHJldHVybiB7IGNlbnRlck5vZGVzLCBjZW50ZXJOb2Rlc0J5SWQsIGZpdE5vZGVzSW5WaWV3QnlJZCwgaXNDZW50ZXJlZCB9O1xufTtcbmNvbnN0IEljb24gPSAoe1xuICBpbWFnZSxcbiAgaWQsXG4gIHNpemUsXG4gIG9wYWNpdHkgPSAxLFxuICBhbmltYXRlZFxufSkgPT4ge1xuICBjb25zdCB0ZXh0dXJlID0gdXNlTWVtbygoKSA9PiBuZXcgVGV4dHVyZUxvYWRlcigpLmxvYWQoaW1hZ2UpLCBbaW1hZ2VdKTtcbiAgY29uc3QgeyBzY2FsZSwgc3ByaXRlT3BhY2l0eSB9ID0gdXNlU3ByaW5nKHtcbiAgICBmcm9tOiB7XG4gICAgICBzY2FsZTogWzFlLTUsIDFlLTUsIDFlLTVdLFxuICAgICAgc3ByaXRlT3BhY2l0eTogMFxuICAgIH0sXG4gICAgdG86IHtcbiAgICAgIHNjYWxlOiBbc2l6ZSwgc2l6ZSwgc2l6ZV0sXG4gICAgICBzcHJpdGVPcGFjaXR5OiBvcGFjaXR5XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIC4uLmFuaW1hdGlvbkNvbmZpZyxcbiAgICAgIGR1cmF0aW9uOiBhbmltYXRlZCA/IHZvaWQgMCA6IDBcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChhLnNwcml0ZSwgeyB1c2VyRGF0YTogeyBpZCwgdHlwZTogXCJub2RlXCIgfSwgc2NhbGUsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgIGEuc3ByaXRlTWF0ZXJpYWwsXG4gICAge1xuICAgICAgYXR0YWNoOiBcIm1hdGVyaWFsXCIsXG4gICAgICBvcGFjaXR5OiBzcHJpdGVPcGFjaXR5LFxuICAgICAgZm9nOiB0cnVlLFxuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxuICAgICAgc2lkZTogRG91YmxlU2lkZSxcbiAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFwicHJpbWl0aXZlXCIsIHsgYXR0YWNoOiBcIm1hcFwiLCBvYmplY3Q6IHRleHR1cmUsIG1pbkZpbHRlcjogTGluZWFyRmlsdGVyIH0pXG4gICAgfVxuICApIH0pO1xufTtcbmNvbnN0IFNwaGVyZVdpdGhJY29uID0gKHtcbiAgY29sb3IsXG4gIGlkLFxuICBzaXplLFxuICBvcGFjaXR5ID0gMSxcbiAgbm9kZSxcbiAgYWN0aXZlID0gZmFsc2UsXG4gIGFuaW1hdGVkLFxuICBpbWFnZSxcbiAgc2VsZWN0ZWRcbn0pID0+IC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgU3BoZXJlLFxuICAgIHtcbiAgICAgIGlkLFxuICAgICAgc2VsZWN0ZWQsXG4gICAgICBzaXplLFxuICAgICAgb3BhY2l0eSxcbiAgICAgIGFuaW1hdGVkLFxuICAgICAgY29sb3IsXG4gICAgICBub2RlLFxuICAgICAgYWN0aXZlXG4gICAgfVxuICApLFxuICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgIEljb24sXG4gICAge1xuICAgICAgaWQsXG4gICAgICBpbWFnZSxcbiAgICAgIHNlbGVjdGVkLFxuICAgICAgc2l6ZTogc2l6ZSArIDgsXG4gICAgICBvcGFjaXR5LFxuICAgICAgYW5pbWF0ZWQsXG4gICAgICBjb2xvcixcbiAgICAgIG5vZGUsXG4gICAgICBhY3RpdmVcbiAgICB9XG4gIClcbl0gfSk7XG5jb25zdCBTdmcgPSAoe1xuICBpZCxcbiAgaW1hZ2UsXG4gIGNvbG9yLFxuICBzaXplLFxuICBvcGFjaXR5ID0gMSxcbiAgYW5pbWF0ZWQsXG4gIC4uLnJlc3Rcbn0pID0+IHtcbiAgY29uc3Qgbm9ybWFsaXplZFNpemUgPSBzaXplIC8gMjU7XG4gIGNvbnN0IHsgc2NhbGUgfSA9IHVzZVNwcmluZyh7XG4gICAgZnJvbToge1xuICAgICAgc2NhbGU6IFsxZS01LCAxZS01LCAxZS01XVxuICAgIH0sXG4gICAgdG86IHtcbiAgICAgIHNjYWxlOiBbbm9ybWFsaXplZFNpemUsIG5vcm1hbGl6ZWRTaXplLCBub3JtYWxpemVkU2l6ZV1cbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgLi4uYW5pbWF0aW9uQ29uZmlnLFxuICAgICAgZHVyYXRpb246IGFuaW1hdGVkID8gdm9pZCAwIDogMFxuICAgIH1cbiAgfSk7XG4gIGNvbnN0IG5vcm1hbGl6ZWRDb2xvciA9IHVzZU1lbW8oKCkgPT4gbmV3IENvbG9yKGNvbG9yKSwgW2NvbG9yXSk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KGEuZ3JvdXAsIHsgdXNlckRhdGE6IHsgaWQsIHR5cGU6IFwibm9kZVwiIH0sIHNjYWxlLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChCaWxsYm9hcmQsIHsgcG9zaXRpb246IFswLCAwLCAxXSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgU3ZnJDEsXG4gICAge1xuICAgICAgLi4ucmVzdCxcbiAgICAgIHNyYzogaW1hZ2UsXG4gICAgICBmaWxsTWF0ZXJpYWw6IHtcbiAgICAgICAgZm9nOiB0cnVlLFxuICAgICAgICBkZXB0aFRlc3Q6IGZhbHNlLFxuICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgICAgY29sb3I6IG5vcm1hbGl6ZWRDb2xvcixcbiAgICAgICAgb3BhY2l0eSxcbiAgICAgICAgc2lkZTogRG91YmxlU2lkZSxcbiAgICAgICAgLi4ucmVzdC5maWxsTWF0ZXJpYWwgfHwge31cbiAgICAgIH0sXG4gICAgICBmaWxsTWVzaFByb3BzOiB7XG4gICAgICAgIC8vIE5vdGU6IFRoaXMgaXMgYSBoYWNrIHRvIGdldCB0aGUgc3ZnIHRvXG4gICAgICAgIC8vIHJlbmRlciBpbiB0aGUgY29ycmVjdCBwb3NpdGlvbi5cbiAgICAgICAgcG9zaXRpb246IFstMjUsIC0yNSwgMV0sXG4gICAgICAgIC4uLnJlc3QuZmlsbE1lc2hQcm9wcyB8fCB7fVxuICAgICAgfVxuICAgIH1cbiAgKSB9KSB9KTtcbn07XG5jb25zdCBTcGhlcmVXaXRoU3ZnID0gKHtcbiAgY29sb3IsXG4gIGlkLFxuICBzaXplLFxuICBvcGFjaXR5ID0gMSxcbiAgbm9kZSxcbiAgc3ZnRmlsbCxcbiAgYWN0aXZlID0gZmFsc2UsXG4gIGFuaW1hdGVkLFxuICBpbWFnZSxcbiAgc2VsZWN0ZWQsXG4gIC4uLnJlc3Rcbn0pID0+IC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgU3BoZXJlLFxuICAgIHtcbiAgICAgIGlkLFxuICAgICAgc2VsZWN0ZWQsXG4gICAgICBzaXplLFxuICAgICAgb3BhY2l0eSxcbiAgICAgIGFuaW1hdGVkLFxuICAgICAgY29sb3IsXG4gICAgICBub2RlLFxuICAgICAgYWN0aXZlXG4gICAgfVxuICApLFxuICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgIFN2ZyxcbiAgICB7XG4gICAgICAuLi5yZXN0LFxuICAgICAgaWQsXG4gICAgICBzZWxlY3RlZCxcbiAgICAgIGltYWdlLFxuICAgICAgc2l6ZSxcbiAgICAgIG9wYWNpdHksXG4gICAgICBhbmltYXRlZCxcbiAgICAgIGNvbG9yOiBzdmdGaWxsLFxuICAgICAgbm9kZSxcbiAgICAgIGFjdGl2ZVxuICAgIH1cbiAgKVxuXSB9KTtcbmNvbnN0IE5vZGUgPSAoe1xuICBhbmltYXRlZCxcbiAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgaWQsXG4gIGRyYWdnYWJsZSA9IGZhbHNlLFxuICBsYWJlbEZvbnRVcmwsXG4gIGNvbnRleHRNZW51LFxuICBvbkNsaWNrLFxuICBvbkRvdWJsZUNsaWNrLFxuICBvblBvaW50ZXJPdmVyLFxuICBvbkRyYWdnZWQsXG4gIG9uUG9pbnRlck91dCxcbiAgb25Db250ZXh0TWVudSxcbiAgcmVuZGVyTm9kZSxcbiAgY29uc3RyYWluRHJhZ2dpbmdcbn0pID0+IHtcbiAgdmFyIF9hMiwgX2IyLCBfYztcbiAgY29uc3QgY2FtZXJhQ29udHJvbHMgPSB1c2VDYW1lcmFDb250cm9scygpO1xuICBjb25zdCB0aGVtZSA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUudGhlbWUpO1xuICBjb25zdCBub2RlID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5ub2Rlcy5maW5kKChuKSA9PiBuLmlkID09PSBpZCkpO1xuICBjb25zdCBlZGdlcyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuZWRnZXMpO1xuICBjb25zdCBkcmFnZ2luZ0lkcyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuZHJhZ2dpbmdJZHMpO1xuICBjb25zdCBjb2xsYXBzZWROb2RlSWRzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5jb2xsYXBzZWROb2RlSWRzKTtcbiAgY29uc3QgYWRkRHJhZ2dpbmdJZCA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuYWRkRHJhZ2dpbmdJZCk7XG4gIGNvbnN0IHJlbW92ZURyYWdnaW5nSWQgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnJlbW92ZURyYWdnaW5nSWQpO1xuICBjb25zdCBzZXRIb3ZlcmVkTm9kZUlkID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5zZXRIb3ZlcmVkTm9kZUlkKTtcbiAgY29uc3Qgc2V0Tm9kZVBvc2l0aW9uID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5zZXROb2RlUG9zaXRpb24pO1xuICBjb25zdCBzZXRDb2xsYXBzZWROb2RlSWRzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5zZXRDb2xsYXBzZWROb2RlSWRzKTtcbiAgY29uc3QgaXNDb2xsYXBzZWQgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLmNvbGxhcHNlZE5vZGVJZHMuaW5jbHVkZXMoaWQpKTtcbiAgY29uc3QgaXNBY3RpdmUgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHtcbiAgICB2YXIgX2EzO1xuICAgIHJldHVybiAoX2EzID0gc3RhdGUuYWN0aXZlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5pbmNsdWRlcyhpZCk7XG4gIH0pO1xuICBjb25zdCBpc1NlbGVjdGVkID0gdXNlU3RvcmUoKHN0YXRlKSA9PiB7XG4gICAgdmFyIF9hMztcbiAgICByZXR1cm4gKF9hMyA9IHN0YXRlLnNlbGVjdGlvbnMpID09IG51bGwgPyB2b2lkIDAgOiBfYTMuaW5jbHVkZXMoaWQpO1xuICB9KTtcbiAgY29uc3QgaGFzU2VsZWN0aW9ucyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4ge1xuICAgIHZhciBfYTM7XG4gICAgcmV0dXJuICgoX2EzID0gc3RhdGUuc2VsZWN0aW9ucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5sZW5ndGgpID4gMDtcbiAgfSk7XG4gIGNvbnN0IGNlbnRlciA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuY2VudGVyUG9zaXRpb24pO1xuICBjb25zdCBjbHVzdGVyID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5jbHVzdGVycy5nZXQobm9kZS5jbHVzdGVyKSk7XG4gIGNvbnN0IGlzRHJhZ2dpbmdDdXJyZW50ID0gZHJhZ2dpbmdJZHMuaW5jbHVkZXMoaWQpO1xuICBjb25zdCBpc0RyYWdnaW5nID0gZHJhZ2dpbmdJZHMubGVuZ3RoID4gMDtcbiAgY29uc3Qge1xuICAgIHBvc2l0aW9uLFxuICAgIGxhYmVsLFxuICAgIHN1YkxhYmVsLFxuICAgIHNpemU6IG5vZGVTaXplID0gNyxcbiAgICBsYWJlbFZpc2libGUgPSB0cnVlXG4gIH0gPSBub2RlO1xuICBjb25zdCBncm91cCA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgW2FjdGl2ZSwgc2V0QWN0aXZlXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW21lbnVWaXNpYmxlLCBzZXRNZW51VmlzaWJsZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IHNob3VsZEhpZ2hsaWdodCA9IGFjdGl2ZSB8fCBpc1NlbGVjdGVkIHx8IGlzQWN0aXZlO1xuICBjb25zdCBzZWxlY3Rpb25PcGFjaXR5ID0gaGFzU2VsZWN0aW9ucyA/IHNob3VsZEhpZ2hsaWdodCA/IHRoZW1lLm5vZGUuc2VsZWN0ZWRPcGFjaXR5IDogdGhlbWUubm9kZS5pbmFjdGl2ZU9wYWNpdHkgOiB0aGVtZS5ub2RlLm9wYWNpdHk7XG4gIGNvbnN0IGNhbkNvbGxhcHNlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgY29uc3Qgb3V0Ym91bmRMaW5rcyA9IGVkZ2VzLmZpbHRlcigobCkgPT4gbC5zb3VyY2UgPT09IGlkKTtcbiAgICByZXR1cm4gb3V0Ym91bmRMaW5rcy5sZW5ndGggPiAwIHx8IGlzQ29sbGFwc2VkO1xuICB9LCBbZWRnZXMsIGlkLCBpc0NvbGxhcHNlZF0pO1xuICBjb25zdCBvbkNvbGxhcHNlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChjYW5Db2xsYXBzZSkge1xuICAgICAgaWYgKGlzQ29sbGFwc2VkKSB7XG4gICAgICAgIHNldENvbGxhcHNlZE5vZGVJZHMoY29sbGFwc2VkTm9kZUlkcy5maWx0ZXIoKHApID0+IHAgIT09IGlkKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRDb2xsYXBzZWROb2RlSWRzKFsuLi5jb2xsYXBzZWROb2RlSWRzLCBpZF0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwgW2NhbkNvbGxhcHNlLCBjb2xsYXBzZWROb2RlSWRzLCBpZCwgaXNDb2xsYXBzZWQsIHNldENvbGxhcHNlZE5vZGVJZHNdKTtcbiAgY29uc3QgW3sgbm9kZVBvc2l0aW9uLCBsYWJlbFBvc2l0aW9uLCBzdWJMYWJlbFBvc2l0aW9uIH1dID0gdXNlU3ByaW5nKFxuICAgICgpID0+ICh7XG4gICAgICBmcm9tOiB7XG4gICAgICAgIG5vZGVQb3NpdGlvbjogY2VudGVyID8gW2NlbnRlci54LCBjZW50ZXIueSwgMF0gOiBbMCwgMCwgMF0sXG4gICAgICAgIGxhYmVsUG9zaXRpb246IFswLCAtKG5vZGVTaXplICsgNyksIDJdLFxuICAgICAgICBzdWJMYWJlbFBvc2l0aW9uOiBbMCwgLShub2RlU2l6ZSArIDE0KSwgMl1cbiAgICAgIH0sXG4gICAgICB0bzoge1xuICAgICAgICBub2RlUG9zaXRpb246IHBvc2l0aW9uID8gW1xuICAgICAgICAgIHBvc2l0aW9uLngsXG4gICAgICAgICAgcG9zaXRpb24ueSxcbiAgICAgICAgICBzaG91bGRIaWdobGlnaHQgPyBwb3NpdGlvbi56ICsgMSA6IHBvc2l0aW9uLnpcbiAgICAgICAgXSA6IFswLCAwLCAwXSxcbiAgICAgICAgbGFiZWxQb3NpdGlvbjogWzAsIC0obm9kZVNpemUgKyA3KSwgMl0sXG4gICAgICAgIHN1YkxhYmVsUG9zaXRpb246IFswLCAtKG5vZGVTaXplICsgMTQpLCAyXVxuICAgICAgfSxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICAuLi5hbmltYXRpb25Db25maWcsXG4gICAgICAgIGR1cmF0aW9uOiBhbmltYXRlZCAmJiAhaXNEcmFnZ2luZyA/IHZvaWQgMCA6IDBcbiAgICAgIH1cbiAgICB9KSxcbiAgICBbaXNEcmFnZ2luZ0N1cnJlbnQsIHBvc2l0aW9uLCBhbmltYXRlZCwgbm9kZVNpemUsIHNob3VsZEhpZ2hsaWdodF1cbiAgKTtcbiAgY29uc3QgYmluZCA9IHVzZURyYWcoe1xuICAgIGRyYWdnYWJsZSxcbiAgICBwb3NpdGlvbixcbiAgICAvLyBJZiBkcmFnZ2luZyBpcyBjb25zdHJhaW5lZCB0byB0aGUgY2x1c3RlciwgdXNlIHRoZSBjbHVzdGVyJ3MgcG9zaXRpb24gYXMgdGhlIGJvdW5kc1xuICAgIGJvdW5kczogY29uc3RyYWluRHJhZ2dpbmcgPyBjbHVzdGVyID09IG51bGwgPyB2b2lkIDAgOiBjbHVzdGVyLnBvc2l0aW9uIDogdm9pZCAwLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBzZXQ6IChwb3MpID0+IHNldE5vZGVQb3NpdGlvbihpZCwgcG9zKSxcbiAgICBvbkRyYWdTdGFydDogKCkgPT4ge1xuICAgICAgYWRkRHJhZ2dpbmdJZChpZCk7XG4gICAgICBzZXRBY3RpdmUodHJ1ZSk7XG4gICAgfSxcbiAgICBvbkRyYWdFbmQ6ICgpID0+IHtcbiAgICAgIHJlbW92ZURyYWdnaW5nSWQoaWQpO1xuICAgICAgb25EcmFnZ2VkID09IG51bGwgPyB2b2lkIDAgOiBvbkRyYWdnZWQobm9kZSk7XG4gICAgfVxuICB9KTtcbiAgdXNlQ3Vyc29yKGFjdGl2ZSAmJiAhaXNEcmFnZ2luZyAmJiBvbkNsaWNrICE9PSB2b2lkIDAsIFwicG9pbnRlclwiKTtcbiAgdXNlQ3Vyc29yKFxuICAgIGFjdGl2ZSAmJiBkcmFnZ2FibGUgJiYgIWlzRHJhZ2dpbmdDdXJyZW50ICYmIG9uQ2xpY2sgPT09IHZvaWQgMCxcbiAgICBcImdyYWJcIlxuICApO1xuICB1c2VDdXJzb3IoaXNEcmFnZ2luZ0N1cnJlbnQsIFwiZ3JhYmJpbmdcIik7XG4gIGNvbnN0IGNvbWJpbmVkQWN0aXZlU3RhdGUgPSBzaG91bGRIaWdobGlnaHQgfHwgaXNEcmFnZ2luZ0N1cnJlbnQ7XG4gIGNvbnN0IGNvbG9yID0gY29tYmluZWRBY3RpdmVTdGF0ZSA/IHRoZW1lLm5vZGUuYWN0aXZlRmlsbCA6IG5vZGUuZmlsbCB8fCB0aGVtZS5ub2RlLmZpbGw7XG4gIGNvbnN0IHsgcG9pbnRlck92ZXIsIHBvaW50ZXJPdXQgfSA9IHVzZUhvdmVySW50ZW50KHtcbiAgICBkaXNhYmxlZDogZGlzYWJsZWQyIHx8IGlzRHJhZ2dpbmdDdXJyZW50LFxuICAgIG9uUG9pbnRlck92ZXI6IChldmVudCkgPT4ge1xuICAgICAgY2FtZXJhQ29udHJvbHMuZnJlZXplKCk7XG4gICAgICBzZXRBY3RpdmUodHJ1ZSk7XG4gICAgICBvblBvaW50ZXJPdmVyID09IG51bGwgPyB2b2lkIDAgOiBvblBvaW50ZXJPdmVyKG5vZGUsIGV2ZW50KTtcbiAgICAgIHNldEhvdmVyZWROb2RlSWQoaWQpO1xuICAgIH0sXG4gICAgb25Qb2ludGVyT3V0OiAoZXZlbnQpID0+IHtcbiAgICAgIGNhbWVyYUNvbnRyb2xzLnVuRnJlZXplKCk7XG4gICAgICBzZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgb25Qb2ludGVyT3V0ID09IG51bGwgPyB2b2lkIDAgOiBvblBvaW50ZXJPdXQobm9kZSwgZXZlbnQpO1xuICAgICAgc2V0SG92ZXJlZE5vZGVJZChudWxsKTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBub2RlQ29tcG9uZW50ID0gdXNlTWVtbyhcbiAgICAoKSA9PiByZW5kZXJOb2RlID8gcmVuZGVyTm9kZSh7XG4gICAgICBpZCxcbiAgICAgIGNvbG9yLFxuICAgICAgc2l6ZTogbm9kZVNpemUsXG4gICAgICBhY3RpdmU6IGNvbWJpbmVkQWN0aXZlU3RhdGUsXG4gICAgICBvcGFjaXR5OiBzZWxlY3Rpb25PcGFjaXR5LFxuICAgICAgYW5pbWF0ZWQsXG4gICAgICBzZWxlY3RlZDogaXNTZWxlY3RlZCxcbiAgICAgIG5vZGVcbiAgICB9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IG5vZGUuaWNvbiA/IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICBJY29uLFxuICAgICAge1xuICAgICAgICBpZCxcbiAgICAgICAgaW1hZ2U6IG5vZGUuaWNvbiB8fCBcIlwiLFxuICAgICAgICBzaXplOiBub2RlU2l6ZSArIDgsXG4gICAgICAgIG9wYWNpdHk6IHNlbGVjdGlvbk9wYWNpdHksXG4gICAgICAgIGFuaW1hdGVkLFxuICAgICAgICBjb2xvcixcbiAgICAgICAgbm9kZSxcbiAgICAgICAgYWN0aXZlOiBjb21iaW5lZEFjdGl2ZVN0YXRlLFxuICAgICAgICBzZWxlY3RlZDogaXNTZWxlY3RlZFxuICAgICAgfVxuICAgICkgOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgU3BoZXJlLFxuICAgICAge1xuICAgICAgICBpZCxcbiAgICAgICAgc2l6ZTogbm9kZVNpemUsXG4gICAgICAgIG9wYWNpdHk6IHNlbGVjdGlvbk9wYWNpdHksXG4gICAgICAgIGFuaW1hdGVkLFxuICAgICAgICBjb2xvcixcbiAgICAgICAgbm9kZSxcbiAgICAgICAgYWN0aXZlOiBjb21iaW5lZEFjdGl2ZVN0YXRlLFxuICAgICAgICBzZWxlY3RlZDogaXNTZWxlY3RlZFxuICAgICAgfVxuICAgICkgfSksXG4gICAgW1xuICAgICAgcmVuZGVyTm9kZSxcbiAgICAgIGlkLFxuICAgICAgY29sb3IsXG4gICAgICBub2RlU2l6ZSxcbiAgICAgIGNvbWJpbmVkQWN0aXZlU3RhdGUsXG4gICAgICBzZWxlY3Rpb25PcGFjaXR5LFxuICAgICAgYW5pbWF0ZWQsXG4gICAgICBpc1NlbGVjdGVkLFxuICAgICAgbm9kZVxuICAgIF1cbiAgKTtcbiAgY29uc3QgbGFiZWxDb21wb25lbnQgPSB1c2VNZW1vKFxuICAgICgpID0+IHtcbiAgICAgIHZhciBfYTMsIF9iMywgX2MyO1xuICAgICAgcmV0dXJuIGxhYmVsVmlzaWJsZSAmJiAobGFiZWxWaXNpYmxlIHx8IGlzU2VsZWN0ZWQgfHwgYWN0aXZlKSAmJiBsYWJlbCAmJiAvKiBAX19QVVJFX18gKi8ganN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW1xuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4KGEuZ3JvdXAsIHsgcG9zaXRpb246IGxhYmVsUG9zaXRpb24sIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICAgIExhYmVsLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRleHQ6IGxhYmVsLFxuICAgICAgICAgICAgZm9udFVybDogbGFiZWxGb250VXJsLFxuICAgICAgICAgICAgb3BhY2l0eTogc2VsZWN0aW9uT3BhY2l0eSxcbiAgICAgICAgICAgIHN0cm9rZTogdGhlbWUubm9kZS5sYWJlbC5zdHJva2UsXG4gICAgICAgICAgICBhY3RpdmU6IGlzU2VsZWN0ZWQgfHwgYWN0aXZlIHx8IGlzRHJhZ2dpbmdDdXJyZW50IHx8IGlzQWN0aXZlLFxuICAgICAgICAgICAgY29sb3I6IGlzU2VsZWN0ZWQgfHwgYWN0aXZlIHx8IGlzRHJhZ2dpbmdDdXJyZW50IHx8IGlzQWN0aXZlID8gdGhlbWUubm9kZS5sYWJlbC5hY3RpdmVDb2xvciA6IHRoZW1lLm5vZGUubGFiZWwuY29sb3JcbiAgICAgICAgICB9XG4gICAgICAgICkgfSksXG4gICAgICAgIHN1YkxhYmVsICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goYS5ncm91cCwgeyBwb3NpdGlvbjogc3ViTGFiZWxQb3NpdGlvbiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgICAgTGFiZWwsXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGV4dDogc3ViTGFiZWwsXG4gICAgICAgICAgICBmb250VXJsOiBsYWJlbEZvbnRVcmwsXG4gICAgICAgICAgICBmb250U2l6ZTogNSxcbiAgICAgICAgICAgIG9wYWNpdHk6IHNlbGVjdGlvbk9wYWNpdHksXG4gICAgICAgICAgICBzdHJva2U6IChfYTMgPSB0aGVtZS5ub2RlLnN1YkxhYmVsKSA9PSBudWxsID8gdm9pZCAwIDogX2EzLnN0cm9rZSxcbiAgICAgICAgICAgIGFjdGl2ZTogaXNTZWxlY3RlZCB8fCBhY3RpdmUgfHwgaXNEcmFnZ2luZ0N1cnJlbnQgfHwgaXNBY3RpdmUsXG4gICAgICAgICAgICBjb2xvcjogaXNTZWxlY3RlZCB8fCBhY3RpdmUgfHwgaXNEcmFnZ2luZ0N1cnJlbnQgfHwgaXNBY3RpdmUgPyAoX2IzID0gdGhlbWUubm9kZS5zdWJMYWJlbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iMy5hY3RpdmVDb2xvciA6IChfYzIgPSB0aGVtZS5ub2RlLnN1YkxhYmVsKSA9PSBudWxsID8gdm9pZCAwIDogX2MyLmNvbG9yXG4gICAgICAgICAgfVxuICAgICAgICApIH0pXG4gICAgICBdIH0pO1xuICAgIH0sXG4gICAgW1xuICAgICAgYWN0aXZlLFxuICAgICAgaXNBY3RpdmUsXG4gICAgICBpc0RyYWdnaW5nQ3VycmVudCxcbiAgICAgIGlzU2VsZWN0ZWQsXG4gICAgICBsYWJlbCxcbiAgICAgIGxhYmVsRm9udFVybCxcbiAgICAgIGxhYmVsUG9zaXRpb24sXG4gICAgICBsYWJlbFZpc2libGUsXG4gICAgICBzZWxlY3Rpb25PcGFjaXR5LFxuICAgICAgc3ViTGFiZWwsXG4gICAgICBzdWJMYWJlbFBvc2l0aW9uLFxuICAgICAgdGhlbWUubm9kZS5sYWJlbC5hY3RpdmVDb2xvcixcbiAgICAgIHRoZW1lLm5vZGUubGFiZWwuY29sb3IsXG4gICAgICB0aGVtZS5ub2RlLmxhYmVsLnN0cm9rZSxcbiAgICAgIChfYTIgPSB0aGVtZS5ub2RlLnN1YkxhYmVsKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmFjdGl2ZUNvbG9yLFxuICAgICAgKF9iMiA9IHRoZW1lLm5vZGUuc3ViTGFiZWwpID09IG51bGwgPyB2b2lkIDAgOiBfYjIuY29sb3IsXG4gICAgICAoX2MgPSB0aGVtZS5ub2RlLnN1YkxhYmVsKSA9PSBudWxsID8gdm9pZCAwIDogX2Muc3Ryb2tlXG4gICAgXVxuICApO1xuICBjb25zdCBtZW51Q29tcG9uZW50ID0gdXNlTWVtbyhcbiAgICAoKSA9PiBtZW51VmlzaWJsZSAmJiBjb250ZXh0TWVudSAmJiAvKiBAX19QVVJFX18gKi8ganN4KEh0bWwsIHsgcHJlcGVuZDogdHJ1ZSwgY2VudGVyOiB0cnVlLCBjaGlsZHJlbjogY29udGV4dE1lbnUoe1xuICAgICAgZGF0YTogbm9kZSxcbiAgICAgIGNhbkNvbGxhcHNlLFxuICAgICAgaXNDb2xsYXBzZWQsXG4gICAgICBvbkNvbGxhcHNlLFxuICAgICAgb25DbG9zZTogKCkgPT4gc2V0TWVudVZpc2libGUoZmFsc2UpXG4gICAgfSkgfSksXG4gICAgW21lbnVWaXNpYmxlLCBjb250ZXh0TWVudSwgbm9kZSwgY2FuQ29sbGFwc2UsIGlzQ29sbGFwc2VkLCBvbkNvbGxhcHNlXVxuICApO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMoXG4gICAgYS5ncm91cCxcbiAgICB7XG4gICAgICByZW5kZXJPcmRlcjogMSxcbiAgICAgIHVzZXJEYXRhOiB7IGlkLCB0eXBlOiBcIm5vZGVcIiB9LFxuICAgICAgcmVmOiBncm91cCxcbiAgICAgIHBvc2l0aW9uOiBub2RlUG9zaXRpb24sXG4gICAgICBvblBvaW50ZXJPdmVyOiBwb2ludGVyT3ZlcixcbiAgICAgIG9uUG9pbnRlck91dDogcG9pbnRlck91dCxcbiAgICAgIG9uQ2xpY2s6IChldmVudCkgPT4ge1xuICAgICAgICBpZiAoIWRpc2FibGVkMiAmJiAhaXNEcmFnZ2luZ0N1cnJlbnQpIHtcbiAgICAgICAgICBvbkNsaWNrID09IG51bGwgPyB2b2lkIDAgOiBvbkNsaWNrKFxuICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgY2FuQ29sbGFwc2UsXG4gICAgICAgICAgICAgIGlzQ29sbGFwc2VkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXZlbnRcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25Eb3VibGVDbGljazogKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmICghZGlzYWJsZWQyICYmICFpc0RyYWdnaW5nQ3VycmVudCkge1xuICAgICAgICAgIG9uRG91YmxlQ2xpY2sgPT0gbnVsbCA/IHZvaWQgMCA6IG9uRG91YmxlQ2xpY2sobm9kZSwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25Db250ZXh0TWVudTogKCkgPT4ge1xuICAgICAgICBpZiAoIWRpc2FibGVkMikge1xuICAgICAgICAgIHNldE1lbnVWaXNpYmxlKHRydWUpO1xuICAgICAgICAgIG9uQ29udGV4dE1lbnUgPT0gbnVsbCA/IHZvaWQgMCA6IG9uQ29udGV4dE1lbnUobm9kZSwge1xuICAgICAgICAgICAgY2FuQ29sbGFwc2UsXG4gICAgICAgICAgICBpc0NvbGxhcHNlZCxcbiAgICAgICAgICAgIG9uQ29sbGFwc2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC4uLmJpbmQoKSxcbiAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgIG5vZGVDb21wb25lbnQsXG4gICAgICAgIG1lbnVDb21wb25lbnQsXG4gICAgICAgIGxhYmVsQ29tcG9uZW50XG4gICAgICBdXG4gICAgfVxuICApO1xufTtcbmNvbnN0IEFycm93ID0gKHtcbiAgYW5pbWF0ZWQsXG4gIGNvbG9yID0gXCIjRDhFNkVBXCIsXG4gIGxlbmd0aCxcbiAgb3BhY2l0eSA9IDAuNSxcbiAgcG9zaXRpb24sXG4gIHJvdGF0aW9uLFxuICBzaXplID0gMSxcbiAgb25BY3RpdmUsXG4gIG9uQ29udGV4dE1lbnVcbn0pID0+IHtcbiAgY29uc3Qgbm9ybWFsaXplZENvbG9yID0gdXNlTWVtbygoKSA9PiBuZXcgQ29sb3IoY29sb3IpLCBbY29sb3JdKTtcbiAgY29uc3QgbWVzaFJlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgaXNEcmFnZ2luZyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuZHJhZ2dpbmdJZHMubGVuZ3RoID4gMCk7XG4gIGNvbnN0IGNlbnRlciA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuY2VudGVyUG9zaXRpb24pO1xuICBjb25zdCBbeyBwb3MsIGFycm93T3BhY2l0eSB9XSA9IHVzZVNwcmluZyhcbiAgICAoKSA9PiAoe1xuICAgICAgZnJvbToge1xuICAgICAgICBwb3M6IGNlbnRlciA/IFtjZW50ZXIueCwgY2VudGVyLnksIGNlbnRlci56XSA6IFswLCAwLCAwXSxcbiAgICAgICAgYXJyb3dPcGFjaXR5OiAwXG4gICAgICB9LFxuICAgICAgdG86IHtcbiAgICAgICAgcG9zOiBbcG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcG9zaXRpb24uel0sXG4gICAgICAgIGFycm93T3BhY2l0eTogb3BhY2l0eVxuICAgICAgfSxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICAuLi5hbmltYXRpb25Db25maWcsXG4gICAgICAgIGR1cmF0aW9uOiBhbmltYXRlZCAmJiAhaXNEcmFnZ2luZyA/IHZvaWQgMCA6IDBcbiAgICAgIH1cbiAgICB9KSxcbiAgICBbYW5pbWF0ZWQsIGlzRHJhZ2dpbmcsIG9wYWNpdHksIHBvc2l0aW9uXVxuICApO1xuICBjb25zdCBzZXRRdWF0ZXJuaW9uID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHZhciBfYTI7XG4gICAgY29uc3QgYXhpcyA9IG5ldyBWZWN0b3IzKDAsIDEsIDApO1xuICAgIChfYTIgPSBtZXNoUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTIucXVhdGVybmlvbi5zZXRGcm9tVW5pdFZlY3RvcnMoYXhpcywgcm90YXRpb24pO1xuICB9LCBbcm90YXRpb24sIG1lc2hSZWZdKTtcbiAgdXNlRWZmZWN0KCgpID0+IHNldFF1YXRlcm5pb24oKSwgW3NldFF1YXRlcm5pb25dKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzKFxuICAgIGEubWVzaCxcbiAgICB7XG4gICAgICBwb3NpdGlvbjogcG9zLFxuICAgICAgcmVmOiBtZXNoUmVmLFxuICAgICAgc2NhbGU6IFsxLCAxLCAxXSxcbiAgICAgIG9uUG9pbnRlck92ZXI6ICgpID0+IG9uQWN0aXZlKHRydWUpLFxuICAgICAgb25Qb2ludGVyT3V0OiAoKSA9PiBvbkFjdGl2ZShmYWxzZSksXG4gICAgICBvblBvaW50ZXJEb3duOiAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50Lm5hdGl2ZUV2ZW50LmJ1dHRvbnMgPT09IDIpIHtcbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBvbkNvbnRleHRNZW51KCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjaGlsZHJlbjogW1xuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICAgIFwiY3lsaW5kZXJHZW9tZXRyeVwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFyZ3M6IFswLCBzaXplLCBsZW5ndGgsIDIwLCAxLCB0cnVlXSxcbiAgICAgICAgICAgIGF0dGFjaDogXCJnZW9tZXRyeVwiXG4gICAgICAgICAgfVxuICAgICAgICApLFxuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICAgIGEubWVzaEJhc2ljTWF0ZXJpYWwsXG4gICAgICAgICAge1xuICAgICAgICAgICAgYXR0YWNoOiBcIm1hdGVyaWFsXCIsXG4gICAgICAgICAgICBjb2xvcjogbm9ybWFsaXplZENvbG9yLFxuICAgICAgICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgICAgICAgIG9wYWNpdHk6IGFycm93T3BhY2l0eSxcbiAgICAgICAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxuICAgICAgICAgICAgc2lkZTogRG91YmxlU2lkZSxcbiAgICAgICAgICAgIGZvZzogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgXVxuICAgIH1cbiAgKTtcbn07XG5jb25zdCBMaW5lID0gKHtcbiAgY3VydmVPZmZzZXQsXG4gIGFuaW1hdGVkLFxuICBjb2xvciA9IFwiIzAwMFwiLFxuICBjdXJ2ZSxcbiAgY3VydmVkID0gZmFsc2UsXG4gIGlkLFxuICBvcGFjaXR5ID0gMSxcbiAgc2l6ZSA9IDEsXG4gIG9uQ29udGV4dE1lbnUsXG4gIG9uQ2xpY2ssXG4gIG9uUG9pbnRlck92ZXIsXG4gIG9uUG9pbnRlck91dFxufSkgPT4ge1xuICBjb25zdCB0dWJlUmVmID0gdXNlUmVmKG51bGwpO1xuICBjb25zdCBpc0RyYWdnaW5nID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5kcmFnZ2luZ0lkcy5sZW5ndGggPiAwKTtcbiAgY29uc3Qgbm9ybWFsaXplZENvbG9yID0gdXNlTWVtbygoKSA9PiBuZXcgQ29sb3IoY29sb3IpLCBbY29sb3JdKTtcbiAgY29uc3QgY2VudGVyID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5jZW50ZXJQb3NpdGlvbik7XG4gIGNvbnN0IG1vdW50ZWQgPSB1c2VSZWYoZmFsc2UpO1xuICBjb25zdCB7IGxpbmVPcGFjaXR5IH0gPSB1c2VTcHJpbmcoe1xuICAgIGZyb206IHtcbiAgICAgIGxpbmVPcGFjaXR5OiAwXG4gICAgfSxcbiAgICB0bzoge1xuICAgICAgbGluZU9wYWNpdHk6IG9wYWNpdHlcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgLi4uYW5pbWF0aW9uQ29uZmlnLFxuICAgICAgZHVyYXRpb246IGFuaW1hdGVkID8gdm9pZCAwIDogMFxuICAgIH1cbiAgfSk7XG4gIHVzZVNwcmluZygoKSA9PiB7XG4gICAgY29uc3QgZnJvbSA9IGN1cnZlLmdldFBvaW50KDApO1xuICAgIGNvbnN0IHRvID0gY3VydmUuZ2V0UG9pbnQoMSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZyb206IHtcbiAgICAgICAgLy8gQW5pbWF0ZSBmcm9tIGNlbnRlciBmaXJzdCB0aW1lLCB0aGVuIGZyb20gdGhlIGFjdHVhbCBmcm9tIHBvaW50XG4gICAgICAgIGZyb21WZXJ0aWNlczogIW1vdW50ZWQuY3VycmVudCA/IFtjZW50ZXIgPT0gbnVsbCA/IHZvaWQgMCA6IGNlbnRlci54LCBjZW50ZXIgPT0gbnVsbCA/IHZvaWQgMCA6IGNlbnRlci55LCAoY2VudGVyID09IG51bGwgPyB2b2lkIDAgOiBjZW50ZXIueikgfHwgMF0gOiBbdG8gPT0gbnVsbCA/IHZvaWQgMCA6IHRvLngsIHRvID09IG51bGwgPyB2b2lkIDAgOiB0by55LCAodG8gPT0gbnVsbCA/IHZvaWQgMCA6IHRvLnopIHx8IDBdLFxuICAgICAgICB0b1ZlcnRpY2VzOiBbZnJvbSA9PSBudWxsID8gdm9pZCAwIDogZnJvbS54LCBmcm9tID09IG51bGwgPyB2b2lkIDAgOiBmcm9tLnksIChmcm9tID09IG51bGwgPyB2b2lkIDAgOiBmcm9tLnopIHx8IDBdXG4gICAgICB9LFxuICAgICAgdG86IHtcbiAgICAgICAgZnJvbVZlcnRpY2VzOiBbZnJvbSA9PSBudWxsID8gdm9pZCAwIDogZnJvbS54LCBmcm9tID09IG51bGwgPyB2b2lkIDAgOiBmcm9tLnksIChmcm9tID09IG51bGwgPyB2b2lkIDAgOiBmcm9tLnopIHx8IDBdLFxuICAgICAgICB0b1ZlcnRpY2VzOiBbdG8gPT0gbnVsbCA/IHZvaWQgMCA6IHRvLngsIHRvID09IG51bGwgPyB2b2lkIDAgOiB0by55LCAodG8gPT0gbnVsbCA/IHZvaWQgMCA6IHRvLnopIHx8IDBdXG4gICAgICB9LFxuICAgICAgb25DaGFuZ2U6IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IGZyb21WZXJ0aWNlcywgdG9WZXJ0aWNlcyB9ID0gZXZlbnQudmFsdWU7XG4gICAgICAgIGNvbnN0IGZyb21WZWN0b3IgPSBuZXcgVmVjdG9yMyguLi5mcm9tVmVydGljZXMpO1xuICAgICAgICBjb25zdCB0b1ZlY3RvciA9IG5ldyBWZWN0b3IzKC4uLnRvVmVydGljZXMpO1xuICAgICAgICBjb25zdCBjdXJ2ZTIgPSBnZXRDdXJ2ZShmcm9tVmVjdG9yLCAwLCB0b1ZlY3RvciwgMCwgY3VydmVkLCBjdXJ2ZU9mZnNldCk7XG4gICAgICAgIHR1YmVSZWYuY3VycmVudC5jb3B5KG5ldyBUdWJlR2VvbWV0cnkoY3VydmUyLCAyMCwgc2l6ZSAvIDIsIDUsIGZhbHNlKSk7XG4gICAgICB9LFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIC4uLmFuaW1hdGlvbkNvbmZpZyxcbiAgICAgICAgZHVyYXRpb246IGFuaW1hdGVkICYmICFpc0RyYWdnaW5nID8gdm9pZCAwIDogMFxuICAgICAgfVxuICAgIH07XG4gIH0sIFthbmltYXRlZCwgaXNEcmFnZ2luZywgY3VydmUsIHNpemVdKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBtb3VudGVkLmN1cnJlbnQgPSB0cnVlO1xuICB9LCBbXSk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4cyhcbiAgICBcIm1lc2hcIixcbiAgICB7XG4gICAgICB1c2VyRGF0YTogeyBpZCwgdHlwZTogXCJlZGdlXCIgfSxcbiAgICAgIG9uUG9pbnRlck92ZXIsXG4gICAgICBvblBvaW50ZXJPdXQsXG4gICAgICBvbkNsaWNrLFxuICAgICAgb25Qb2ludGVyRG93bjogKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChldmVudC5uYXRpdmVFdmVudC5idXR0b25zID09PSAyKSB7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgb25Db250ZXh0TWVudSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcInR1YmVHZW9tZXRyeVwiLCB7IGF0dGFjaDogXCJnZW9tZXRyeVwiLCByZWY6IHR1YmVSZWYgfSksXG4gICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgICAgYS5tZXNoQmFzaWNNYXRlcmlhbCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBhdHRhY2g6IFwibWF0ZXJpYWxcIixcbiAgICAgICAgICAgIG9wYWNpdHk6IGxpbmVPcGFjaXR5LFxuICAgICAgICAgICAgZm9nOiB0cnVlLFxuICAgICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICAgICAgICBkZXB0aFRlc3Q6IGZhbHNlLFxuICAgICAgICAgICAgY29sb3I6IG5vcm1hbGl6ZWRDb2xvclxuICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgXVxuICAgIH1cbiAgKTtcbn07XG5jb25zdCBMQUJFTF9QTEFDRU1FTlRfT0ZGU0VUID0gMztcbmNvbnN0IEVkZ2UkMSA9ICh7XG4gIGFuaW1hdGVkLFxuICBhcnJvd1BsYWNlbWVudCA9IFwiZW5kXCIsXG4gIGNvbnRleHRNZW51LFxuICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICBsYWJlbFBsYWNlbWVudCA9IFwiaW5saW5lXCIsXG4gIGlkLFxuICBpbnRlcnBvbGF0aW9uLFxuICBsYWJlbEZvbnRVcmwsXG4gIG9uQ29udGV4dE1lbnUsXG4gIG9uQ2xpY2ssXG4gIG9uUG9pbnRlck92ZXIsXG4gIG9uUG9pbnRlck91dFxufSkgPT4ge1xuICBjb25zdCB0aGVtZSA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUudGhlbWUpO1xuICBjb25zdCBpc0RyYWdnaW5nID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5kcmFnZ2luZ0lkcy5sZW5ndGggPiAwKTtcbiAgY29uc3QgW2FjdGl2ZSwgc2V0QWN0aXZlXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW21lbnVWaXNpYmxlLCBzZXRNZW51VmlzaWJsZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGVkZ2VzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5lZGdlcyk7XG4gIGNvbnN0IGVkZ2UgPSBlZGdlcy5maW5kKChlKSA9PiBlLmlkID09PSBpZCk7XG4gIGNvbnN0IHsgdGFyZ2V0LCBzb3VyY2UsIGxhYmVsLCBsYWJlbFZpc2libGUgPSBmYWxzZSwgc2l6ZSA9IDEsIGZpbGwgfSA9IGVkZ2U7XG4gIGNvbnN0IGZyb20gPSB1c2VTdG9yZSgoc3RvcmUpID0+IHN0b3JlLm5vZGVzLmZpbmQoKG5vZGUpID0+IG5vZGUuaWQgPT09IHNvdXJjZSkpO1xuICBjb25zdCB0byA9IHVzZVN0b3JlKChzdG9yZSkgPT4gc3RvcmUubm9kZXMuZmluZCgobm9kZSkgPT4gbm9kZS5pZCA9PT0gdGFyZ2V0KSk7XG4gIGNvbnN0IGxhYmVsT2Zmc2V0ID0gKHNpemUgKyB0aGVtZS5lZGdlLmxhYmVsLmZvbnRTaXplKSAvIDI7XG4gIGNvbnN0IFthcnJvd0xlbmd0aCwgYXJyb3dTaXplXSA9IHVzZU1lbW8oKCkgPT4gZ2V0QXJyb3dTaXplKHNpemUpLCBbc2l6ZV0pO1xuICBjb25zdCB7IGN1cnZlT2Zmc2V0LCBjdXJ2ZWQgfSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gY2FsY3VsYXRlRWRnZUN1cnZlT2Zmc2V0KHtcbiAgICAgIGVkZ2UsXG4gICAgICBlZGdlcyxcbiAgICAgIGN1cnZlZDogaW50ZXJwb2xhdGlvbiA9PT0gXCJjdXJ2ZWRcIlxuICAgIH0pLFxuICAgIFtlZGdlLCBlZGdlcywgaW50ZXJwb2xhdGlvbl1cbiAgKTtcbiAgY29uc3QgW2N1cnZlLCBhcnJvd1Bvc2l0aW9uLCBhcnJvd1JvdGF0aW9uXSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IGZyb21WZWN0b3IgPSBnZXRWZWN0b3IoZnJvbSk7XG4gICAgY29uc3QgZnJvbU9mZnNldCA9IGZyb20uc2l6ZTtcbiAgICBjb25zdCB0b1ZlY3RvciA9IGdldFZlY3Rvcih0byk7XG4gICAgY29uc3QgdG9PZmZzZXQgPSB0by5zaXplO1xuICAgIGxldCBjdXJ2ZTIgPSBnZXRDdXJ2ZShcbiAgICAgIGZyb21WZWN0b3IsXG4gICAgICBmcm9tT2Zmc2V0LFxuICAgICAgdG9WZWN0b3IsXG4gICAgICB0b09mZnNldCxcbiAgICAgIGN1cnZlZCxcbiAgICAgIGN1cnZlT2Zmc2V0XG4gICAgKTtcbiAgICBjb25zdCBbYXJyb3dQb3NpdGlvbjIsIGFycm93Um90YXRpb24yXSA9IGdldEFycm93VmVjdG9ycyhcbiAgICAgIGFycm93UGxhY2VtZW50LFxuICAgICAgY3VydmUyLFxuICAgICAgYXJyb3dMZW5ndGhcbiAgICApO1xuICAgIGlmIChhcnJvd1BsYWNlbWVudCA9PT0gXCJlbmRcIikge1xuICAgICAgY3VydmUyID0gZ2V0Q3VydmUoXG4gICAgICAgIGZyb21WZWN0b3IsXG4gICAgICAgIGZyb21PZmZzZXQsXG4gICAgICAgIGFycm93UG9zaXRpb24yLFxuICAgICAgICAwLFxuICAgICAgICBjdXJ2ZWQsXG4gICAgICAgIGN1cnZlT2Zmc2V0XG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gW2N1cnZlMiwgYXJyb3dQb3NpdGlvbjIsIGFycm93Um90YXRpb24yXTtcbiAgfSwgW2Zyb20sIHRvLCBjdXJ2ZWQsIGN1cnZlT2Zmc2V0LCBhcnJvd1BsYWNlbWVudCwgYXJyb3dMZW5ndGhdKTtcbiAgY29uc3QgbWlkUG9pbnQgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBsZXQgbmV3TWlkUG9pbnQgPSBnZXRNaWRQb2ludChcbiAgICAgIGZyb20ucG9zaXRpb24sXG4gICAgICB0by5wb3NpdGlvbixcbiAgICAgIGdldExhYmVsT2Zmc2V0QnlUeXBlKGxhYmVsT2Zmc2V0LCBsYWJlbFBsYWNlbWVudClcbiAgICApO1xuICAgIGlmIChjdXJ2ZWQpIHtcbiAgICAgIGNvbnN0IG9mZnNldCA9IG5ldyBWZWN0b3IzKCkuc3ViVmVjdG9ycyhuZXdNaWRQb2ludCwgY3VydmUuZ2V0UG9pbnQoMC41KSk7XG4gICAgICBzd2l0Y2ggKGxhYmVsUGxhY2VtZW50KSB7XG4gICAgICAgIGNhc2UgXCJhYm92ZVwiOlxuICAgICAgICAgIG9mZnNldC55ID0gb2Zmc2V0LnkgLSBMQUJFTF9QTEFDRU1FTlRfT0ZGU0VUO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiYmVsb3dcIjpcbiAgICAgICAgICBvZmZzZXQueSA9IG9mZnNldC55ICsgTEFCRUxfUExBQ0VNRU5UX09GRlNFVDtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIG5ld01pZFBvaW50ID0gbmV3TWlkUG9pbnQuc3ViKG9mZnNldCk7XG4gICAgfVxuICAgIHJldHVybiBuZXdNaWRQb2ludDtcbiAgfSwgW2Zyb20ucG9zaXRpb24sIHRvLnBvc2l0aW9uLCBsYWJlbE9mZnNldCwgbGFiZWxQbGFjZW1lbnQsIGN1cnZlZCwgY3VydmVdKTtcbiAgY29uc3QgaXNTZWxlY3RlZCA9IHVzZVN0b3JlKChzdGF0ZSkgPT4ge1xuICAgIHZhciBfYTI7XG4gICAgcmV0dXJuIChfYTIgPSBzdGF0ZS5zZWxlY3Rpb25zKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmluY2x1ZGVzKGlkKTtcbiAgfSk7XG4gIGNvbnN0IGhhc1NlbGVjdGlvbnMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHtcbiAgICB2YXIgX2EyO1xuICAgIHJldHVybiAoX2EyID0gc3RhdGUuc2VsZWN0aW9ucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5sZW5ndGg7XG4gIH0pO1xuICBjb25zdCBpc0FjdGl2ZSA9IHVzZVN0b3JlKChzdGF0ZSkgPT4ge1xuICAgIHZhciBfYTI7XG4gICAgcmV0dXJuIChfYTIgPSBzdGF0ZS5hY3RpdmVzKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmluY2x1ZGVzKGlkKTtcbiAgfSk7XG4gIGNvbnN0IGNlbnRlciA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuY2VudGVyUG9zaXRpb24pO1xuICBjb25zdCBzZWxlY3Rpb25PcGFjaXR5ID0gaGFzU2VsZWN0aW9ucyA/IGlzU2VsZWN0ZWQgfHwgaXNBY3RpdmUgPyB0aGVtZS5lZGdlLnNlbGVjdGVkT3BhY2l0eSA6IHRoZW1lLmVkZ2UuaW5hY3RpdmVPcGFjaXR5IDogdGhlbWUuZWRnZS5vcGFjaXR5O1xuICBjb25zdCBbeyBsYWJlbFBvc2l0aW9uIH1dID0gdXNlU3ByaW5nKFxuICAgICgpID0+ICh7XG4gICAgICBmcm9tOiB7XG4gICAgICAgIGxhYmVsUG9zaXRpb246IGNlbnRlciA/IFtjZW50ZXIueCwgY2VudGVyLnksIGNlbnRlci56XSA6IFswLCAwLCAwXVxuICAgICAgfSxcbiAgICAgIHRvOiB7XG4gICAgICAgIGxhYmVsUG9zaXRpb246IFttaWRQb2ludC54LCBtaWRQb2ludC55LCBtaWRQb2ludC56XVxuICAgICAgfSxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICAuLi5hbmltYXRpb25Db25maWcsXG4gICAgICAgIGR1cmF0aW9uOiBhbmltYXRlZCAmJiAhaXNEcmFnZ2luZyA/IHZvaWQgMCA6IDBcbiAgICAgIH1cbiAgICB9KSxcbiAgICBbbWlkUG9pbnQsIGFuaW1hdGVkLCBpc0RyYWdnaW5nXVxuICApO1xuICBjb25zdCBsYWJlbFJvdGF0aW9uID0gdXNlTWVtbyhcbiAgICAoKSA9PiBuZXcgRXVsZXIoXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIGxhYmVsUGxhY2VtZW50ID09PSBcIm5hdHVyYWxcIiA/IDAgOiBNYXRoLmF0YW4oXG4gICAgICAgICh0by5wb3NpdGlvbi55IC0gZnJvbS5wb3NpdGlvbi55KSAvICh0by5wb3NpdGlvbi54IC0gZnJvbS5wb3NpdGlvbi54KVxuICAgICAgKVxuICAgICksXG4gICAgW1xuICAgICAgdG8ucG9zaXRpb24ueCxcbiAgICAgIHRvLnBvc2l0aW9uLnksXG4gICAgICBmcm9tLnBvc2l0aW9uLngsXG4gICAgICBmcm9tLnBvc2l0aW9uLnksXG4gICAgICBsYWJlbFBsYWNlbWVudFxuICAgIF1cbiAgKTtcbiAgdXNlQ3Vyc29yKGFjdGl2ZSAmJiAhaXNEcmFnZ2luZyAmJiBvbkNsaWNrICE9PSB2b2lkIDAsIFwicG9pbnRlclwiKTtcbiAgY29uc3QgeyBwb2ludGVyT3ZlciwgcG9pbnRlck91dCB9ID0gdXNlSG92ZXJJbnRlbnQoe1xuICAgIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gICAgb25Qb2ludGVyT3ZlcjogKGV2ZW50KSA9PiB7XG4gICAgICBzZXRBY3RpdmUodHJ1ZSk7XG4gICAgICBvblBvaW50ZXJPdmVyID09IG51bGwgPyB2b2lkIDAgOiBvblBvaW50ZXJPdmVyKGVkZ2UsIGV2ZW50KTtcbiAgICB9LFxuICAgIG9uUG9pbnRlck91dDogKGV2ZW50KSA9PiB7XG4gICAgICBzZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgb25Qb2ludGVyT3V0ID09IG51bGwgPyB2b2lkIDAgOiBvblBvaW50ZXJPdXQoZWRnZSwgZXZlbnQpO1xuICAgIH1cbiAgfSk7XG4gIGNvbnN0IGFycm93Q29tcG9uZW50ID0gdXNlTWVtbyhcbiAgICAoKSA9PiBhcnJvd1BsYWNlbWVudCAhPT0gXCJub25lXCIgJiYgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgIEFycm93LFxuICAgICAge1xuICAgICAgICBhbmltYXRlZCxcbiAgICAgICAgY29sb3I6IGlzU2VsZWN0ZWQgfHwgYWN0aXZlIHx8IGlzQWN0aXZlID8gdGhlbWUuYXJyb3cuYWN0aXZlRmlsbCA6IGZpbGwgfHwgdGhlbWUuYXJyb3cuZmlsbCxcbiAgICAgICAgbGVuZ3RoOiBhcnJvd0xlbmd0aCxcbiAgICAgICAgb3BhY2l0eTogc2VsZWN0aW9uT3BhY2l0eSxcbiAgICAgICAgcG9zaXRpb246IGFycm93UG9zaXRpb24sXG4gICAgICAgIHJvdGF0aW9uOiBhcnJvd1JvdGF0aW9uLFxuICAgICAgICBzaXplOiBhcnJvd1NpemUsXG4gICAgICAgIG9uQWN0aXZlOiBzZXRBY3RpdmUsXG4gICAgICAgIG9uQ29udGV4dE1lbnU6ICgpID0+IHtcbiAgICAgICAgICBpZiAoIWRpc2FibGVkMikge1xuICAgICAgICAgICAgc2V0TWVudVZpc2libGUodHJ1ZSk7XG4gICAgICAgICAgICBvbkNvbnRleHRNZW51ID09IG51bGwgPyB2b2lkIDAgOiBvbkNvbnRleHRNZW51KGVkZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICksXG4gICAgW1xuICAgICAgZmlsbCxcbiAgICAgIGFjdGl2ZSxcbiAgICAgIGFuaW1hdGVkLFxuICAgICAgYXJyb3dMZW5ndGgsXG4gICAgICBhcnJvd1BsYWNlbWVudCxcbiAgICAgIGFycm93UG9zaXRpb24sXG4gICAgICBhcnJvd1JvdGF0aW9uLFxuICAgICAgYXJyb3dTaXplLFxuICAgICAgZGlzYWJsZWQyLFxuICAgICAgZWRnZSxcbiAgICAgIGlzQWN0aXZlLFxuICAgICAgaXNTZWxlY3RlZCxcbiAgICAgIG9uQ29udGV4dE1lbnUsXG4gICAgICBzZWxlY3Rpb25PcGFjaXR5LFxuICAgICAgdGhlbWUuYXJyb3cuYWN0aXZlRmlsbCxcbiAgICAgIHRoZW1lLmFycm93LmZpbGxcbiAgICBdXG4gICk7XG4gIGNvbnN0IGxhYmVsQ29tcG9uZW50ID0gdXNlTWVtbyhcbiAgICAoKSA9PiBsYWJlbFZpc2libGUgJiYgbGFiZWwgJiYgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgIGEuZ3JvdXAsXG4gICAgICB7XG4gICAgICAgIHBvc2l0aW9uOiBsYWJlbFBvc2l0aW9uLFxuICAgICAgICBvbkNvbnRleHRNZW51OiAoKSA9PiB7XG4gICAgICAgICAgaWYgKCFkaXNhYmxlZDIpIHtcbiAgICAgICAgICAgIHNldE1lbnVWaXNpYmxlKHRydWUpO1xuICAgICAgICAgICAgb25Db250ZXh0TWVudSA9PSBudWxsID8gdm9pZCAwIDogb25Db250ZXh0TWVudShlZGdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9uUG9pbnRlck92ZXI6IHBvaW50ZXJPdmVyLFxuICAgICAgICBvblBvaW50ZXJPdXQ6IHBvaW50ZXJPdXQsXG4gICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICAgIExhYmVsLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRleHQ6IGxhYmVsLFxuICAgICAgICAgICAgZWxsaXBzaXM6IDE1LFxuICAgICAgICAgICAgZm9udFVybDogbGFiZWxGb250VXJsLFxuICAgICAgICAgICAgc3Ryb2tlOiB0aGVtZS5lZGdlLmxhYmVsLnN0cm9rZSxcbiAgICAgICAgICAgIGNvbG9yOiBpc1NlbGVjdGVkIHx8IGFjdGl2ZSB8fCBpc0FjdGl2ZSA/IHRoZW1lLmVkZ2UubGFiZWwuYWN0aXZlQ29sb3IgOiB0aGVtZS5lZGdlLmxhYmVsLmNvbG9yLFxuICAgICAgICAgICAgb3BhY2l0eTogc2VsZWN0aW9uT3BhY2l0eSxcbiAgICAgICAgICAgIGZvbnRTaXplOiB0aGVtZS5lZGdlLmxhYmVsLmZvbnRTaXplLFxuICAgICAgICAgICAgcm90YXRpb246IGxhYmVsUm90YXRpb25cbiAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICApLFxuICAgIFtcbiAgICAgIGFjdGl2ZSxcbiAgICAgIGRpc2FibGVkMixcbiAgICAgIGVkZ2UsXG4gICAgICBpc0FjdGl2ZSxcbiAgICAgIGlzU2VsZWN0ZWQsXG4gICAgICBsYWJlbCxcbiAgICAgIGxhYmVsRm9udFVybCxcbiAgICAgIGxhYmVsUG9zaXRpb24sXG4gICAgICBsYWJlbFJvdGF0aW9uLFxuICAgICAgbGFiZWxWaXNpYmxlLFxuICAgICAgb25Db250ZXh0TWVudSxcbiAgICAgIHBvaW50ZXJPdXQsXG4gICAgICBwb2ludGVyT3ZlcixcbiAgICAgIHNlbGVjdGlvbk9wYWNpdHksXG4gICAgICB0aGVtZS5lZGdlLmxhYmVsLmFjdGl2ZUNvbG9yLFxuICAgICAgdGhlbWUuZWRnZS5sYWJlbC5jb2xvcixcbiAgICAgIHRoZW1lLmVkZ2UubGFiZWwuZm9udFNpemUsXG4gICAgICB0aGVtZS5lZGdlLmxhYmVsLnN0cm9rZVxuICAgIF1cbiAgKTtcbiAgY29uc3QgbWVudUNvbXBvbmVudCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gbWVudVZpc2libGUgJiYgY29udGV4dE1lbnUgJiYgLyogQF9fUFVSRV9fICovIGpzeChIdG1sLCB7IHByZXBlbmQ6IHRydWUsIGNlbnRlcjogdHJ1ZSwgcG9zaXRpb246IG1pZFBvaW50LCBjaGlsZHJlbjogY29udGV4dE1lbnUoeyBkYXRhOiBlZGdlLCBvbkNsb3NlOiAoKSA9PiBzZXRNZW51VmlzaWJsZShmYWxzZSkgfSkgfSksXG4gICAgW21lbnVWaXNpYmxlLCBjb250ZXh0TWVudSwgbWlkUG9pbnQsIGVkZ2VdXG4gICk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4cyhcImdyb3VwXCIsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgTGluZSxcbiAgICAgIHtcbiAgICAgICAgY3VydmVPZmZzZXQsXG4gICAgICAgIGFuaW1hdGVkLFxuICAgICAgICBjb2xvcjogaXNTZWxlY3RlZCB8fCBhY3RpdmUgfHwgaXNBY3RpdmUgPyB0aGVtZS5lZGdlLmFjdGl2ZUZpbGwgOiBmaWxsIHx8IHRoZW1lLmVkZ2UuZmlsbCxcbiAgICAgICAgY3VydmUsXG4gICAgICAgIGN1cnZlZCxcbiAgICAgICAgaWQsXG4gICAgICAgIG9wYWNpdHk6IHNlbGVjdGlvbk9wYWNpdHksXG4gICAgICAgIHNpemUsXG4gICAgICAgIG9uQ2xpY2s6IChldmVudCkgPT4ge1xuICAgICAgICAgIGlmICghZGlzYWJsZWQyKSB7XG4gICAgICAgICAgICBvbkNsaWNrID09IG51bGwgPyB2b2lkIDAgOiBvbkNsaWNrKGVkZ2UsIGV2ZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9uUG9pbnRlck92ZXI6IHBvaW50ZXJPdmVyLFxuICAgICAgICBvblBvaW50ZXJPdXQ6IHBvaW50ZXJPdXQsXG4gICAgICAgIG9uQ29udGV4dE1lbnU6ICgpID0+IHtcbiAgICAgICAgICBpZiAoIWRpc2FibGVkMikge1xuICAgICAgICAgICAgc2V0TWVudVZpc2libGUodHJ1ZSk7XG4gICAgICAgICAgICBvbkNvbnRleHRNZW51ID09IG51bGwgPyB2b2lkIDAgOiBvbkNvbnRleHRNZW51KGVkZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICksXG4gICAgYXJyb3dDb21wb25lbnQsXG4gICAgbGFiZWxDb21wb25lbnQsXG4gICAgbWVudUNvbXBvbmVudFxuICBdIH0pO1xufTtcbmNvbnN0IE5VTExfR0VPTUVUUlkgPSBuZXcgQm94R2VvbWV0cnkoMCwgMCwgMCk7XG5mdW5jdGlvbiB1c2VFZGdlR2VvbWV0cnkoYXJyb3dQbGFjZW1lbnQsIGludGVycG9sYXRpb24pIHtcbiAgY29uc3Qgc3RhdGVSZWYgPSB1c2VSZWYoKTtcbiAgY29uc3QgdGhlbWUgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnRoZW1lKTtcbiAgdXNlU3RvcmUoKHN0YXRlKSA9PiB7XG4gICAgc3RhdGVSZWYuY3VycmVudCA9IHN0YXRlO1xuICB9KTtcbiAgY29uc3QgZ2VvbWV0cnlDYWNoZVJlZiA9IHVzZVJlZigvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpKTtcbiAgdXNlUmVmKG5ldyBCb3hHZW9tZXRyeSgwLCAwLCAwKSk7XG4gIGNvbnN0IGJhc2VBcnJvd0dlb21ldHJ5UmVmID0gdXNlUmVmKCk7XG4gIGNvbnN0IGN1cnZlZCA9IGludGVycG9sYXRpb24gPT09IFwiY3VydmVkXCI7XG4gIGNvbnN0IGdldEdlb21ldHJpZXMgPSB1c2VDYWxsYmFjayhcbiAgICAoZWRnZXMpID0+IHtcbiAgICAgIGNvbnN0IGdlb21ldHJpZXMgPSBbXTtcbiAgICAgIGNvbnN0IGNhY2hlID0gZ2VvbWV0cnlDYWNoZVJlZi5jdXJyZW50O1xuICAgICAgY29uc3QgeyBub2RlcyB9ID0gc3RhdGVSZWYuY3VycmVudDtcbiAgICAgIGNvbnN0IG5vZGVzTWFwID0gbmV3IE1hcChub2Rlcy5tYXAoKG5vZGUpID0+IFtub2RlLmlkLCBub2RlXSkpO1xuICAgICAgY29uc3QgbGFiZWxGb250U2l6ZSA9IHRoZW1lLmVkZ2UubGFiZWwuZm9udFNpemU7XG4gICAgICBpZiAoYXJyb3dQbGFjZW1lbnQgIT09IFwibm9uZVwiICYmICFiYXNlQXJyb3dHZW9tZXRyeVJlZi5jdXJyZW50KSB7XG4gICAgICAgIGJhc2VBcnJvd0dlb21ldHJ5UmVmLmN1cnJlbnQgPSBuZXcgQ3lsaW5kZXJHZW9tZXRyeShcbiAgICAgICAgICAwLFxuICAgICAgICAgIDEsXG4gICAgICAgICAgMSxcbiAgICAgICAgICAyMCxcbiAgICAgICAgICAxLFxuICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGVkZ2VzLmZvckVhY2goKGVkZ2UpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQsIHNvdXJjZSwgc2l6ZSA9IDEgfSA9IGVkZ2U7XG4gICAgICAgIGNvbnN0IGZyb20gPSBub2Rlc01hcC5nZXQoc291cmNlKTtcbiAgICAgICAgY29uc3QgdG8gPSBub2Rlc01hcC5nZXQodGFyZ2V0KTtcbiAgICAgICAgaWYgKCFmcm9tIHx8ICF0bykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoYXNoID0gYCR7ZnJvbS5wb3NpdGlvbi54fSwke2Zyb20ucG9zaXRpb24ueX0sJHt0by5wb3NpdGlvbi54fSwke3RvLnBvc2l0aW9uLnl9LCR7c2l6ZX1gO1xuICAgICAgICBpZiAoY2FjaGUuaGFzKGhhc2gpKSB7XG4gICAgICAgICAgZ2VvbWV0cmllcy5wdXNoKGNhY2hlLmdldChoYXNoKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZyb21WZWN0b3IgPSBnZXRWZWN0b3IoZnJvbSk7XG4gICAgICAgIGNvbnN0IGZyb21PZmZzZXQgPSBmcm9tLnNpemUgKyBsYWJlbEZvbnRTaXplO1xuICAgICAgICBjb25zdCB0b1ZlY3RvciA9IGdldFZlY3Rvcih0byk7XG4gICAgICAgIGNvbnN0IHRvT2Zmc2V0ID0gdG8uc2l6ZSArIGxhYmVsRm9udFNpemU7XG4gICAgICAgIGxldCBjdXJ2ZSA9IGdldEN1cnZlKFxuICAgICAgICAgIGZyb21WZWN0b3IsXG4gICAgICAgICAgZnJvbU9mZnNldCxcbiAgICAgICAgICB0b1ZlY3RvcixcbiAgICAgICAgICB0b09mZnNldCxcbiAgICAgICAgICBjdXJ2ZWRcbiAgICAgICAgKTtcbiAgICAgICAgbGV0IGVkZ2VHZW9tZXRyeSA9IG5ldyBUdWJlR2VvbWV0cnkoY3VydmUsIDIwLCBzaXplIC8gMiwgNSwgZmFsc2UpO1xuICAgICAgICBpZiAoYXJyb3dQbGFjZW1lbnQgPT09IFwibm9uZVwiKSB7XG4gICAgICAgICAgZ2VvbWV0cmllcy5wdXNoKGVkZ2VHZW9tZXRyeSk7XG4gICAgICAgICAgY2FjaGUuc2V0KGhhc2gsIGVkZ2VHZW9tZXRyeSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IFthcnJvd0xlbmd0aCwgYXJyb3dTaXplXSA9IGdldEFycm93U2l6ZShzaXplKTtcbiAgICAgICAgY29uc3QgYXJyb3dHZW9tZXRyeSA9IGJhc2VBcnJvd0dlb21ldHJ5UmVmLmN1cnJlbnQuY2xvbmUoKTtcbiAgICAgICAgYXJyb3dHZW9tZXRyeS5zY2FsZShhcnJvd1NpemUsIGFycm93TGVuZ3RoLCBhcnJvd1NpemUpO1xuICAgICAgICBjb25zdCBbYXJyb3dQb3NpdGlvbiwgYXJyb3dSb3RhdGlvbl0gPSBnZXRBcnJvd1ZlY3RvcnMoXG4gICAgICAgICAgYXJyb3dQbGFjZW1lbnQsXG4gICAgICAgICAgY3VydmUsXG4gICAgICAgICAgYXJyb3dMZW5ndGhcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgcXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7XG4gICAgICAgIHF1YXRlcm5pb24uc2V0RnJvbVVuaXRWZWN0b3JzKG5ldyBWZWN0b3IzKDAsIDEsIDApLCBhcnJvd1JvdGF0aW9uKTtcbiAgICAgICAgYXJyb3dHZW9tZXRyeS5hcHBseVF1YXRlcm5pb24ocXVhdGVybmlvbik7XG4gICAgICAgIGFycm93R2VvbWV0cnkudHJhbnNsYXRlKFxuICAgICAgICAgIGFycm93UG9zaXRpb24ueCxcbiAgICAgICAgICBhcnJvd1Bvc2l0aW9uLnksXG4gICAgICAgICAgYXJyb3dQb3NpdGlvbi56XG4gICAgICAgICk7XG4gICAgICAgIGlmIChhcnJvd1BsYWNlbWVudCAmJiBhcnJvd1BsYWNlbWVudCA9PT0gXCJlbmRcIikge1xuICAgICAgICAgIGNvbnN0IGN1cnZlMiA9IGdldEN1cnZlKFxuICAgICAgICAgICAgZnJvbVZlY3RvcixcbiAgICAgICAgICAgIGZyb21PZmZzZXQsXG4gICAgICAgICAgICBhcnJvd1Bvc2l0aW9uLFxuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIGN1cnZlZFxuICAgICAgICAgICk7XG4gICAgICAgICAgZWRnZUdlb21ldHJ5ID0gbmV3IFR1YmVHZW9tZXRyeShjdXJ2ZTIsIDIwLCBzaXplIC8gMiwgNSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1lcmdlZCA9IG1lcmdlQnVmZmVyR2VvbWV0cmllcyhbZWRnZUdlb21ldHJ5LCBhcnJvd0dlb21ldHJ5XSk7XG4gICAgICAgIGdlb21ldHJpZXMucHVzaChtZXJnZWQpO1xuICAgICAgICBjYWNoZS5zZXQoaGFzaCwgbWVyZ2VkKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGdlb21ldHJpZXM7XG4gICAgfSxcbiAgICBbYXJyb3dQbGFjZW1lbnQsIGN1cnZlZCwgdGhlbWUuZWRnZS5sYWJlbC5mb250U2l6ZV1cbiAgKTtcbiAgY29uc3QgZ2V0R2VvbWV0cnkgPSB1c2VDYWxsYmFjayhcbiAgICAoYWN0aXZlLCBpbmFjdGl2ZSkgPT4ge1xuICAgICAgY29uc3QgYWN0aXZlR2VvbWV0cmllcyA9IGdldEdlb21ldHJpZXMoYWN0aXZlKTtcbiAgICAgIGNvbnN0IGluYWN0aXZlR2VvbWV0cmllcyA9IGdldEdlb21ldHJpZXMoaW5hY3RpdmUpO1xuICAgICAgcmV0dXJuIG1lcmdlQnVmZmVyR2VvbWV0cmllcyhcbiAgICAgICAgW1xuICAgICAgICAgIGluYWN0aXZlR2VvbWV0cmllcy5sZW5ndGggPyBtZXJnZUJ1ZmZlckdlb21ldHJpZXMoaW5hY3RpdmVHZW9tZXRyaWVzKSA6IE5VTExfR0VPTUVUUlksXG4gICAgICAgICAgYWN0aXZlR2VvbWV0cmllcy5sZW5ndGggPyBtZXJnZUJ1ZmZlckdlb21ldHJpZXMoYWN0aXZlR2VvbWV0cmllcykgOiBOVUxMX0dFT01FVFJZXG4gICAgICAgIF0sXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfSxcbiAgICBbZ2V0R2VvbWV0cmllc11cbiAgKTtcbiAgcmV0dXJuIHtcbiAgICBnZXRHZW9tZXRyaWVzLFxuICAgIGdldEdlb21ldHJ5XG4gIH07XG59XG5mdW5jdGlvbiB1c2VFZGdlRXZlbnRzKGV2ZW50cywgY29udGV4dE1lbnUsIGRpc2FibGVkMikge1xuICBjb25zdCBtZW1vaXplZEV2ZW50cyA9IHVzZVJlZihldmVudHMpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIG1lbW9pemVkRXZlbnRzLmN1cnJlbnQgPSBldmVudHM7XG4gIH0sIFtldmVudHNdKTtcbiAgY29uc3QgZWRnZUNvbnRleHRNZW51cyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuZWRnZUNvbnRleHRNZW51cyk7XG4gIGNvbnN0IHNldEVkZ2VDb250ZXh0TWVudXMgPSB1c2VTdG9yZShcbiAgICB1c2VDYWxsYmFjaygoc3RhdGUpID0+IHN0YXRlLnNldEVkZ2VDb250ZXh0TWVudXMsIFtdKVxuICApO1xuICBjb25zdCBjbGlja1JlZiA9IHVzZVJlZihmYWxzZSk7XG4gIGNvbnN0IGhhbmRsZUNsaWNrID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNsaWNrUmVmLmN1cnJlbnQgPSB0cnVlO1xuICB9LCBbXSk7XG4gIGNvbnN0IGNvbnRleHRNZW51RXZlbnRSZWYgPSB1c2VSZWYoZmFsc2UpO1xuICBjb25zdCBoYW5kbGVDb250ZXh0TWVudSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb250ZXh0TWVudUV2ZW50UmVmLmN1cnJlbnQgPSB0cnVlO1xuICB9LCBbXSk7XG4gIGNvbnN0IGhhbmRsZUludGVyc2VjdGlvbnMgPSB1c2VDYWxsYmFjayhcbiAgICAocHJldmlvdXMsIGludGVyc2VjdGVkKSA9PiB7XG4gICAgICBjb25zdCB7IG9uQ2xpY2ssIG9uQ29udGV4dE1lbnUsIG9uUG9pbnRlck92ZXIsIG9uUG9pbnRlck91dCB9ID0gbWVtb2l6ZWRFdmVudHMuY3VycmVudDtcbiAgICAgIGlmIChvbkNsaWNrICYmIGNsaWNrUmVmLmN1cnJlbnQgJiYgIWRpc2FibGVkMikge1xuICAgICAgICBjbGlja1JlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgIGZvciAoY29uc3QgZWRnZSBvZiBpbnRlcnNlY3RlZCkge1xuICAgICAgICAgIG9uQ2xpY2soZWRnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgoY29udGV4dE1lbnUgfHwgb25Db250ZXh0TWVudSkgJiYgY29udGV4dE1lbnVFdmVudFJlZi5jdXJyZW50ICYmICFkaXNhYmxlZDIpIHtcbiAgICAgICAgY29udGV4dE1lbnVFdmVudFJlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IG5ld0VkZ2VzID0gbmV3IFNldChlZGdlQ29udGV4dE1lbnVzKTtcbiAgICAgICAgbGV0IGhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgICAgICAgZm9yIChjb25zdCBlZGdlIG9mIGludGVyc2VjdGVkKSB7XG4gICAgICAgICAgaWYgKCFlZGdlQ29udGV4dE1lbnVzLmhhcyhlZGdlLmlkKSkge1xuICAgICAgICAgICAgbmV3RWRnZXMuYWRkKGVkZ2UuaWQpO1xuICAgICAgICAgICAgaGFzQ2hhbmdlcyA9IHRydWU7XG4gICAgICAgICAgICBvbkNvbnRleHRNZW51ID09IG51bGwgPyB2b2lkIDAgOiBvbkNvbnRleHRNZW51KGVkZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzQ2hhbmdlcykge1xuICAgICAgICAgIHNldEVkZ2VDb250ZXh0TWVudXMobmV3RWRnZXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAob25Qb2ludGVyT3Zlcikge1xuICAgICAgICBjb25zdCBvdmVyID0gaW50ZXJzZWN0ZWQuZmlsdGVyKChpbmRleCkgPT4gIXByZXZpb3VzLmluY2x1ZGVzKGluZGV4KSk7XG4gICAgICAgIG92ZXIuZm9yRWFjaCgoZWRnZSkgPT4ge1xuICAgICAgICAgIG9uUG9pbnRlck92ZXIoZWRnZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKG9uUG9pbnRlck91dCkge1xuICAgICAgICBjb25zdCBvdXQgPSBwcmV2aW91cy5maWx0ZXIoKGluZGV4KSA9PiAhaW50ZXJzZWN0ZWQuaW5jbHVkZXMoaW5kZXgpKTtcbiAgICAgICAgb3V0LmZvckVhY2goKGVkZ2UpID0+IHtcbiAgICAgICAgICBvblBvaW50ZXJPdXQoZWRnZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2NvbnRleHRNZW51LCBkaXNhYmxlZDIsIGVkZ2VDb250ZXh0TWVudXMsIHNldEVkZ2VDb250ZXh0TWVudXNdXG4gICk7XG4gIHJldHVybiB7XG4gICAgaGFuZGxlQ2xpY2ssXG4gICAgaGFuZGxlQ29udGV4dE1lbnUsXG4gICAgaGFuZGxlSW50ZXJzZWN0aW9uc1xuICB9O1xufVxuZnVuY3Rpb24gdXNlRWRnZVBvc2l0aW9uQW5pbWF0aW9uKGdlb21ldHJ5LCBhbmltYXRlZCkge1xuICBjb25zdCBnZW9tZXRyeVJlZiA9IHVzZVJlZihnZW9tZXRyeSk7XG4gIGNvbnN0IGJ1ZmZlclBvb2wgPSB1c2VSZWYoKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBnZW9tZXRyeVJlZi5jdXJyZW50ID0gZ2VvbWV0cnk7XG4gICAgY29uc3QgcG9zaXRpb25zID0gZ2VvbWV0cnkuZ2V0QXR0cmlidXRlKFwicG9zaXRpb25cIik7XG4gICAgYnVmZmVyUG9vbC5jdXJyZW50ID0gbmV3IEZsb2F0MzJBcnJheShwb3NpdGlvbnMuYXJyYXkubGVuZ3RoKTtcbiAgfSwgW2dlb21ldHJ5XSk7XG4gIGNvbnN0IGdldEFuaW1hdGlvblBvc2l0aW9ucyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb25zdCBwb3NpdGlvbnMgPSBnZW9tZXRyeVJlZi5jdXJyZW50LmdldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIpO1xuICAgIGNvbnN0IGZyb20gPSBuZXcgRmxvYXQzMkFycmF5KHBvc2l0aW9ucy5hcnJheS5sZW5ndGgpO1xuICAgIHJldHVybiB7XG4gICAgICBmcm9tLFxuICAgICAgdG86IHBvc2l0aW9ucy5hcnJheVxuICAgIH07XG4gIH0sIFtdKTtcbiAgY29uc3QgdXBkYXRlR2VvbWV0cnlQb3NpdGlvbiA9IHVzZUNhbGxiYWNrKChwb3NpdGlvbnMpID0+IHtcbiAgICBjb25zdCBidWZmZXIgPSBidWZmZXJQb29sLmN1cnJlbnQ7XG4gICAgYnVmZmVyLnNldChwb3NpdGlvbnMpO1xuICAgIGNvbnN0IG5ld1Bvc2l0aW9uID0gbmV3IEJ1ZmZlckF0dHJpYnV0ZShidWZmZXIsIDMsIGZhbHNlKTtcbiAgICBnZW9tZXRyeVJlZi5jdXJyZW50LnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsIG5ld1Bvc2l0aW9uKTtcbiAgICBuZXdQb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH0sIFtdKTtcbiAgdXNlU3ByaW5nKCgpID0+IHtcbiAgICBpZiAoIWFuaW1hdGVkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgYW5pbWF0aW9uUG9zaXRpb25zID0gZ2V0QW5pbWF0aW9uUG9zaXRpb25zKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZyb206IHtcbiAgICAgICAgcG9zaXRpb25zOiBhbmltYXRpb25Qb3NpdGlvbnMuZnJvbVxuICAgICAgfSxcbiAgICAgIHRvOiB7XG4gICAgICAgIHBvc2l0aW9uczogYW5pbWF0aW9uUG9zaXRpb25zLnRvXG4gICAgICB9LFxuICAgICAgb25DaGFuZ2U6IChldmVudCkgPT4ge1xuICAgICAgICB1cGRhdGVHZW9tZXRyeVBvc2l0aW9uKGV2ZW50LnZhbHVlLnBvc2l0aW9ucyk7XG4gICAgICB9LFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIC4uLmFuaW1hdGlvbkNvbmZpZyxcbiAgICAgICAgZHVyYXRpb246IGFuaW1hdGVkID8gdm9pZCAwIDogMFxuICAgICAgfVxuICAgIH07XG4gIH0sIFthbmltYXRlZCwgZ2V0QW5pbWF0aW9uUG9zaXRpb25zLCB1cGRhdGVHZW9tZXRyeVBvc2l0aW9uXSk7XG59XG5mdW5jdGlvbiB1c2VFZGdlT3BhY2l0eUFuaW1hdGlvbihhbmltYXRlZCwgaGFzU2VsZWN0aW9ucywgdGhlbWUpIHtcbiAgY29uc3QgW3sgYWN0aXZlT3BhY2l0eSwgaW5hY3RpdmVPcGFjaXR5IH1dID0gdXNlU3ByaW5nKCgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgZnJvbToge1xuICAgICAgICBhY3RpdmVPcGFjaXR5OiAwLFxuICAgICAgICBpbmFjdGl2ZU9wYWNpdHk6IDBcbiAgICAgIH0sXG4gICAgICB0bzoge1xuICAgICAgICBhY3RpdmVPcGFjaXR5OiBoYXNTZWxlY3Rpb25zID8gdGhlbWUuZWRnZS5zZWxlY3RlZE9wYWNpdHkgOiB0aGVtZS5lZGdlLm9wYWNpdHksXG4gICAgICAgIGluYWN0aXZlT3BhY2l0eTogaGFzU2VsZWN0aW9ucyA/IHRoZW1lLmVkZ2UuaW5hY3RpdmVPcGFjaXR5IDogdGhlbWUuZWRnZS5vcGFjaXR5XG4gICAgICB9LFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIC4uLmFuaW1hdGlvbkNvbmZpZyxcbiAgICAgICAgZHVyYXRpb246IGFuaW1hdGVkID8gdm9pZCAwIDogMFxuICAgICAgfVxuICAgIH07XG4gIH0sIFthbmltYXRlZCwgaGFzU2VsZWN0aW9ucywgdGhlbWVdKTtcbiAgcmV0dXJuIHsgYWN0aXZlT3BhY2l0eSwgaW5hY3RpdmVPcGFjaXR5IH07XG59XG5jb25zdCBFZGdlID0gKHtcbiAgYW5pbWF0ZWQsXG4gIGNvbG9yLFxuICBjb250ZXh0TWVudSxcbiAgZWRnZSxcbiAgbGFiZWxGb250VXJsLFxuICBsYWJlbFBsYWNlbWVudCA9IFwiaW5saW5lXCIsXG4gIG9wYWNpdHlcbn0pID0+IHtcbiAgY29uc3QgdGhlbWUgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnRoZW1lKTtcbiAgY29uc3QgeyB0YXJnZXQsIHNvdXJjZSwgbGFiZWwsIGxhYmVsVmlzaWJsZSA9IGZhbHNlLCBzaXplID0gMSB9ID0gZWRnZTtcbiAgY29uc3Qgbm9kZXMgPSB1c2VTdG9yZSgoc3RvcmUpID0+IHN0b3JlLm5vZGVzKTtcbiAgY29uc3QgW2Zyb20sIHRvXSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gW1xuICAgICAgbm9kZXMuZmluZCgobm9kZSkgPT4gbm9kZS5pZCA9PT0gc291cmNlKSxcbiAgICAgIG5vZGVzLmZpbmQoKG5vZGUpID0+IG5vZGUuaWQgPT09IHRhcmdldClcbiAgICBdLFxuICAgIFtub2Rlcywgc291cmNlLCB0YXJnZXRdXG4gICk7XG4gIGNvbnN0IGlzRHJhZ2dpbmcgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLmRyYWdnaW5nSWRzLmxlbmd0aCA+IDApO1xuICBjb25zdCBsYWJlbE9mZnNldCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHNpemUgKyB0aGVtZS5lZGdlLmxhYmVsLmZvbnRTaXplKSAvIDIsXG4gICAgW3NpemUsIHRoZW1lLmVkZ2UubGFiZWwuZm9udFNpemVdXG4gICk7XG4gIGNvbnN0IG1pZFBvaW50ID0gdXNlTWVtbyhcbiAgICAoKSA9PiBnZXRNaWRQb2ludChcbiAgICAgIGZyb20ucG9zaXRpb24sXG4gICAgICB0by5wb3NpdGlvbixcbiAgICAgIGdldExhYmVsT2Zmc2V0QnlUeXBlKGxhYmVsT2Zmc2V0LCBsYWJlbFBsYWNlbWVudClcbiAgICApLFxuICAgIFtmcm9tLnBvc2l0aW9uLCB0by5wb3NpdGlvbiwgbGFiZWxPZmZzZXQsIGxhYmVsUGxhY2VtZW50XVxuICApO1xuICBjb25zdCBlZGdlQ29udGV4dE1lbnVzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5lZGdlQ29udGV4dE1lbnVzKTtcbiAgY29uc3Qgc2V0RWRnZUNvbnRleHRNZW51cyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuc2V0RWRnZUNvbnRleHRNZW51cyk7XG4gIGNvbnN0IFt7IGxhYmVsUG9zaXRpb24gfV0gPSB1c2VTcHJpbmcoXG4gICAgKCkgPT4gKHtcbiAgICAgIGZyb206IHtcbiAgICAgICAgbGFiZWxQb3NpdGlvbjogWzAsIDAsIDBdXG4gICAgICB9LFxuICAgICAgdG86IHtcbiAgICAgICAgbGFiZWxQb3NpdGlvbjogW21pZFBvaW50LngsIG1pZFBvaW50LnksIG1pZFBvaW50LnpdXG4gICAgICB9LFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIC4uLmFuaW1hdGlvbkNvbmZpZyxcbiAgICAgICAgZHVyYXRpb246IGFuaW1hdGVkICYmICFpc0RyYWdnaW5nID8gdm9pZCAwIDogMFxuICAgICAgfVxuICAgIH0pLFxuICAgIFttaWRQb2ludCwgYW5pbWF0ZWQsIGlzRHJhZ2dpbmddXG4gICk7XG4gIGNvbnN0IHJlbW92ZUNvbnRleHRNZW51ID0gdXNlQ2FsbGJhY2soXG4gICAgKGVkZ2VJZCkgPT4ge1xuICAgICAgZWRnZUNvbnRleHRNZW51cy5kZWxldGUoZWRnZUlkKTtcbiAgICAgIHNldEVkZ2VDb250ZXh0TWVudXMobmV3IFNldChlZGdlQ29udGV4dE1lbnVzKSk7XG4gICAgfSxcbiAgICBbZWRnZUNvbnRleHRNZW51cywgc2V0RWRnZUNvbnRleHRNZW51c11cbiAgKTtcbiAgY29uc3QgbGFiZWxSb3RhdGlvbiA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGlmIChsYWJlbFBsYWNlbWVudCA9PT0gXCJuYXR1cmFsXCIpIHtcbiAgICAgIHJldHVybiBuZXcgRXVsZXIoMCwgMCwgMCk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgRXVsZXIoXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIE1hdGguYXRhbjIoXG4gICAgICAgIHRvLnBvc2l0aW9uLnkgLSBmcm9tLnBvc2l0aW9uLnksXG4gICAgICAgIHRvLnBvc2l0aW9uLnggLSBmcm9tLnBvc2l0aW9uLnhcbiAgICAgIClcbiAgICApO1xuICB9LCBbXG4gICAgbGFiZWxQbGFjZW1lbnQsXG4gICAgdG8ucG9zaXRpb24ueSxcbiAgICB0by5wb3NpdGlvbi54LFxuICAgIGZyb20ucG9zaXRpb24ueSxcbiAgICBmcm9tLnBvc2l0aW9uLnhcbiAgXSk7XG4gIGNvbnN0IGh0bWxQcm9wcyA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHtcbiAgICAgIHByZXBlbmQ6IHRydWUsXG4gICAgICBjZW50ZXI6IHRydWUsXG4gICAgICBwb3NpdGlvbjogbWlkUG9pbnRcbiAgICB9KSxcbiAgICBbbWlkUG9pbnRdXG4gICk7XG4gIGNvbnN0IGxhYmVsUHJvcHMgPSB1c2VNZW1vKFxuICAgICgpID0+ICh7XG4gICAgICB0ZXh0OiBsYWJlbCxcbiAgICAgIGVsbGlwc2lzOiAxNSxcbiAgICAgIGZvbnRVcmw6IGxhYmVsRm9udFVybCxcbiAgICAgIHN0cm9rZTogdGhlbWUuZWRnZS5sYWJlbC5zdHJva2UsXG4gICAgICBjb2xvcixcbiAgICAgIG9wYWNpdHksXG4gICAgICBmb250U2l6ZTogdGhlbWUuZWRnZS5sYWJlbC5mb250U2l6ZSxcbiAgICAgIHJvdGF0aW9uOiBsYWJlbFJvdGF0aW9uXG4gICAgfSksXG4gICAgW1xuICAgICAgbGFiZWwsXG4gICAgICBsYWJlbEZvbnRVcmwsXG4gICAgICB0aGVtZS5lZGdlLmxhYmVsLnN0cm9rZSxcbiAgICAgIGNvbG9yLFxuICAgICAgb3BhY2l0eSxcbiAgICAgIHRoZW1lLmVkZ2UubGFiZWwuZm9udFNpemUsXG4gICAgICBsYWJlbFJvdGF0aW9uXG4gICAgXVxuICApO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMoXCJncm91cFwiLCB7IGNoaWxkcmVuOiBbXG4gICAgbGFiZWxWaXNpYmxlICYmIGxhYmVsICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goYS5ncm91cCwgeyBwb3NpdGlvbjogbGFiZWxQb3NpdGlvbiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goTGFiZWwsIHsgLi4ubGFiZWxQcm9wcyB9KSB9KSxcbiAgICBjb250ZXh0TWVudSAmJiBlZGdlQ29udGV4dE1lbnVzLmhhcyhlZGdlLmlkKSAmJiAvKiBAX19QVVJFX18gKi8ganN4KEh0bWwsIHsgLi4uaHRtbFByb3BzLCBjaGlsZHJlbjogY29udGV4dE1lbnUoe1xuICAgICAgZGF0YTogZWRnZSxcbiAgICAgIG9uQ2xvc2U6ICgpID0+IHJlbW92ZUNvbnRleHRNZW51KGVkZ2UuaWQpXG4gICAgfSkgfSlcbiAgXSB9KTtcbn07XG5jb25zdCBFZGdlcyA9ICh7XG4gIGludGVycG9sYXRpb24gPSBcImxpbmVhclwiLFxuICBhcnJvd1BsYWNlbWVudCA9IFwiZW5kXCIsXG4gIGxhYmVsUGxhY2VtZW50ID0gXCJpbmxpbmVcIixcbiAgYW5pbWF0ZWQsXG4gIGNvbnRleHRNZW51LFxuICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICBlZGdlcyxcbiAgbGFiZWxGb250VXJsLFxuICBvbkNsaWNrLFxuICBvbkNvbnRleHRNZW51LFxuICBvblBvaW50ZXJPdXQsXG4gIG9uUG9pbnRlck92ZXJcbn0pID0+IHtcbiAgY29uc3QgdGhlbWUgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnRoZW1lKTtcbiAgY29uc3QgeyBnZXRHZW9tZXRyaWVzLCBnZXRHZW9tZXRyeSB9ID0gdXNlRWRnZUdlb21ldHJ5KFxuICAgIGFycm93UGxhY2VtZW50LFxuICAgIGludGVycG9sYXRpb25cbiAgKTtcbiAgY29uc3QgZHJhZ2dpbmdJZHMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLmRyYWdnaW5nSWRzKTtcbiAgY29uc3QgZWRnZU1lc2hlcyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuZWRnZU1lc2hlcyk7XG4gIGNvbnN0IHNldEVkZ2VNZXNoZXMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnNldEVkZ2VNZXNoZXMpO1xuICBjb25zdCBhY3RpdmVzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5hY3RpdmVzIHx8IFtdKTtcbiAgY29uc3Qgc2VsZWN0aW9ucyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuc2VsZWN0aW9ucyB8fCBbXSk7XG4gIGNvbnN0IFthY3RpdmUsIGluYWN0aXZlLCBkcmFnZ2luZ0FjdGl2ZSwgZHJhZ2dpbmdJbmFjdGl2ZV0gPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBhY3RpdmUyID0gW107XG4gICAgY29uc3QgaW5hY3RpdmUyID0gW107XG4gICAgY29uc3QgZHJhZ2dpbmdBY3RpdmUyID0gW107XG4gICAgY29uc3QgZHJhZ2dpbmdJbmFjdGl2ZTIgPSBbXTtcbiAgICBlZGdlcy5mb3JFYWNoKChlZGdlKSA9PiB7XG4gICAgICBpZiAoZHJhZ2dpbmdJZHMuaW5jbHVkZXMoZWRnZS5zb3VyY2UpIHx8IGRyYWdnaW5nSWRzLmluY2x1ZGVzKGVkZ2UudGFyZ2V0KSkge1xuICAgICAgICBpZiAoc2VsZWN0aW9ucy5pbmNsdWRlcyhlZGdlLmlkKSB8fCBhY3RpdmVzLmluY2x1ZGVzKGVkZ2UuaWQpKSB7XG4gICAgICAgICAgZHJhZ2dpbmdBY3RpdmUyLnB1c2goZWRnZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZHJhZ2dpbmdJbmFjdGl2ZTIucHVzaChlZGdlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoc2VsZWN0aW9ucy5pbmNsdWRlcyhlZGdlLmlkKSB8fCBhY3RpdmVzLmluY2x1ZGVzKGVkZ2UuaWQpKSB7XG4gICAgICAgIGFjdGl2ZTIucHVzaChlZGdlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGluYWN0aXZlMi5wdXNoKGVkZ2UpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBbYWN0aXZlMiwgaW5hY3RpdmUyLCBkcmFnZ2luZ0FjdGl2ZTIsIGRyYWdnaW5nSW5hY3RpdmUyXTtcbiAgfSwgW2VkZ2VzLCBhY3RpdmVzLCBzZWxlY3Rpb25zLCBkcmFnZ2luZ0lkc10pO1xuICBjb25zdCBoYXNTZWxlY3Rpb25zID0gISFzZWxlY3Rpb25zLmxlbmd0aDtcbiAgY29uc3Qgc3RhdGljRWRnZXNHZW9tZXRyeSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gZ2V0R2VvbWV0cnkoYWN0aXZlLCBpbmFjdGl2ZSksXG4gICAgW2dldEdlb21ldHJ5LCBhY3RpdmUsIGluYWN0aXZlXVxuICApO1xuICBjb25zdCB7IGFjdGl2ZU9wYWNpdHksIGluYWN0aXZlT3BhY2l0eSB9ID0gdXNlRWRnZU9wYWNpdHlBbmltYXRpb24oXG4gICAgYW5pbWF0ZWQsXG4gICAgaGFzU2VsZWN0aW9ucyxcbiAgICB0aGVtZVxuICApO1xuICB1c2VFZGdlUG9zaXRpb25BbmltYXRpb24oc3RhdGljRWRnZXNHZW9tZXRyeSwgYW5pbWF0ZWQpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChkcmFnZ2luZ0lkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IGVkZ2VHZW9tZXRyaWVzID0gZ2V0R2VvbWV0cmllcyhlZGdlcyk7XG4gICAgICBjb25zdCBlZGdlTWVzaGVzMiA9IGVkZ2VHZW9tZXRyaWVzLm1hcCgoZWRnZSkgPT4gbmV3IE1lc2goZWRnZSkpO1xuICAgICAgc2V0RWRnZU1lc2hlcyhlZGdlTWVzaGVzMik7XG4gICAgfVxuICB9LCBbZ2V0R2VvbWV0cmllcywgc2V0RWRnZU1lc2hlcywgZWRnZXMsIGRyYWdnaW5nSWRzLmxlbmd0aF0pO1xuICBjb25zdCBzdGF0aWNFZGdlc1JlZiA9IHVzZVJlZihuZXcgTWVzaCgpKTtcbiAgY29uc3QgZHluYW1pY0VkZ2VzUmVmID0gdXNlUmVmKG5ldyBNZXNoKCkpO1xuICBjb25zdCBpbnRlcnNlY3QgPSB1c2VDYWxsYmFjayhcbiAgICAocmF5Y2FzdGVyKSA9PiB7XG4gICAgICBpZiAoIXJheWNhc3Rlci5jYW1lcmEpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgY29uc3QgaW50ZXJzZWN0aW9ucyA9IHJheWNhc3Rlci5pbnRlcnNlY3RPYmplY3RzKGVkZ2VNZXNoZXMpO1xuICAgICAgaWYgKCFpbnRlcnNlY3Rpb25zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICByZXR1cm4gaW50ZXJzZWN0aW9ucy5tYXAoXG4gICAgICAgIChpbnRlcnNlY3Rpb24pID0+IGVkZ2VzW2VkZ2VNZXNoZXMuaW5kZXhPZihpbnRlcnNlY3Rpb24ub2JqZWN0KV1cbiAgICAgICk7XG4gICAgfSxcbiAgICBbZWRnZU1lc2hlcywgZWRnZXNdXG4gICk7XG4gIGNvbnN0IHsgaGFuZGxlQ2xpY2ssIGhhbmRsZUNvbnRleHRNZW51LCBoYW5kbGVJbnRlcnNlY3Rpb25zIH0gPSB1c2VFZGdlRXZlbnRzKFxuICAgIHtcbiAgICAgIG9uQ2xpY2ssXG4gICAgICBvbkNvbnRleHRNZW51LFxuICAgICAgb25Qb2ludGVyT3V0LFxuICAgICAgb25Qb2ludGVyT3ZlclxuICAgIH0sXG4gICAgY29udGV4dE1lbnUsXG4gICAgZGlzYWJsZWQyXG4gICk7XG4gIGNvbnN0IGRyYWdnaW5nSWRSZWYgPSB1c2VSZWYoW10pO1xuICBjb25zdCBpbnRlcnNlY3RpbmdSZWYgPSB1c2VSZWYoW10pO1xuICB1c2VGcmFtZSgoc3RhdGUpID0+IHtcbiAgICBzdGF0aWNFZGdlc1JlZi5jdXJyZW50Lmdlb21ldHJ5ID0gc3RhdGljRWRnZXNHZW9tZXRyeTtcbiAgICBpZiAoZGlzYWJsZWQyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHByZXZpb3VzRHJhZ2dpbmdJZCA9IGRyYWdnaW5nSWRSZWYuY3VycmVudDtcbiAgICBpZiAoZHJhZ2dpbmdJZHMubGVuZ3RoIHx8IGRyYWdnaW5nSWRzLmxlbmd0aCA9PT0gMCAmJiBwcmV2aW91c0RyYWdnaW5nSWQgIT09IG51bGwpIHtcbiAgICAgIGR5bmFtaWNFZGdlc1JlZi5jdXJyZW50Lmdlb21ldHJ5ID0gZ2V0R2VvbWV0cnkoXG4gICAgICAgIGRyYWdnaW5nQWN0aXZlLFxuICAgICAgICBkcmFnZ2luZ0luYWN0aXZlXG4gICAgICApO1xuICAgIH1cbiAgICBkcmFnZ2luZ0lkUmVmLmN1cnJlbnQgPSBkcmFnZ2luZ0lkcztcbiAgICBpZiAoZHJhZ2dpbmdJZHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHByZXZpb3VzSW50ZXJzZWN0aW5nID0gaW50ZXJzZWN0aW5nUmVmLmN1cnJlbnQ7XG4gICAgY29uc3QgaW50ZXJzZWN0aW5nID0gaW50ZXJzZWN0KHN0YXRlLnJheWNhc3Rlcik7XG4gICAgaGFuZGxlSW50ZXJzZWN0aW9ucyhwcmV2aW91c0ludGVyc2VjdGluZywgaW50ZXJzZWN0aW5nKTtcbiAgICBpZiAoaW50ZXJzZWN0aW5nLmpvaW4oKSAhPT0gcHJldmlvdXNJbnRlcnNlY3Rpbmcuam9pbigpKSB7XG4gICAgICBkeW5hbWljRWRnZXNSZWYuY3VycmVudC5nZW9tZXRyeSA9IGdldEdlb21ldHJ5KGludGVyc2VjdGluZywgW10pO1xuICAgIH1cbiAgICBpbnRlcnNlY3RpbmdSZWYuY3VycmVudCA9IGludGVyc2VjdGluZztcbiAgfSk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4cyhcImdyb3VwXCIsIHsgb25DbGljazogaGFuZGxlQ2xpY2ssIG9uQ29udGV4dE1lbnU6IGhhbmRsZUNvbnRleHRNZW51LCBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzKFwibWVzaFwiLCB7IHJlZjogc3RhdGljRWRnZXNSZWYsIGNoaWxkcmVuOiBbXG4gICAgICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICBhLm1lc2hCYXNpY01hdGVyaWFsLFxuICAgICAgICB7XG4gICAgICAgICAgYXR0YWNoOiBcIm1hdGVyaWFsLTBcIixcbiAgICAgICAgICBjb2xvcjogdGhlbWUuZWRnZS5maWxsLFxuICAgICAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICAgICAgZm9nOiB0cnVlLFxuICAgICAgICAgIG9wYWNpdHk6IGluYWN0aXZlT3BhY2l0eSxcbiAgICAgICAgICBzaWRlOiBEb3VibGVTaWRlLFxuICAgICAgICAgIHRyYW5zcGFyZW50OiB0cnVlXG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICBhLm1lc2hCYXNpY01hdGVyaWFsLFxuICAgICAgICB7XG4gICAgICAgICAgYXR0YWNoOiBcIm1hdGVyaWFsLTFcIixcbiAgICAgICAgICBjb2xvcjogdGhlbWUuZWRnZS5hY3RpdmVGaWxsLFxuICAgICAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICAgICAgZm9nOiB0cnVlLFxuICAgICAgICAgIG9wYWNpdHk6IGFjdGl2ZU9wYWNpdHksXG4gICAgICAgICAgc2lkZTogRG91YmxlU2lkZSxcbiAgICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgICAgICB9XG4gICAgICApXG4gICAgXSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4cyhcIm1lc2hcIiwgeyByZWY6IGR5bmFtaWNFZGdlc1JlZiwgY2hpbGRyZW46IFtcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgIGEubWVzaEJhc2ljTWF0ZXJpYWwsXG4gICAgICAgIHtcbiAgICAgICAgICBhdHRhY2g6IFwibWF0ZXJpYWwtMFwiLFxuICAgICAgICAgIGNvbG9yOiB0aGVtZS5lZGdlLmZpbGwsXG4gICAgICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgICAgICBmb2c6IHRydWUsXG4gICAgICAgICAgb3BhY2l0eTogaW5hY3RpdmVPcGFjaXR5LFxuICAgICAgICAgIHNpZGU6IERvdWJsZVNpZGUsXG4gICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgIGEubWVzaEJhc2ljTWF0ZXJpYWwsXG4gICAgICAgIHtcbiAgICAgICAgICBhdHRhY2g6IFwibWF0ZXJpYWwtMVwiLFxuICAgICAgICAgIGNvbG9yOiB0aGVtZS5lZGdlLmFjdGl2ZUZpbGwsXG4gICAgICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgICAgICBmb2c6IHRydWUsXG4gICAgICAgICAgb3BhY2l0eTogYWN0aXZlT3BhY2l0eSxcbiAgICAgICAgICBzaWRlOiBEb3VibGVTaWRlLFxuICAgICAgICAgIHRyYW5zcGFyZW50OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIClcbiAgICBdIH0pLFxuICAgIGVkZ2VzLm1hcCgoZWRnZSkgPT4gLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgIEVkZ2UsXG4gICAgICB7XG4gICAgICAgIGFuaW1hdGVkLFxuICAgICAgICBjb250ZXh0TWVudSxcbiAgICAgICAgY29sb3I6IHRoZW1lLmVkZ2UubGFiZWwuY29sb3IsXG4gICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gICAgICAgIGVkZ2UsXG4gICAgICAgIGxhYmVsRm9udFVybCxcbiAgICAgICAgbGFiZWxQbGFjZW1lbnRcbiAgICAgIH0sXG4gICAgICBlZGdlLmlkXG4gICAgKSlcbiAgXSB9KTtcbn07XG5jb25zdCBSaW5nID0gKHtcbiAgb3V0ZXJSYWRpdXMsXG4gIGlubmVyUmFkaXVzLFxuICBwYWRkaW5nLFxuICBub3JtYWxpemVkRmlsbCxcbiAgbm9ybWFsaXplZFN0cm9rZSxcbiAgb3BhY2l0eSxcbiAgYW5pbWF0ZWQsXG4gIHRoZW1lXG59KSA9PiB7XG4gIHZhciBfYTI7XG4gIGNvbnN0IHsgb3BhY2l0eTogc3ByaW5nT3BhY2l0eSB9ID0gdXNlU3ByaW5nKHtcbiAgICBmcm9tOiB7IG9wYWNpdHk6IDAgfSxcbiAgICB0bzogeyBvcGFjaXR5IH0sXG4gICAgY29uZmlnOiB7XG4gICAgICAuLi5hbmltYXRpb25Db25maWcsXG4gICAgICBkdXJhdGlvbjogYW5pbWF0ZWQgPyB2b2lkIDAgOiAwXG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeHMoXCJtZXNoXCIsIHsgY2hpbGRyZW46IFtcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goXCJyaW5nR2VvbWV0cnlcIiwgeyBhdHRhY2g6IFwiZ2VvbWV0cnlcIiwgYXJnczogW291dGVyUmFkaXVzLCAwLCAxMjhdIH0pLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgYS5tZXNoQmFzaWNNYXRlcmlhbCxcbiAgICAgICAge1xuICAgICAgICAgIGF0dGFjaDogXCJtYXRlcmlhbFwiLFxuICAgICAgICAgIGNvbG9yOiBub3JtYWxpemVkRmlsbCxcbiAgICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgICAgICBkZXB0aFRlc3Q6IGZhbHNlLFxuICAgICAgICAgIG9wYWNpdHk6ICgoX2EyID0gdGhlbWUuY2x1c3RlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5maWxsKSA/IHNwcmluZ09wYWNpdHkgOiAwLFxuICAgICAgICAgIHNpZGU6IERvdWJsZVNpZGUsXG4gICAgICAgICAgZm9nOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIClcbiAgICBdIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzKFwibWVzaFwiLCB7IGNoaWxkcmVuOiBbXG4gICAgICAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICBcInJpbmdHZW9tZXRyeVwiLFxuICAgICAgICB7XG4gICAgICAgICAgYXR0YWNoOiBcImdlb21ldHJ5XCIsXG4gICAgICAgICAgYXJnczogW291dGVyUmFkaXVzLCBpbm5lclJhZGl1cyArIHBhZGRpbmcsIDEyOF1cbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgIGEubWVzaEJhc2ljTWF0ZXJpYWwsXG4gICAgICAgIHtcbiAgICAgICAgICBhdHRhY2g6IFwibWF0ZXJpYWxcIixcbiAgICAgICAgICBjb2xvcjogbm9ybWFsaXplZFN0cm9rZSxcbiAgICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgICAgICBkZXB0aFRlc3Q6IGZhbHNlLFxuICAgICAgICAgIG9wYWNpdHk6IHNwcmluZ09wYWNpdHksXG4gICAgICAgICAgc2lkZTogRG91YmxlU2lkZSxcbiAgICAgICAgICBmb2c6IHRydWVcbiAgICAgICAgfVxuICAgICAgKVxuICAgIF0gfSlcbiAgXSB9KTtcbn07XG5jb25zdCBDbHVzdGVyID0gKHtcbiAgYW5pbWF0ZWQsXG4gIHBvc2l0aW9uLFxuICBwYWRkaW5nID0gNDAsXG4gIGxhYmVsRm9udFVybCxcbiAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgcmFkaXVzID0gMixcbiAgbm9kZXMsXG4gIGxhYmVsLFxuICBvbkNsaWNrLFxuICBvblBvaW50ZXJPdmVyLFxuICBvblBvaW50ZXJPdXQsXG4gIGRyYWdnYWJsZSA9IGZhbHNlLFxuICBvbkRyYWdnZWQsXG4gIG9uUmVuZGVyXG59KSA9PiB7XG4gIHZhciBfYTIsIF9iMiwgX2MsIF9kLCBfZSwgX2YsIF9nO1xuICBjb25zdCB0aGVtZSA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUudGhlbWUpO1xuICBjb25zdCByYWQgPSBNYXRoLm1heChwb3NpdGlvbi53aWR0aCwgcG9zaXRpb24uaGVpZ2h0KSAvIDI7XG4gIGNvbnN0IG9mZnNldCA9IHJhZCAtIHJhZGl1cyArIHBhZGRpbmc7XG4gIGNvbnN0IFthY3RpdmUsIHNldEFjdGl2ZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGNlbnRlciA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuY2VudGVyUG9zaXRpb24pO1xuICBjb25zdCBub2Rlc1N0YXRlID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5ub2Rlcyk7XG4gIGNvbnN0IGNhbWVyYUNvbnRyb2xzID0gdXNlQ2FtZXJhQ29udHJvbHMoKTtcbiAgY29uc3QgZHJhZ2dpbmdJZHMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLmRyYWdnaW5nSWRzKTtcbiAgY29uc3QgaXNEcmFnZ2luZ0N1cnJlbnQgPSBkcmFnZ2luZ0lkcy5pbmNsdWRlcyhsYWJlbCk7XG4gIGNvbnN0IGlzRHJhZ2dpbmcgPSBkcmFnZ2luZ0lkcy5sZW5ndGggPiAwO1xuICBjb25zdCBpc0FjdGl2ZSA9IHVzZVN0b3JlKFxuICAgIChzdGF0ZSkgPT4ge1xuICAgICAgdmFyIF9hMztcbiAgICAgIHJldHVybiAoX2EzID0gc3RhdGUuYWN0aXZlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5zb21lKChpZCkgPT4gbm9kZXMuc29tZSgobikgPT4gbi5pZCA9PT0gaWQpKTtcbiAgICB9XG4gICk7XG4gIGNvbnN0IGhvdmVyZWROb2RlSWQgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLmhvdmVyZWROb2RlSWQpO1xuICBjb25zdCBpc1NlbGVjdGVkID0gdXNlU3RvcmUoXG4gICAgKHN0YXRlKSA9PiB7XG4gICAgICB2YXIgX2EzO1xuICAgICAgcmV0dXJuIChfYTMgPSBzdGF0ZS5zZWxlY3Rpb25zKSA9PSBudWxsID8gdm9pZCAwIDogX2EzLnNvbWUoKGlkKSA9PiBub2Rlcy5zb21lKChuKSA9PiBuLmlkID09PSBpZCkpO1xuICAgIH1cbiAgKTtcbiAgY29uc3QgaGFzU2VsZWN0aW9ucyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4ge1xuICAgIHZhciBfYTM7XG4gICAgcmV0dXJuICgoX2EzID0gc3RhdGUuc2VsZWN0aW9ucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5sZW5ndGgpID4gMDtcbiAgfSk7XG4gIGNvbnN0IG9wYWNpdHkgPSBoYXNTZWxlY3Rpb25zID8gaXNTZWxlY3RlZCB8fCBhY3RpdmUgfHwgaXNBY3RpdmUgPyAoX2EyID0gdGhlbWUuY2x1c3RlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5zZWxlY3RlZE9wYWNpdHkgOiAoX2IyID0gdGhlbWUuY2x1c3RlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9iMi5pbmFjdGl2ZU9wYWNpdHkgOiAoX2MgPSB0aGVtZS5jbHVzdGVyKSA9PSBudWxsID8gdm9pZCAwIDogX2Mub3BhY2l0eTtcbiAgY29uc3QgbGFiZWxQb3NpdGlvbiA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHZhciBfYTMsIF9iMztcbiAgICBjb25zdCBkZWZhdWx0UG9zaXRpb24gPSBbMCwgLW9mZnNldCwgMl07XG4gICAgY29uc3QgdGhlbWVPZmZzZXQgPSAoX2IzID0gKF9hMyA9IHRoZW1lLmNsdXN0ZXIpID09IG51bGwgPyB2b2lkIDAgOiBfYTMubGFiZWwpID09IG51bGwgPyB2b2lkIDAgOiBfYjMub2Zmc2V0O1xuICAgIGlmICh0aGVtZU9mZnNldCkge1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgZGVmYXVsdFBvc2l0aW9uWzBdIC0gdGhlbWVPZmZzZXRbMF0sXG4gICAgICAgIGRlZmF1bHRQb3NpdGlvblsxXSAtIHRoZW1lT2Zmc2V0WzFdLFxuICAgICAgICBkZWZhdWx0UG9zaXRpb25bMl0gLSB0aGVtZU9mZnNldFsyXVxuICAgICAgXTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRQb3NpdGlvbjtcbiAgfSwgW29mZnNldCwgKF9lID0gKF9kID0gdGhlbWUuY2x1c3RlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9kLmxhYmVsKSA9PSBudWxsID8gdm9pZCAwIDogX2Uub2Zmc2V0XSk7XG4gIGNvbnN0IHsgY2lyY2xlUG9zaXRpb24gfSA9IHVzZVNwcmluZyh7XG4gICAgZnJvbToge1xuICAgICAgY2lyY2xlUG9zaXRpb246IFtjZW50ZXIueCwgY2VudGVyLnksIC0xXVxuICAgIH0sXG4gICAgdG86IHtcbiAgICAgIGNpcmNsZVBvc2l0aW9uOiBwb3NpdGlvbiA/IFtwb3NpdGlvbi54LCBwb3NpdGlvbi55LCAtMV0gOiBbMCwgMCwgLTFdXG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIC4uLmFuaW1hdGlvbkNvbmZpZyxcbiAgICAgIGR1cmF0aW9uOiBhbmltYXRlZCAmJiAhaXNEcmFnZ2luZyA/IHZvaWQgMCA6IDBcbiAgICB9XG4gIH0pO1xuICBjb25zdCBub3JtYWxpemVkU3Ryb2tlID0gdXNlTWVtbyhcbiAgICAoKSA9PiB7XG4gICAgICB2YXIgX2EzO1xuICAgICAgcmV0dXJuIG5ldyBDb2xvcigoX2EzID0gdGhlbWUuY2x1c3RlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5zdHJva2UpO1xuICAgIH0sXG4gICAgWyhfZiA9IHRoZW1lLmNsdXN0ZXIpID09IG51bGwgPyB2b2lkIDAgOiBfZi5zdHJva2VdXG4gICk7XG4gIGNvbnN0IG5vcm1hbGl6ZWRGaWxsID0gdXNlTWVtbyhcbiAgICAoKSA9PiB7XG4gICAgICB2YXIgX2EzO1xuICAgICAgcmV0dXJuIG5ldyBDb2xvcigoX2EzID0gdGhlbWUuY2x1c3RlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5maWxsKTtcbiAgICB9LFxuICAgIFsoX2cgPSB0aGVtZS5jbHVzdGVyKSA9PSBudWxsID8gdm9pZCAwIDogX2cuZmlsbF1cbiAgKTtcbiAgY29uc3QgYWRkRHJhZ2dpbmdJZCA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuYWRkRHJhZ2dpbmdJZCk7XG4gIGNvbnN0IHJlbW92ZURyYWdnaW5nSWQgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnJlbW92ZURyYWdnaW5nSWQpO1xuICBjb25zdCBzZXRDbHVzdGVyUG9zaXRpb24gPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLnNldENsdXN0ZXJQb3NpdGlvbik7XG4gIGNvbnN0IGJpbmQgPSB1c2VEcmFnKHtcbiAgICBkcmFnZ2FibGU6IGRyYWdnYWJsZSAmJiAhaG92ZXJlZE5vZGVJZCxcbiAgICBwb3NpdGlvbjoge1xuICAgICAgeDogcG9zaXRpb24ueCxcbiAgICAgIHk6IHBvc2l0aW9uLnksXG4gICAgICB6OiAtMVxuICAgIH0sXG4gICAgc2V0OiAocG9zKSA9PiBzZXRDbHVzdGVyUG9zaXRpb24obGFiZWwsIHBvcyksXG4gICAgb25EcmFnU3RhcnQ6ICgpID0+IHtcbiAgICAgIGFkZERyYWdnaW5nSWQobGFiZWwpO1xuICAgICAgc2V0QWN0aXZlKHRydWUpO1xuICAgIH0sXG4gICAgb25EcmFnRW5kOiAoKSA9PiB7XG4gICAgICByZW1vdmVEcmFnZ2luZ0lkKGxhYmVsKTtcbiAgICAgIHNldEFjdGl2ZShmYWxzZSk7XG4gICAgICBjb25zdCB1cGRhdGVkQ2x1c3Rlck5vZGVzID0gbm9kZXNTdGF0ZS5maWx0ZXIoKG4pID0+IG4uY2x1c3RlciA9PT0gbGFiZWwpO1xuICAgICAgb25EcmFnZ2VkID09IG51bGwgPyB2b2lkIDAgOiBvbkRyYWdnZWQoeyBub2RlczogdXBkYXRlZENsdXN0ZXJOb2RlcywgbGFiZWwgfSk7XG4gICAgfVxuICB9KTtcbiAgdXNlQ3Vyc29yKGFjdGl2ZSAmJiAhaXNEcmFnZ2luZyAmJiBvbkNsaWNrICE9PSB2b2lkIDAsIFwicG9pbnRlclwiKTtcbiAgdXNlQ3Vyc29yKFxuICAgIGFjdGl2ZSAmJiBkcmFnZ2FibGUgJiYgIWlzRHJhZ2dpbmdDdXJyZW50ICYmIG9uQ2xpY2sgPT09IHZvaWQgMCxcbiAgICBcImdyYWJcIlxuICApO1xuICB1c2VDdXJzb3IoaXNEcmFnZ2luZ0N1cnJlbnQsIFwiZ3JhYmJpbmdcIik7XG4gIGNvbnN0IHsgcG9pbnRlck92ZXIsIHBvaW50ZXJPdXQgfSA9IHVzZUhvdmVySW50ZW50KHtcbiAgICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICAgIG9uUG9pbnRlck92ZXI6IChldmVudCkgPT4ge1xuICAgICAgc2V0QWN0aXZlKHRydWUpO1xuICAgICAgY2FtZXJhQ29udHJvbHMuZnJlZXplKCk7XG4gICAgICBvblBvaW50ZXJPdmVyID09IG51bGwgPyB2b2lkIDAgOiBvblBvaW50ZXJPdmVyKFxuICAgICAgICB7XG4gICAgICAgICAgbm9kZXMsXG4gICAgICAgICAgbGFiZWxcbiAgICAgICAgfSxcbiAgICAgICAgZXZlbnRcbiAgICAgICk7XG4gICAgfSxcbiAgICBvblBvaW50ZXJPdXQ6IChldmVudCkgPT4ge1xuICAgICAgc2V0QWN0aXZlKGZhbHNlKTtcbiAgICAgIGNhbWVyYUNvbnRyb2xzLnVuRnJlZXplKCk7XG4gICAgICBvblBvaW50ZXJPdXQgPT0gbnVsbCA/IHZvaWQgMCA6IG9uUG9pbnRlck91dChcbiAgICAgICAge1xuICAgICAgICAgIG5vZGVzLFxuICAgICAgICAgIGxhYmVsXG4gICAgICAgIH0sXG4gICAgICAgIGV2ZW50XG4gICAgICApO1xuICAgIH1cbiAgfSk7XG4gIGNvbnN0IGNsdXN0ZXIgPSB1c2VNZW1vKFxuICAgICgpID0+IHtcbiAgICAgIHZhciBfYTMsIF9iMywgX2MyO1xuICAgICAgcmV0dXJuIHRoZW1lLmNsdXN0ZXIgJiYgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgYS5ncm91cCxcbiAgICAgICAge1xuICAgICAgICAgIHVzZXJEYXRhOiB7IGlkOiBsYWJlbCwgdHlwZTogXCJjbHVzdGVyXCIgfSxcbiAgICAgICAgICBwb3NpdGlvbjogY2lyY2xlUG9zaXRpb24sXG4gICAgICAgICAgb25Qb2ludGVyT3ZlcjogcG9pbnRlck92ZXIsXG4gICAgICAgICAgb25Qb2ludGVyT3V0OiBwb2ludGVyT3V0LFxuICAgICAgICAgIG9uQ2xpY2s6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFkaXNhYmxlZDIgJiYgIWlzRHJhZ2dpbmdDdXJyZW50KSB7XG4gICAgICAgICAgICAgIG9uQ2xpY2sgPT0gbnVsbCA/IHZvaWQgMCA6IG9uQ2xpY2soeyBub2RlcywgbGFiZWwgfSwgZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgLi4uYmluZCgpLFxuICAgICAgICAgIGNoaWxkcmVuOiBvblJlbmRlciA/IG9uUmVuZGVyKHtcbiAgICAgICAgICAgIGxhYmVsOiB7XG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBsYWJlbFBvc2l0aW9uLFxuICAgICAgICAgICAgICB0ZXh0OiBsYWJlbCxcbiAgICAgICAgICAgICAgb3BhY2l0eSxcbiAgICAgICAgICAgICAgZm9udFVybDogbGFiZWxGb250VXJsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb3BhY2l0eSxcbiAgICAgICAgICAgIG91dGVyUmFkaXVzOiBvZmZzZXQsXG4gICAgICAgICAgICBpbm5lclJhZGl1czogcmFkLFxuICAgICAgICAgICAgcGFkZGluZyxcbiAgICAgICAgICAgIHRoZW1lXG4gICAgICAgICAgfSkgOiAvKiBAX19QVVJFX18gKi8ganN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW1xuICAgICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgICAgICAgUmluZyxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG91dGVyUmFkaXVzOiBvZmZzZXQsXG4gICAgICAgICAgICAgICAgaW5uZXJSYWRpdXM6IHJhZCxcbiAgICAgICAgICAgICAgICBwYWRkaW5nLFxuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRGaWxsLFxuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRTdHJva2UsXG4gICAgICAgICAgICAgICAgb3BhY2l0eSxcbiAgICAgICAgICAgICAgICBhbmltYXRlZCxcbiAgICAgICAgICAgICAgICB0aGVtZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgKChfYTMgPSB0aGVtZS5jbHVzdGVyKSA9PSBudWxsID8gdm9pZCAwIDogX2EzLmxhYmVsKSAmJiAvKiBAX19QVVJFX18gKi8ganN4KGEuZ3JvdXAsIHsgcG9zaXRpb246IGxhYmVsUG9zaXRpb24sIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICAgICAgICBMYWJlbCxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRleHQ6IGxhYmVsLFxuICAgICAgICAgICAgICAgIG9wYWNpdHksXG4gICAgICAgICAgICAgICAgZm9udFVybDogbGFiZWxGb250VXJsLFxuICAgICAgICAgICAgICAgIHN0cm9rZTogdGhlbWUuY2x1c3Rlci5sYWJlbC5zdHJva2UsXG4gICAgICAgICAgICAgICAgYWN0aXZlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjb2xvcjogKF9iMyA9IHRoZW1lLmNsdXN0ZXIpID09IG51bGwgPyB2b2lkIDAgOiBfYjMubGFiZWwuY29sb3IsXG4gICAgICAgICAgICAgICAgZm9udFNpemU6ICgoX2MyID0gdGhlbWUuY2x1c3RlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9jMi5sYWJlbC5mb250U2l6ZSkgPz8gMTJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKSB9KVxuICAgICAgICAgIF0gfSlcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9LFxuICAgIFtcbiAgICAgIHRoZW1lLFxuICAgICAgY2lyY2xlUG9zaXRpb24sXG4gICAgICBwb2ludGVyT3ZlcixcbiAgICAgIHBvaW50ZXJPdXQsXG4gICAgICBvZmZzZXQsXG4gICAgICBub3JtYWxpemVkRmlsbCxcbiAgICAgIHJhZCxcbiAgICAgIHBhZGRpbmcsXG4gICAgICBub3JtYWxpemVkU3Ryb2tlLFxuICAgICAgbGFiZWxQb3NpdGlvbixcbiAgICAgIGxhYmVsLFxuICAgICAgb3BhY2l0eSxcbiAgICAgIGxhYmVsRm9udFVybCxcbiAgICAgIGRpc2FibGVkMixcbiAgICAgIG9uQ2xpY2ssXG4gICAgICBub2RlcyxcbiAgICAgIGJpbmQsXG4gICAgICBpc0RyYWdnaW5nQ3VycmVudCxcbiAgICAgIG9uUmVuZGVyLFxuICAgICAgYW5pbWF0ZWRcbiAgICBdXG4gICk7XG4gIHJldHVybiBjbHVzdGVyO1xufTtcbmNvbnN0IEdyYXBoU2NlbmUgPSBmb3J3YXJkUmVmKFxuICAoe1xuICAgIG9uTm9kZUNsaWNrLFxuICAgIG9uTm9kZURvdWJsZUNsaWNrLFxuICAgIG9uTm9kZUNvbnRleHRNZW51LFxuICAgIG9uRWRnZUNvbnRleHRNZW51LFxuICAgIG9uRWRnZUNsaWNrLFxuICAgIG9uRWRnZVBvaW50ZXJPdmVyLFxuICAgIG9uRWRnZVBvaW50ZXJPdXQsXG4gICAgb25Ob2RlUG9pbnRlck92ZXIsXG4gICAgb25Ob2RlUG9pbnRlck91dCxcbiAgICBvbkNsdXN0ZXJDbGljayxcbiAgICBvbk5vZGVEcmFnZ2VkLFxuICAgIG9uQ2x1c3RlckRyYWdnZWQsXG4gICAgb25DbHVzdGVyUG9pbnRlck92ZXIsXG4gICAgb25DbHVzdGVyUG9pbnRlck91dCxcbiAgICBjb250ZXh0TWVudSxcbiAgICBhbmltYXRlZCxcbiAgICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICAgIGRyYWdnYWJsZSxcbiAgICBjb25zdHJhaW5EcmFnZ2luZyA9IGZhbHNlLFxuICAgIGVkZ2VMYWJlbFBvc2l0aW9uLFxuICAgIGVkZ2VBcnJvd1Bvc2l0aW9uLFxuICAgIGVkZ2VJbnRlcnBvbGF0aW9uID0gXCJsaW5lYXJcIixcbiAgICBsYWJlbEZvbnRVcmwsXG4gICAgcmVuZGVyTm9kZSxcbiAgICBvblJlbmRlckNsdXN0ZXIsXG4gICAgLi4ucmVzdFxuICB9LCByZWYpID0+IHtcbiAgICBjb25zdCB7IGxheW91dFR5cGUsIGNsdXN0ZXJBdHRyaWJ1dGUgfSA9IHJlc3Q7XG4gICAgY29uc3QgZ2wgPSB1c2VUaHJlZSgoc3RhdGUpID0+IHN0YXRlLmdsKTtcbiAgICBjb25zdCBzY2VuZSA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuc2NlbmUpO1xuICAgIGNvbnN0IGNhbWVyYSA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuY2FtZXJhKTtcbiAgICBjb25zdCB7IHVwZGF0ZUxheW91dCB9ID0gdXNlR3JhcGgoeyAuLi5yZXN0LCBjb25zdHJhaW5EcmFnZ2luZyB9KTtcbiAgICBpZiAoY2x1c3RlckF0dHJpYnV0ZSAmJiAhKGxheW91dFR5cGUgPT09IFwiZm9yY2VEaXJlY3RlZDJkXCIgfHwgbGF5b3V0VHlwZSA9PT0gXCJmb3JjZURpcmVjdGVkM2RcIikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJDbHVzdGVyaW5nIGlzIG9ubHkgc3VwcG9ydGVkIGZvciB0aGUgZm9yY2UgZGlyZWN0ZWQgbGF5b3V0cy5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgZ3JhcGggPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLmdyYXBoKTtcbiAgICBjb25zdCBub2RlcyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUubm9kZXMpO1xuICAgIGNvbnN0IGVkZ2VzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5lZGdlcyk7XG4gICAgY29uc3QgY2x1c3RlcnMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IFsuLi5zdGF0ZS5jbHVzdGVycy52YWx1ZXMoKV0pO1xuICAgIGNvbnN0IHsgY2VudGVyTm9kZXNCeUlkLCBmaXROb2Rlc0luVmlld0J5SWQsIGlzQ2VudGVyZWQgfSA9IHVzZUNlbnRlckdyYXBoKHtcbiAgICAgIGFuaW1hdGVkLFxuICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgICAgIGxheW91dFR5cGVcbiAgICB9KTtcbiAgICB1c2VJbXBlcmF0aXZlSGFuZGxlKFxuICAgICAgcmVmLFxuICAgICAgKCkgPT4gKHtcbiAgICAgICAgY2VudGVyR3JhcGg6IGNlbnRlck5vZGVzQnlJZCxcbiAgICAgICAgZml0Tm9kZXNJblZpZXc6IGZpdE5vZGVzSW5WaWV3QnlJZCxcbiAgICAgICAgZ3JhcGgsXG4gICAgICAgIHJlbmRlclNjZW5lOiAoKSA9PiBnbC5yZW5kZXIoc2NlbmUsIGNhbWVyYSlcbiAgICAgIH0pLFxuICAgICAgW2NlbnRlck5vZGVzQnlJZCwgZml0Tm9kZXNJblZpZXdCeUlkLCBncmFwaCwgZ2wsIHNjZW5lLCBjYW1lcmFdXG4gICAgKTtcbiAgICBjb25zdCBvbk5vZGVEcmFnZ2VkSGFuZGxlciA9IHVzZUNhbGxiYWNrKFxuICAgICAgKG5vZGUpID0+IHtcbiAgICAgICAgb25Ob2RlRHJhZ2dlZCA9PSBudWxsID8gdm9pZCAwIDogb25Ob2RlRHJhZ2dlZChub2RlKTtcbiAgICAgICAgaWYgKGNsdXN0ZXJBdHRyaWJ1dGUpIHtcbiAgICAgICAgICB1cGRhdGVMYXlvdXQoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIFtjbHVzdGVyQXR0cmlidXRlLCBvbk5vZGVEcmFnZ2VkLCB1cGRhdGVMYXlvdXRdXG4gICAgKTtcbiAgICBjb25zdCBub2RlQ29tcG9uZW50cyA9IHVzZU1lbW8oXG4gICAgICAoKSA9PiBub2Rlcy5tYXAoKG4pID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgIE5vZGUsXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogbiA9PSBudWxsID8gdm9pZCAwIDogbi5pZCxcbiAgICAgICAgICBsYWJlbEZvbnRVcmwsXG4gICAgICAgICAgZHJhZ2dhYmxlLFxuICAgICAgICAgIGNvbnN0cmFpbkRyYWdnaW5nLFxuICAgICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gICAgICAgICAgYW5pbWF0ZWQsXG4gICAgICAgICAgY29udGV4dE1lbnUsXG4gICAgICAgICAgcmVuZGVyTm9kZSxcbiAgICAgICAgICBvbkNsaWNrOiBvbk5vZGVDbGljayxcbiAgICAgICAgICBvbkRvdWJsZUNsaWNrOiBvbk5vZGVEb3VibGVDbGljayxcbiAgICAgICAgICBvbkNvbnRleHRNZW51OiBvbk5vZGVDb250ZXh0TWVudSxcbiAgICAgICAgICBvblBvaW50ZXJPdmVyOiBvbk5vZGVQb2ludGVyT3ZlcixcbiAgICAgICAgICBvblBvaW50ZXJPdXQ6IG9uTm9kZVBvaW50ZXJPdXQsXG4gICAgICAgICAgb25EcmFnZ2VkOiBvbk5vZGVEcmFnZ2VkSGFuZGxlclxuICAgICAgICB9LFxuICAgICAgICBuID09IG51bGwgPyB2b2lkIDAgOiBuLmlkXG4gICAgICApKSxcbiAgICAgIFtcbiAgICAgICAgY29uc3RyYWluRHJhZ2dpbmcsXG4gICAgICAgIGFuaW1hdGVkLFxuICAgICAgICBjb250ZXh0TWVudSxcbiAgICAgICAgZGlzYWJsZWQyLFxuICAgICAgICBkcmFnZ2FibGUsXG4gICAgICAgIGxhYmVsRm9udFVybCxcbiAgICAgICAgbm9kZXMsXG4gICAgICAgIG9uTm9kZUNsaWNrLFxuICAgICAgICBvbk5vZGVDb250ZXh0TWVudSxcbiAgICAgICAgb25Ob2RlRG91YmxlQ2xpY2ssXG4gICAgICAgIG9uTm9kZURyYWdnZWRIYW5kbGVyLFxuICAgICAgICBvbk5vZGVQb2ludGVyT3V0LFxuICAgICAgICBvbk5vZGVQb2ludGVyT3ZlcixcbiAgICAgICAgcmVuZGVyTm9kZVxuICAgICAgXVxuICAgICk7XG4gICAgY29uc3QgZWRnZUNvbXBvbmVudHMgPSB1c2VNZW1vKFxuICAgICAgKCkgPT4gYW5pbWF0ZWQgPyBlZGdlcy5tYXAoKGUpID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgIEVkZ2UkMSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiBlLmlkLFxuICAgICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gICAgICAgICAgYW5pbWF0ZWQsXG4gICAgICAgICAgbGFiZWxGb250VXJsLFxuICAgICAgICAgIGxhYmVsUGxhY2VtZW50OiBlZGdlTGFiZWxQb3NpdGlvbixcbiAgICAgICAgICBhcnJvd1BsYWNlbWVudDogZWRnZUFycm93UG9zaXRpb24sXG4gICAgICAgICAgaW50ZXJwb2xhdGlvbjogZWRnZUludGVycG9sYXRpb24sXG4gICAgICAgICAgY29udGV4dE1lbnUsXG4gICAgICAgICAgb25DbGljazogb25FZGdlQ2xpY2ssXG4gICAgICAgICAgb25Db250ZXh0TWVudTogb25FZGdlQ29udGV4dE1lbnUsXG4gICAgICAgICAgb25Qb2ludGVyT3Zlcjogb25FZGdlUG9pbnRlck92ZXIsXG4gICAgICAgICAgb25Qb2ludGVyT3V0OiBvbkVkZ2VQb2ludGVyT3V0XG4gICAgICAgIH0sXG4gICAgICAgIGUuaWRcbiAgICAgICkpIDogLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgRWRnZXMsXG4gICAgICAgIHtcbiAgICAgICAgICBlZGdlcyxcbiAgICAgICAgICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICAgICAgICAgIGFuaW1hdGVkLFxuICAgICAgICAgIGxhYmVsRm9udFVybCxcbiAgICAgICAgICBsYWJlbFBsYWNlbWVudDogZWRnZUxhYmVsUG9zaXRpb24sXG4gICAgICAgICAgYXJyb3dQbGFjZW1lbnQ6IGVkZ2VBcnJvd1Bvc2l0aW9uLFxuICAgICAgICAgIGludGVycG9sYXRpb246IGVkZ2VJbnRlcnBvbGF0aW9uLFxuICAgICAgICAgIGNvbnRleHRNZW51LFxuICAgICAgICAgIG9uQ2xpY2s6IG9uRWRnZUNsaWNrLFxuICAgICAgICAgIG9uQ29udGV4dE1lbnU6IG9uRWRnZUNvbnRleHRNZW51LFxuICAgICAgICAgIG9uUG9pbnRlck92ZXI6IG9uRWRnZVBvaW50ZXJPdmVyLFxuICAgICAgICAgIG9uUG9pbnRlck91dDogb25FZGdlUG9pbnRlck91dFxuICAgICAgICB9XG4gICAgICApLFxuICAgICAgW1xuICAgICAgICBhbmltYXRlZCxcbiAgICAgICAgY29udGV4dE1lbnUsXG4gICAgICAgIGRpc2FibGVkMixcbiAgICAgICAgZWRnZUFycm93UG9zaXRpb24sXG4gICAgICAgIGVkZ2VJbnRlcnBvbGF0aW9uLFxuICAgICAgICBlZGdlTGFiZWxQb3NpdGlvbixcbiAgICAgICAgZWRnZXMsXG4gICAgICAgIGxhYmVsRm9udFVybCxcbiAgICAgICAgb25FZGdlQ2xpY2ssXG4gICAgICAgIG9uRWRnZUNvbnRleHRNZW51LFxuICAgICAgICBvbkVkZ2VQb2ludGVyT3V0LFxuICAgICAgICBvbkVkZ2VQb2ludGVyT3ZlclxuICAgICAgXVxuICAgICk7XG4gICAgY29uc3QgY2x1c3RlckNvbXBvbmVudHMgPSB1c2VNZW1vKFxuICAgICAgKCkgPT4gY2x1c3RlcnMubWFwKChjKSA9PiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICBDbHVzdGVyLFxuICAgICAgICB7XG4gICAgICAgICAgYW5pbWF0ZWQsXG4gICAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgICAgICAgICBkcmFnZ2FibGUsXG4gICAgICAgICAgbGFiZWxGb250VXJsLFxuICAgICAgICAgIG9uQ2xpY2s6IG9uQ2x1c3RlckNsaWNrLFxuICAgICAgICAgIG9uUG9pbnRlck92ZXI6IG9uQ2x1c3RlclBvaW50ZXJPdmVyLFxuICAgICAgICAgIG9uUG9pbnRlck91dDogb25DbHVzdGVyUG9pbnRlck91dCxcbiAgICAgICAgICBvbkRyYWdnZWQ6IG9uQ2x1c3RlckRyYWdnZWQsXG4gICAgICAgICAgb25SZW5kZXI6IG9uUmVuZGVyQ2x1c3RlcixcbiAgICAgICAgICAuLi5jXG4gICAgICAgIH0sXG4gICAgICAgIGMubGFiZWxcbiAgICAgICkpLFxuICAgICAgW1xuICAgICAgICBhbmltYXRlZCxcbiAgICAgICAgY2x1c3RlcnMsXG4gICAgICAgIGRpc2FibGVkMixcbiAgICAgICAgZHJhZ2dhYmxlLFxuICAgICAgICBsYWJlbEZvbnRVcmwsXG4gICAgICAgIG9uQ2x1c3RlckNsaWNrLFxuICAgICAgICBvbkNsdXN0ZXJQb2ludGVyT3V0LFxuICAgICAgICBvbkNsdXN0ZXJQb2ludGVyT3ZlcixcbiAgICAgICAgb25DbHVzdGVyRHJhZ2dlZCxcbiAgICAgICAgb25SZW5kZXJDbHVzdGVyXG4gICAgICBdXG4gICAgKTtcbiAgICByZXR1cm4gaXNDZW50ZXJlZCAmJiAvKiBAX19QVVJFX18gKi8ganN4cyhGcmFnbWVudCQxLCB7IGNoaWxkcmVuOiBbXG4gICAgICBlZGdlQ29tcG9uZW50cyxcbiAgICAgIG5vZGVDb21wb25lbnRzLFxuICAgICAgY2x1c3RlckNvbXBvbmVudHNcbiAgICBdIH0pO1xuICB9XG4pO1xuY29uc3QgZGFya1RoZW1lID0ge1xuICBjYW52YXM6IHtcbiAgICBiYWNrZ3JvdW5kOiBcIiMxRTIwMjZcIlxuICB9LFxuICBub2RlOiB7XG4gICAgZmlsbDogXCIjN0E4QzlFXCIsXG4gICAgYWN0aXZlRmlsbDogXCIjMURFOUFDXCIsXG4gICAgb3BhY2l0eTogMSxcbiAgICBzZWxlY3RlZE9wYWNpdHk6IDEsXG4gICAgaW5hY3RpdmVPcGFjaXR5OiAwLjIsXG4gICAgbGFiZWw6IHtcbiAgICAgIHN0cm9rZTogXCIjMUUyMDI2XCIsXG4gICAgICBjb2xvcjogXCIjQUNCQUM3XCIsXG4gICAgICBhY3RpdmVDb2xvcjogXCIjMURFOUFDXCJcbiAgICB9LFxuICAgIHN1YkxhYmVsOiB7XG4gICAgICBzdHJva2U6IFwiIzFFMjAyNlwiLFxuICAgICAgY29sb3I6IFwiI0FDQkFDN1wiLFxuICAgICAgYWN0aXZlQ29sb3I6IFwiIzFERTlBQ1wiXG4gICAgfVxuICB9LFxuICBsYXNzbzoge1xuICAgIGJvcmRlcjogXCIxcHggc29saWQgIzU1YWFmZlwiLFxuICAgIGJhY2tncm91bmQ6IFwicmdiYSg3NSwgMTYwLCAyNTUsIDAuMSlcIlxuICB9LFxuICByaW5nOiB7XG4gICAgZmlsbDogXCIjNTQ2MTZEXCIsXG4gICAgYWN0aXZlRmlsbDogXCIjMURFOUFDXCJcbiAgfSxcbiAgZWRnZToge1xuICAgIGZpbGw6IFwiIzQ3NEI1NlwiLFxuICAgIGFjdGl2ZUZpbGw6IFwiIzFERTlBQ1wiLFxuICAgIG9wYWNpdHk6IDEsXG4gICAgc2VsZWN0ZWRPcGFjaXR5OiAxLFxuICAgIGluYWN0aXZlT3BhY2l0eTogMC4xLFxuICAgIGxhYmVsOiB7XG4gICAgICBzdHJva2U6IFwiIzFFMjAyNlwiLFxuICAgICAgY29sb3I6IFwiI0FDQkFDN1wiLFxuICAgICAgYWN0aXZlQ29sb3I6IFwiIzFERTlBQ1wiLFxuICAgICAgZm9udFNpemU6IDZcbiAgICB9XG4gIH0sXG4gIGFycm93OiB7XG4gICAgZmlsbDogXCIjNDc0QjU2XCIsXG4gICAgYWN0aXZlRmlsbDogXCIjMURFOUFDXCJcbiAgfSxcbiAgY2x1c3Rlcjoge1xuICAgIHN0cm9rZTogXCIjNDc0QjU2XCIsXG4gICAgb3BhY2l0eTogMSxcbiAgICBzZWxlY3RlZE9wYWNpdHk6IDEsXG4gICAgaW5hY3RpdmVPcGFjaXR5OiAwLjEsXG4gICAgbGFiZWw6IHtcbiAgICAgIHN0cm9rZTogXCIjMUUyMDI2XCIsXG4gICAgICBjb2xvcjogXCIjQUNCQUM3XCJcbiAgICB9XG4gIH1cbn07XG5jb25zdCBsaWdodFRoZW1lID0ge1xuICBjYW52YXM6IHtcbiAgICBiYWNrZ3JvdW5kOiBcIiNmZmZcIlxuICB9LFxuICBub2RlOiB7XG4gICAgZmlsbDogXCIjN0NBMEFCXCIsXG4gICAgYWN0aXZlRmlsbDogXCIjMURFOUFDXCIsXG4gICAgb3BhY2l0eTogMSxcbiAgICBzZWxlY3RlZE9wYWNpdHk6IDEsXG4gICAgaW5hY3RpdmVPcGFjaXR5OiAwLjIsXG4gICAgbGFiZWw6IHtcbiAgICAgIGNvbG9yOiBcIiMyQTY0NzVcIixcbiAgICAgIHN0cm9rZTogXCIjZmZmXCIsXG4gICAgICBhY3RpdmVDb2xvcjogXCIjMURFOUFDXCJcbiAgICB9LFxuICAgIHN1YkxhYmVsOiB7XG4gICAgICBjb2xvcjogXCIjZGRkXCIsXG4gICAgICBzdHJva2U6IFwidHJhbnNwYXJlbnRcIixcbiAgICAgIGFjdGl2ZUNvbG9yOiBcIiMxREU5QUNcIlxuICAgIH1cbiAgfSxcbiAgbGFzc286IHtcbiAgICBib3JkZXI6IFwiMXB4IHNvbGlkICM1NWFhZmZcIixcbiAgICBiYWNrZ3JvdW5kOiBcInJnYmEoNzUsIDE2MCwgMjU1LCAwLjEpXCJcbiAgfSxcbiAgcmluZzoge1xuICAgIGZpbGw6IFwiI0Q4RTZFQVwiLFxuICAgIGFjdGl2ZUZpbGw6IFwiIzFERTlBQ1wiXG4gIH0sXG4gIGVkZ2U6IHtcbiAgICBmaWxsOiBcIiNEOEU2RUFcIixcbiAgICBhY3RpdmVGaWxsOiBcIiMxREU5QUNcIixcbiAgICBvcGFjaXR5OiAxLFxuICAgIHNlbGVjdGVkT3BhY2l0eTogMSxcbiAgICBpbmFjdGl2ZU9wYWNpdHk6IDAuMSxcbiAgICBsYWJlbDoge1xuICAgICAgc3Ryb2tlOiBcIiNmZmZcIixcbiAgICAgIGNvbG9yOiBcIiMyQTY0NzVcIixcbiAgICAgIGFjdGl2ZUNvbG9yOiBcIiMxREU5QUNcIixcbiAgICAgIGZvbnRTaXplOiA2XG4gICAgfVxuICB9LFxuICBhcnJvdzoge1xuICAgIGZpbGw6IFwiI0Q4RTZFQVwiLFxuICAgIGFjdGl2ZUZpbGw6IFwiIzFERTlBQ1wiXG4gIH0sXG4gIGNsdXN0ZXI6IHtcbiAgICBzdHJva2U6IFwiI0Q4RTZFQVwiLFxuICAgIG9wYWNpdHk6IDEsXG4gICAgc2VsZWN0ZWRPcGFjaXR5OiAxLFxuICAgIGluYWN0aXZlT3BhY2l0eTogMC4xLFxuICAgIGxhYmVsOiB7XG4gICAgICBzdHJva2U6IFwiI2ZmZlwiLFxuICAgICAgY29sb3I6IFwiIzJBNjQ3NVwiXG4gICAgfVxuICB9XG59O1xuZnVuY3Rpb24gZ2V0QWRqYWNlbnRzKGdyYXBoLCBub2RlSWRzLCB0eXBlKSB7XG4gIG5vZGVJZHMgPSBBcnJheS5pc0FycmF5KG5vZGVJZHMpID8gbm9kZUlkcyA6IFtub2RlSWRzXTtcbiAgY29uc3Qgbm9kZXMgPSBbXTtcbiAgY29uc3QgZWRnZXMgPSBbXTtcbiAgZm9yIChjb25zdCBub2RlSWQgb2Ygbm9kZUlkcykge1xuICAgIGNvbnN0IGdyYXBoTGlua3MgPSBbXG4gICAgICAuLi5ncmFwaC5pbkVkZ2VFbnRyaWVzKG5vZGVJZCkgPz8gW10sXG4gICAgICAuLi5ncmFwaC5vdXRFZGdlRW50cmllcyhub2RlSWQpID8/IFtdXG4gICAgXTtcbiAgICBpZiAoIWdyYXBoTGlua3MpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGxpbmsgb2YgZ3JhcGhMaW5rcykge1xuICAgICAgY29uc3QgbGlua0lkID0gbGluay5hdHRyaWJ1dGVzLmlkO1xuICAgICAgaWYgKHR5cGUgPT09IFwiaW5cIikge1xuICAgICAgICBpZiAobGluay50YXJnZXQgPT09IG5vZGVJZCAmJiAhZWRnZXMuaW5jbHVkZXMobGlua0lkKSkge1xuICAgICAgICAgIGVkZ2VzLnB1c2gobGlua0lkKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm91dFwiKSB7XG4gICAgICAgIGlmIChsaW5rLnNvdXJjZSA9PT0gbm9kZUlkICYmICFlZGdlcy5pbmNsdWRlcyhsaW5rSWQpKSB7XG4gICAgICAgICAgZWRnZXMucHVzaChsaW5rSWQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIWVkZ2VzLmluY2x1ZGVzKGxpbmtJZCkpIHtcbiAgICAgICAgICBlZGdlcy5wdXNoKGxpbmtJZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0eXBlID09PSBcIm91dFwiIHx8IHR5cGUgPT09IFwiYWxsXCIpIHtcbiAgICAgICAgY29uc3QgdG9JZCA9IGxpbmsudGFyZ2V0O1xuICAgICAgICBpZiAoIW5vZGVzLmluY2x1ZGVzKHRvSWQpKSB7XG4gICAgICAgICAgbm9kZXMucHVzaCh0b0lkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHR5cGUgPT09IFwiaW5cIiB8fCB0eXBlID09PSBcImFsbFwiKSB7XG4gICAgICAgIGlmICghbm9kZXMuaW5jbHVkZXMobGluay5zb3VyY2UpKSB7XG4gICAgICAgICAgbm9kZXMucHVzaChsaW5rLnNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBub2RlcyxcbiAgICBlZGdlc1xuICB9O1xufVxuZnVuY3Rpb24gcHJlcGFyZVJheShldmVudCwgdmVjLCBzaXplKSB7XG4gIGNvbnN0IHsgb2Zmc2V0WCwgb2Zmc2V0WSB9ID0gZXZlbnQ7XG4gIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gc2l6ZTtcbiAgdmVjLnNldChvZmZzZXRYIC8gd2lkdGggKiAyIC0gMSwgLShvZmZzZXRZIC8gaGVpZ2h0KSAqIDIgKyAxKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodGhlbWUpIHtcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGVsZW1lbnQuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xuICBlbGVtZW50LnN0eWxlLmJvcmRlciA9IHRoZW1lLmxhc3NvLmJvcmRlcjtcbiAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGVtZS5sYXNzby5iYWNrZ3JvdW5kO1xuICBlbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xuICByZXR1cm4gZWxlbWVudDtcbn1cbmNvbnN0IExhc3NvID0gKHtcbiAgY2hpbGRyZW4sXG4gIHR5cGUgPSBcIm5vbmVcIixcbiAgb25MYXNzbyxcbiAgb25MYXNzb0VuZCxcbiAgZGlzYWJsZWQ6IGRpc2FibGVkMlxufSkgPT4ge1xuICB2YXIgX2EyO1xuICBjb25zdCB0aGVtZSA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUudGhlbWUpO1xuICBjb25zdCBjYW1lcmEgPSB1c2VUaHJlZSgoc3RhdGUpID0+IHN0YXRlLmNhbWVyYSk7XG4gIGNvbnN0IGdsID0gdXNlVGhyZWUoKHN0YXRlKSA9PiBzdGF0ZS5nbCk7XG4gIGNvbnN0IHNldEV2ZW50cyA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuc2V0RXZlbnRzKTtcbiAgY29uc3Qgc2l6ZSA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuc2l6ZSk7XG4gIGNvbnN0IGdldCA9IHVzZVRocmVlKChzdGF0ZSkgPT4gc3RhdGUuZ2V0KTtcbiAgY29uc3Qgc2NlbmUgPSB1c2VUaHJlZSgoc3RhdGUpID0+IHN0YXRlLnNjZW5lKTtcbiAgY29uc3QgY2FtZXJhQ29udHJvbHMgPSB1c2VDYW1lcmFDb250cm9scygpO1xuICBjb25zdCBhY3RpdmVzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5hY3RpdmVzKTtcbiAgY29uc3Qgc2V0QWN0aXZlcyA9IHVzZVN0b3JlKChzdGF0ZSkgPT4gc3RhdGUuc2V0QWN0aXZlcyk7XG4gIGNvbnN0IGVkZ2VzID0gdXNlU3RvcmUoKHN0YXRlKSA9PiBzdGF0ZS5lZGdlcyk7XG4gIGNvbnN0IGVkZ2VNZXNoZXMgPSB1c2VTdG9yZSgoc3RhdGUpID0+IHN0YXRlLmVkZ2VNZXNoZXMpO1xuICBjb25zdCBtb3VudGVkUmVmID0gdXNlUmVmKGZhbHNlKTtcbiAgY29uc3Qgc2VsZWN0aW9uQm94UmVmID0gdXNlUmVmKG51bGwpO1xuICBjb25zdCBlZGdlTWVzaFNlbGVjdGlvbkJveFJlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgZWxlbWVudFJlZiA9IHVzZVJlZihjcmVhdGVFbGVtZW50KHRoZW1lKSk7XG4gIGNvbnN0IHZlY3RvcnNSZWYgPSB1c2VSZWYobnVsbCk7XG4gIGNvbnN0IGlzRG93blJlZiA9IHVzZVJlZihmYWxzZSk7XG4gIGNvbnN0IG9sZFJheWNhc3RlckVuYWJsZWRSZWYgPSB1c2VSZWYoZ2V0KCkuZXZlbnRzLmVuYWJsZWQpO1xuICBjb25zdCBvbGRDb250cm9sc0VuYWJsZWRSZWYgPSB1c2VSZWYoXG4gICAgKF9hMiA9IGNhbWVyYUNvbnRyb2xzLmNvbnRyb2xzKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmVuYWJsZWRcbiAgKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAobW91bnRlZFJlZi5jdXJyZW50KSB7XG4gICAgICBvbkxhc3NvID09IG51bGwgPyB2b2lkIDAgOiBvbkxhc3NvKGFjdGl2ZXMpO1xuICAgIH1cbiAgICBtb3VudGVkUmVmLmN1cnJlbnQgPSB0cnVlO1xuICB9LCBbYWN0aXZlcywgb25MYXNzb10pO1xuICBjb25zdCBvblBvaW50ZXJNb3ZlID0gdXNlQ2FsbGJhY2soXG4gICAgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoaXNEb3duUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgY29uc3QgW3N0YXJ0UG9pbnQsIHBvaW50VG9wTGVmdCwgcG9pbnRCb3R0b21SaWdodF0gPSB2ZWN0b3JzUmVmLmN1cnJlbnQ7XG4gICAgICAgIHBvaW50Qm90dG9tUmlnaHQueCA9IE1hdGgubWF4KHN0YXJ0UG9pbnQueCwgZXZlbnQuY2xpZW50WCk7XG4gICAgICAgIHBvaW50Qm90dG9tUmlnaHQueSA9IE1hdGgubWF4KHN0YXJ0UG9pbnQueSwgZXZlbnQuY2xpZW50WSk7XG4gICAgICAgIHBvaW50VG9wTGVmdC54ID0gTWF0aC5taW4oc3RhcnRQb2ludC54LCBldmVudC5jbGllbnRYKTtcbiAgICAgICAgcG9pbnRUb3BMZWZ0LnkgPSBNYXRoLm1pbihzdGFydFBvaW50LnksIGV2ZW50LmNsaWVudFkpO1xuICAgICAgICBlbGVtZW50UmVmLmN1cnJlbnQuc3R5bGUubGVmdCA9IGAke3BvaW50VG9wTGVmdC54fXB4YDtcbiAgICAgICAgZWxlbWVudFJlZi5jdXJyZW50LnN0eWxlLnRvcCA9IGAke3BvaW50VG9wTGVmdC55fXB4YDtcbiAgICAgICAgZWxlbWVudFJlZi5jdXJyZW50LnN0eWxlLndpZHRoID0gYCR7cG9pbnRCb3R0b21SaWdodC54IC0gcG9pbnRUb3BMZWZ0Lnh9cHhgO1xuICAgICAgICBlbGVtZW50UmVmLmN1cnJlbnQuc3R5bGUuaGVpZ2h0ID0gYCR7cG9pbnRCb3R0b21SaWdodC55IC0gcG9pbnRUb3BMZWZ0Lnl9cHhgO1xuICAgICAgICBwcmVwYXJlUmF5KGV2ZW50LCBzZWxlY3Rpb25Cb3hSZWYuY3VycmVudC5lbmRQb2ludCwgc2l6ZSk7XG4gICAgICAgIHByZXBhcmVSYXkoZXZlbnQsIGVkZ2VNZXNoU2VsZWN0aW9uQm94UmVmLmN1cnJlbnQuZW5kUG9pbnQsIHNpemUpO1xuICAgICAgICBjb25zdCBhbGxTZWxlY3RlZCA9IFtdO1xuICAgICAgICBjb25zdCBlZGdlc1NlbGVjdGVkID0gZWRnZU1lc2hTZWxlY3Rpb25Cb3hSZWYuY3VycmVudC5zZWxlY3QoKS5zb3J0KChvKSA9PiBvLnV1aWQpLm1hcChcbiAgICAgICAgICAoZWRnZSkgPT4gZWRnZXNbZWRnZU1lc2hlcy5pbmRleE9mKGVkZ2UpXS5pZFxuICAgICAgICApO1xuICAgICAgICBhbGxTZWxlY3RlZC5wdXNoKC4uLmVkZ2VzU2VsZWN0ZWQpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHNlbGVjdGlvbkJveFJlZi5jdXJyZW50LnNlbGVjdCgpLnNvcnQoKG8pID0+IG8udXVpZCkuZmlsdGVyKFxuICAgICAgICAgIChvKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EzLCBfYjI7XG4gICAgICAgICAgICByZXR1cm4gby5pc01lc2ggJiYgKChfYTMgPSBvLnVzZXJEYXRhKSA9PSBudWxsID8gdm9pZCAwIDogX2EzLmlkKSAmJiAoKChfYjIgPSBvLnVzZXJEYXRhKSA9PSBudWxsID8gdm9pZCAwIDogX2IyLnR5cGUpID09PSB0eXBlIHx8IHR5cGUgPT09IFwiYWxsXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgKS5tYXAoKG8pID0+IG8udXNlckRhdGEuaWQpO1xuICAgICAgICBhbGxTZWxlY3RlZC5wdXNoKC4uLnNlbGVjdGVkKTtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICBzZXRBY3RpdmVzKGFsbFNlbGVjdGVkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCBvblBvaW50ZXJNb3ZlLCB7XG4gICAgICAgICAgcGFzc2l2ZTogdHJ1ZSxcbiAgICAgICAgICBjYXB0dXJlOiB0cnVlLFxuICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbZWRnZXMsIGVkZ2VNZXNoZXMsIHNldEFjdGl2ZXMsIHNpemUsIHR5cGVdXG4gICk7XG4gIGNvbnN0IG9uUG9pbnRlclVwID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHZhciBfYTM7XG4gICAgaWYgKGlzRG93blJlZi5jdXJyZW50KSB7XG4gICAgICBzZXRFdmVudHMoeyBlbmFibGVkOiBvbGRSYXljYXN0ZXJFbmFibGVkUmVmLmN1cnJlbnQgfSk7XG4gICAgICBpc0Rvd25SZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgKF9hMyA9IGVsZW1lbnRSZWYuY3VycmVudC5wYXJlbnRFbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EzLnJlbW92ZUNoaWxkKGVsZW1lbnRSZWYuY3VycmVudCk7XG4gICAgICBjYW1lcmFDb250cm9scy5jb250cm9scy5lbmFibGVkID0gb2xkQ29udHJvbHNFbmFibGVkUmVmLmN1cnJlbnQ7XG4gICAgICBvbkxhc3NvRW5kID09IG51bGwgPyB2b2lkIDAgOiBvbkxhc3NvRW5kKGFjdGl2ZXMpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIG9uUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCBvblBvaW50ZXJVcCk7XG4gICAgfVxuICB9LCBbc2V0RXZlbnRzLCBjYW1lcmFDb250cm9scy5jb250cm9scywgb25MYXNzb0VuZCwgYWN0aXZlcywgb25Qb2ludGVyTW92ZV0pO1xuICBjb25zdCBvblBvaW50ZXJEb3duID0gdXNlQ2FsbGJhY2soXG4gICAgKGV2ZW50KSA9PiB7XG4gICAgICB2YXIgX2EzLCBfYjI7XG4gICAgICBpZiAoZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgb2xkUmF5Y2FzdGVyRW5hYmxlZFJlZi5jdXJyZW50ID0gZ2V0KCkuZXZlbnRzLmVuYWJsZWQ7XG4gICAgICAgIG9sZENvbnRyb2xzRW5hYmxlZFJlZi5jdXJyZW50ID0gKF9hMyA9IGNhbWVyYUNvbnRyb2xzLmNvbnRyb2xzKSA9PSBudWxsID8gdm9pZCAwIDogX2EzLmVuYWJsZWQ7XG4gICAgICAgIHNlbGVjdGlvbkJveFJlZi5jdXJyZW50ID0gbmV3IFNlbGVjdGlvbkJveChjYW1lcmEsIHNjZW5lKTtcbiAgICAgICAgY29uc3QgZWRnZVNjZW5lID0gbmV3IFNjZW5lKCk7XG4gICAgICAgIGlmIChlZGdlTWVzaGVzLmxlbmd0aCkge1xuICAgICAgICAgIGVkZ2VTY2VuZS5hZGQoLi4uZWRnZU1lc2hlcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWRnZU1lc2hTZWxlY3Rpb25Cb3hSZWYuY3VycmVudCA9IG5ldyBTZWxlY3Rpb25Cb3goY2FtZXJhLCBlZGdlU2NlbmUpO1xuICAgICAgICB2ZWN0b3JzUmVmLmN1cnJlbnQgPSBbXG4gICAgICAgICAgLy8gc3RhcnQgcG9pbnRcbiAgICAgICAgICBuZXcgVmVjdG9yMigpLFxuICAgICAgICAgIC8vIHBvaW50IHRvcCBsZWZ0XG4gICAgICAgICAgbmV3IFZlY3RvcjIoKSxcbiAgICAgICAgICAvLyBwb2ludCBib3R0b20gcmlnaHRcbiAgICAgICAgICBuZXcgVmVjdG9yMigpXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IFtzdGFydFBvaW50XSA9IHZlY3RvcnNSZWYuY3VycmVudDtcbiAgICAgICAgY2FtZXJhQ29udHJvbHMuY29udHJvbHMuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICBzZXRFdmVudHMoeyBlbmFibGVkOiBmYWxzZSB9KTtcbiAgICAgICAgaXNEb3duUmVmLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICAoX2IyID0gZ2wuZG9tRWxlbWVudC5wYXJlbnRFbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2IyLmFwcGVuZENoaWxkKGVsZW1lbnRSZWYuY3VycmVudCk7XG4gICAgICAgIGVsZW1lbnRSZWYuY3VycmVudC5zdHlsZS5sZWZ0ID0gYCR7ZXZlbnQuY2xpZW50WH1weGA7XG4gICAgICAgIGVsZW1lbnRSZWYuY3VycmVudC5zdHlsZS50b3AgPSBgJHtldmVudC5jbGllbnRZfXB4YDtcbiAgICAgICAgZWxlbWVudFJlZi5jdXJyZW50LnN0eWxlLndpZHRoID0gXCIwcHhcIjtcbiAgICAgICAgZWxlbWVudFJlZi5jdXJyZW50LnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XG4gICAgICAgIHN0YXJ0UG9pbnQueCA9IGV2ZW50LmNsaWVudFg7XG4gICAgICAgIHN0YXJ0UG9pbnQueSA9IGV2ZW50LmNsaWVudFk7XG4gICAgICAgIHByZXBhcmVSYXkoZXZlbnQsIHNlbGVjdGlvbkJveFJlZi5jdXJyZW50LnN0YXJ0UG9pbnQsIHNpemUpO1xuICAgICAgICBwcmVwYXJlUmF5KGV2ZW50LCBlZGdlTWVzaFNlbGVjdGlvbkJveFJlZi5jdXJyZW50LnN0YXJ0UG9pbnQsIHNpemUpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgb25Qb2ludGVyTW92ZSwge1xuICAgICAgICAgIHBhc3NpdmU6IHRydWUsXG4gICAgICAgICAgY2FwdHVyZTogdHJ1ZSxcbiAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIG9uUG9pbnRlclVwLCB7IHBhc3NpdmU6IHRydWUgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbXG4gICAgICBjYW1lcmEsXG4gICAgICBjYW1lcmFDb250cm9scy5jb250cm9scyxcbiAgICAgIGVkZ2VNZXNoZXMsXG4gICAgICBnZXQsXG4gICAgICBnbC5kb21FbGVtZW50LnBhcmVudEVsZW1lbnQsXG4gICAgICBvblBvaW50ZXJNb3ZlLFxuICAgICAgb25Qb2ludGVyVXAsXG4gICAgICBzY2VuZSxcbiAgICAgIHNldEV2ZW50cyxcbiAgICAgIHNpemVcbiAgICBdXG4gICk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGRpc2FibGVkMiB8fCB0eXBlID09PSBcIm5vbmVcIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIG9uUG9pbnRlckRvd24sIHtcbiAgICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgb25Qb2ludGVyTW92ZSwge1xuICAgICAgICBwYXNzaXZlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgb25Qb2ludGVyVXAsIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCBvblBvaW50ZXJEb3duKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIG9uUG9pbnRlck1vdmUpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIG9uUG9pbnRlclVwKTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbdHlwZSwgZGlzYWJsZWQyLCBvblBvaW50ZXJEb3duLCBvblBvaW50ZXJNb3ZlLCBvblBvaW50ZXJVcF0pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChcImdyb3VwXCIsIHsgY2hpbGRyZW4gfSk7XG59O1xuY29uc3QgdXNlU2VsZWN0aW9uID0gKHtcbiAgc2VsZWN0aW9ucyA9IFtdLFxuICBub2RlcyA9IFtdLFxuICBhY3RpdmVzID0gW10sXG4gIGZvY3VzT25TZWxlY3QgPSB0cnVlLFxuICB0eXBlID0gXCJzaW5nbGVcIixcbiAgcGF0aEhvdmVyVHlwZSA9IFwib3V0XCIsXG4gIHBhdGhTZWxlY3Rpb25UeXBlID0gXCJkaXJlY3RcIixcbiAgcmVmLFxuICBob3RrZXlzID0gW1wic2VsZWN0QWxsXCIsIFwiZGVzZWxlY3RcIiwgXCJkZWxldGVcIl0sXG4gIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gIG9uU2VsZWN0aW9uXG59KSA9PiB7XG4gIGNvbnN0IFtpbnRlcm5hbEhvdmVycywgc2V0SW50ZXJuYWxIb3ZlcnNdID0gdXNlU3RhdGUoW10pO1xuICBjb25zdCBbaW50ZXJuYWxBY3RpdmVzLCBzZXRJbnRlcm5hbEFjdGl2ZXNdID0gdXNlU3RhdGUoYWN0aXZlcyk7XG4gIGNvbnN0IFtpbnRlcm5hbFNlbGVjdGlvbnMsIHNldEludGVybmFsU2VsZWN0aW9uc10gPSB1c2VTdGF0ZShzZWxlY3Rpb25zKTtcbiAgY29uc3QgW21ldGFLZXlEb3duLCBzZXRNZXRhS2V5RG93bl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGlzTXVsdGkgPSB0eXBlID09PSBcIm11bHRpXCIgfHwgdHlwZSA9PT0gXCJtdWx0aU1vZGlmaWVyXCI7XG4gIGNvbnN0IGFkZFNlbGVjdGlvbiA9IHVzZUNhbGxiYWNrKFxuICAgIChpdGVtcykgPT4ge1xuICAgICAgaWYgKCFkaXNhYmxlZDIgJiYgaXRlbXMpIHtcbiAgICAgICAgaXRlbXMgPSBBcnJheS5pc0FycmF5KGl0ZW1zKSA/IGl0ZW1zIDogW2l0ZW1zXTtcbiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBpdGVtcy5maWx0ZXIoXG4gICAgICAgICAgKGl0ZW0pID0+ICFpbnRlcm5hbFNlbGVjdGlvbnMuaW5jbHVkZXMoaXRlbSlcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKGZpbHRlcmVkLmxlbmd0aCkge1xuICAgICAgICAgIGNvbnN0IG5leHQgPSBbLi4uaW50ZXJuYWxTZWxlY3Rpb25zLCAuLi5maWx0ZXJlZF07XG4gICAgICAgICAgb25TZWxlY3Rpb24gPT0gbnVsbCA/IHZvaWQgMCA6IG9uU2VsZWN0aW9uKG5leHQpO1xuICAgICAgICAgIHNldEludGVybmFsU2VsZWN0aW9ucyhuZXh0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgW2Rpc2FibGVkMiwgaW50ZXJuYWxTZWxlY3Rpb25zLCBvblNlbGVjdGlvbl1cbiAgKTtcbiAgY29uc3QgcmVtb3ZlU2VsZWN0aW9uID0gdXNlQ2FsbGJhY2soXG4gICAgKGl0ZW1zKSA9PiB7XG4gICAgICBpZiAoIWRpc2FibGVkMiAmJiBpdGVtcykge1xuICAgICAgICBpdGVtcyA9IEFycmF5LmlzQXJyYXkoaXRlbXMpID8gaXRlbXMgOiBbaXRlbXNdO1xuICAgICAgICBjb25zdCBuZXh0ID0gaW50ZXJuYWxTZWxlY3Rpb25zLmZpbHRlcigoaSkgPT4gIWl0ZW1zLmluY2x1ZGVzKGkpKTtcbiAgICAgICAgb25TZWxlY3Rpb24gPT0gbnVsbCA/IHZvaWQgMCA6IG9uU2VsZWN0aW9uKG5leHQpO1xuICAgICAgICBzZXRJbnRlcm5hbFNlbGVjdGlvbnMobmV4dCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbZGlzYWJsZWQyLCBpbnRlcm5hbFNlbGVjdGlvbnMsIG9uU2VsZWN0aW9uXVxuICApO1xuICBjb25zdCBjbGVhclNlbGVjdGlvbnMgPSB1c2VDYWxsYmFjayhcbiAgICAobmV4dCA9IFtdKSA9PiB7XG4gICAgICBpZiAoIWRpc2FibGVkMikge1xuICAgICAgICBuZXh0ID0gQXJyYXkuaXNBcnJheShuZXh0KSA/IG5leHQgOiBbbmV4dF07XG4gICAgICAgIHNldEludGVybmFsQWN0aXZlcyhbXSk7XG4gICAgICAgIHNldEludGVybmFsU2VsZWN0aW9ucyhuZXh0KTtcbiAgICAgICAgb25TZWxlY3Rpb24gPT0gbnVsbCA/IHZvaWQgMCA6IG9uU2VsZWN0aW9uKG5leHQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2Rpc2FibGVkMiwgb25TZWxlY3Rpb25dXG4gICk7XG4gIGNvbnN0IHRvZ2dsZVNlbGVjdGlvbiA9IHVzZUNhbGxiYWNrKFxuICAgIChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBoYXMgPSBpbnRlcm5hbFNlbGVjdGlvbnMuaW5jbHVkZXMoaXRlbSk7XG4gICAgICBpZiAoaGFzKSB7XG4gICAgICAgIHJlbW92ZVNlbGVjdGlvbihpdGVtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghaXNNdWx0aSkge1xuICAgICAgICAgIGNsZWFyU2VsZWN0aW9ucyhpdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhZGRTZWxlY3Rpb24oaXRlbSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIFtcbiAgICAgIGFkZFNlbGVjdGlvbixcbiAgICAgIGNsZWFyU2VsZWN0aW9ucyxcbiAgICAgIGludGVybmFsU2VsZWN0aW9ucyxcbiAgICAgIGlzTXVsdGksXG4gICAgICByZW1vdmVTZWxlY3Rpb25cbiAgICBdXG4gICk7XG4gIGNvbnN0IG9uTm9kZUNsaWNrID0gdXNlQ2FsbGJhY2soXG4gICAgKGRhdGEpID0+IHtcbiAgICAgIGlmIChpc011bHRpKSB7XG4gICAgICAgIGlmICh0eXBlID09PSBcIm11bHRpTW9kaWZpZXJcIikge1xuICAgICAgICAgIGlmIChtZXRhS2V5RG93bikge1xuICAgICAgICAgICAgYWRkU2VsZWN0aW9uKGRhdGEuaWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjbGVhclNlbGVjdGlvbnMoZGF0YS5pZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFkZFNlbGVjdGlvbihkYXRhLmlkKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2xlYXJTZWxlY3Rpb25zKGRhdGEuaWQpO1xuICAgICAgfVxuICAgICAgaWYgKGZvY3VzT25TZWxlY3QgPT09IHRydWUgfHwgZm9jdXNPblNlbGVjdCA9PT0gXCJzaW5nbGVPbmx5XCIgJiYgIW1ldGFLZXlEb3duKSB7XG4gICAgICAgIGlmICghcmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyByZWYgZm91bmQgZm9yIHRoZSBncmFwaCBjYW52YXMuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGdyYXBoID0gcmVmLmN1cnJlbnQuZ2V0R3JhcGgoKTtcbiAgICAgICAgY29uc3QgeyBub2RlczogYWRqYWNlbnRzIH0gPSBnZXRBZGphY2VudHMoXG4gICAgICAgICAgZ3JhcGgsXG4gICAgICAgICAgW2RhdGEuaWRdLFxuICAgICAgICAgIHBhdGhTZWxlY3Rpb25UeXBlXG4gICAgICAgICk7XG4gICAgICAgIHJlZi5jdXJyZW50LmZpdE5vZGVzSW5WaWV3KFtkYXRhLmlkLCAuLi5hZGphY2VudHNdLCB7XG4gICAgICAgICAgZml0T25seUlmTm9kZXNOb3RJblZpZXc6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbXG4gICAgICBhZGRTZWxlY3Rpb24sXG4gICAgICBjbGVhclNlbGVjdGlvbnMsXG4gICAgICBmb2N1c09uU2VsZWN0LFxuICAgICAgaXNNdWx0aSxcbiAgICAgIG1ldGFLZXlEb3duLFxuICAgICAgcGF0aFNlbGVjdGlvblR5cGUsXG4gICAgICByZWYsXG4gICAgICB0eXBlXG4gICAgXVxuICApO1xuICBjb25zdCBzZWxlY3ROb2RlUGF0aHMgPSB1c2VDYWxsYmFjayhcbiAgICAoc291cmNlLCB0YXJnZXQpID0+IHtcbiAgICAgIGNvbnN0IGdyYXBoID0gcmVmLmN1cnJlbnQuZ2V0R3JhcGgoKTtcbiAgICAgIGlmICghZ3JhcGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR3JhcGggaXMgbm90IGluaXRpYWxpemVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgcGF0aCA9IGZpbmRQYXRoKGdyYXBoLCBzb3VyY2UsIHRhcmdldCk7XG4gICAgICBjbGVhclNlbGVjdGlvbnMoW3NvdXJjZSwgdGFyZ2V0XSk7XG4gICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGF0aC5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgY29uc3QgZnJvbSA9IHBhdGhbaV07XG4gICAgICAgIGNvbnN0IHRvID0gcGF0aFtpICsgMV07XG4gICAgICAgIGNvbnN0IGVkZ2UgPSBncmFwaC5nZXRFZGdlQXR0cmlidXRlcyhmcm9tLCB0byk7XG4gICAgICAgIGlmIChlZGdlKSB7XG4gICAgICAgICAgcmVzdWx0LnB1c2goZWRnZS5pZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNldEludGVybmFsQWN0aXZlcyhbLi4ucGF0aC5tYXAoKHApID0+IHApLCAuLi5yZXN1bHRdKTtcbiAgICB9LFxuICAgIFtjbGVhclNlbGVjdGlvbnMsIHJlZl1cbiAgKTtcbiAgY29uc3Qgb25LZXlEb3duID0gdXNlQ2FsbGJhY2soKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgZWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgICBjb25zdCBpc1NhZmUgPSBlbGVtZW50LnRhZ05hbWUgIT09IFwiSU5QVVRcIiAmJiBlbGVtZW50LnRhZ05hbWUgIT09IFwiU0VMRUNUXCIgJiYgZWxlbWVudC50YWdOYW1lICE9PSBcIlRFWFRBUkVBXCIgJiYgIWVsZW1lbnQuaXNDb250ZW50RWRpdGFibGU7XG4gICAgY29uc3QgaXNNZXRhID0gZXZlbnQubWV0YUtleSB8fCBldmVudC5jdHJsS2V5O1xuICAgIGlmIChpc1NhZmUgJiYgaXNNZXRhKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgc2V0TWV0YUtleURvd24odHJ1ZSk7XG4gICAgfVxuICB9LCBbXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBvbktleURvd24pO1xuICAgIH1cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIG9uS2V5RG93bik7XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW29uS2V5RG93bl0pO1xuICBjb25zdCBvbkNhbnZhc0NsaWNrID0gdXNlQ2FsbGJhY2soXG4gICAgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQuYnV0dG9uICE9PSAyICYmIChpbnRlcm5hbFNlbGVjdGlvbnMubGVuZ3RoIHx8IGludGVybmFsQWN0aXZlcy5sZW5ndGgpKSB7XG4gICAgICAgIGNsZWFyU2VsZWN0aW9ucygpO1xuICAgICAgICBzZXRNZXRhS2V5RG93bihmYWxzZSk7XG4gICAgICAgIGlmIChmb2N1c09uU2VsZWN0ICYmIGludGVybmFsU2VsZWN0aW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICBpZiAoIXJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyByZWYgZm91bmQgZm9yIHRoZSBncmFwaCBjYW52YXMuXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZWYuY3VycmVudC5maXROb2Rlc0luVmlldyhbXSwgeyBmaXRPbmx5SWZOb2Rlc05vdEluVmlldzogdHJ1ZSB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgW1xuICAgICAgY2xlYXJTZWxlY3Rpb25zLFxuICAgICAgZm9jdXNPblNlbGVjdCxcbiAgICAgIGludGVybmFsQWN0aXZlcy5sZW5ndGgsXG4gICAgICBpbnRlcm5hbFNlbGVjdGlvbnMubGVuZ3RoLFxuICAgICAgcmVmXG4gICAgXVxuICApO1xuICBjb25zdCBvbkxhc3NvID0gdXNlQ2FsbGJhY2soKHNlbGVjdGlvbnMyKSA9PiB7XG4gICAgc2V0SW50ZXJuYWxBY3RpdmVzKHNlbGVjdGlvbnMyKTtcbiAgfSwgW10pO1xuICBjb25zdCBvbkxhc3NvRW5kID0gdXNlQ2FsbGJhY2soXG4gICAgKHNlbGVjdGlvbnMyKSA9PiB7XG4gICAgICBjbGVhclNlbGVjdGlvbnMoc2VsZWN0aW9uczIpO1xuICAgIH0sXG4gICAgW2NsZWFyU2VsZWN0aW9uc11cbiAgKTtcbiAgY29uc3Qgb25Ob2RlUG9pbnRlck92ZXIgPSB1c2VDYWxsYmFjayhcbiAgICAoZGF0YSkgPT4ge1xuICAgICAgaWYgKHBhdGhIb3ZlclR5cGUpIHtcbiAgICAgICAgY29uc3QgZ3JhcGggPSByZWYuY3VycmVudC5nZXRHcmFwaCgpO1xuICAgICAgICBpZiAoIWdyYXBoKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gcmVmIGZvdW5kIGZvciB0aGUgZ3JhcGggY2FudmFzLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IG5vZGVzOiBub2RlczIsIGVkZ2VzIH0gPSBnZXRBZGphY2VudHMoZ3JhcGgsIFtkYXRhLmlkXSwgcGF0aEhvdmVyVHlwZSk7XG4gICAgICAgIHNldEludGVybmFsSG92ZXJzKFsuLi5ub2RlczIsIC4uLmVkZ2VzXSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbcGF0aEhvdmVyVHlwZSwgcmVmXVxuICApO1xuICBjb25zdCBvbk5vZGVQb2ludGVyT3V0ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChwYXRoSG92ZXJUeXBlKSB7XG4gICAgICBzZXRJbnRlcm5hbEhvdmVycyhbXSk7XG4gICAgfVxuICB9LCBbcGF0aEhvdmVyVHlwZV0pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHZhciBfYTI7XG4gICAgaWYgKHBhdGhTZWxlY3Rpb25UeXBlICE9PSBcImRpcmVjdFwiICYmIGludGVybmFsU2VsZWN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBncmFwaCA9IChfYTIgPSByZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5nZXRHcmFwaCgpO1xuICAgICAgaWYgKGdyYXBoKSB7XG4gICAgICAgIGNvbnN0IHsgbm9kZXM6IG5vZGVzMiwgZWRnZXMgfSA9IGdldEFkamFjZW50cyhcbiAgICAgICAgICBncmFwaCxcbiAgICAgICAgICBpbnRlcm5hbFNlbGVjdGlvbnMsXG4gICAgICAgICAgcGF0aFNlbGVjdGlvblR5cGVcbiAgICAgICAgKTtcbiAgICAgICAgc2V0SW50ZXJuYWxBY3RpdmVzKFsuLi5ub2RlczIsIC4uLmVkZ2VzXSk7XG4gICAgICB9XG4gICAgfVxuICB9LCBbaW50ZXJuYWxTZWxlY3Rpb25zLCBwYXRoU2VsZWN0aW9uVHlwZSwgcmVmXSk7XG4gIHVzZUhvdGtleXMoW1xuICAgIHtcbiAgICAgIG5hbWU6IFwiU2VsZWN0IEFsbFwiLFxuICAgICAga2V5czogXCJtb2QrYVwiLFxuICAgICAgZGlzYWJsZWQ6ICFob3RrZXlzLmluY2x1ZGVzKFwic2VsZWN0QWxsXCIpLFxuICAgICAgY2F0ZWdvcnk6IFwiR3JhcGhcIixcbiAgICAgIGRlc2NyaXB0aW9uOiBcIlNlbGVjdCBhbGwgbm9kZXMgYW5kIGVkZ2VzXCIsXG4gICAgICBjYWxsYmFjazogKGV2ZW50KSA9PiB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmICghZGlzYWJsZWQyICYmIHR5cGUgIT09IFwic2luZ2xlXCIpIHtcbiAgICAgICAgICBjb25zdCBuZXh0ID0gbm9kZXMubWFwKChuKSA9PiBuLmlkKTtcbiAgICAgICAgICBvblNlbGVjdGlvbiA9PSBudWxsID8gdm9pZCAwIDogb25TZWxlY3Rpb24obmV4dCk7XG4gICAgICAgICAgc2V0SW50ZXJuYWxTZWxlY3Rpb25zKG5leHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiBcIkRlc2VsZWN0IFNlbGVjdGlvbnNcIixcbiAgICAgIGNhdGVnb3J5OiBcIkdyYXBoXCIsXG4gICAgICBkaXNhYmxlZDogIWhvdGtleXMuaW5jbHVkZXMoXCJkZXNlbGVjdFwiKSxcbiAgICAgIGRlc2NyaXB0aW9uOiBcIkRlc2VsZWN0IHNlbGVjdGVkIG5vZGVzIGFuZCBlZGdlc1wiLFxuICAgICAga2V5czogXCJlc2NhcGVcIixcbiAgICAgIGNhbGxiYWNrOiAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCFkaXNhYmxlZDIpIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIG9uU2VsZWN0aW9uID09IG51bGwgPyB2b2lkIDAgOiBvblNlbGVjdGlvbihbXSk7XG4gICAgICAgICAgc2V0SW50ZXJuYWxTZWxlY3Rpb25zKFtdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgXSk7XG4gIGNvbnN0IGpvaW5lZEFjdGl2ZXMgPSB1c2VNZW1vKFxuICAgICgpID0+IFsuLi5pbnRlcm5hbEFjdGl2ZXMsIC4uLmludGVybmFsSG92ZXJzXSxcbiAgICBbaW50ZXJuYWxBY3RpdmVzLCBpbnRlcm5hbEhvdmVyc11cbiAgKTtcbiAgcmV0dXJuIHtcbiAgICBhY3RpdmVzOiBqb2luZWRBY3RpdmVzLFxuICAgIG9uTm9kZUNsaWNrLFxuICAgIG9uTm9kZVBvaW50ZXJPdmVyLFxuICAgIG9uTm9kZVBvaW50ZXJPdXQsXG4gICAgb25MYXNzbyxcbiAgICBvbkxhc3NvRW5kLFxuICAgIHNlbGVjdE5vZGVQYXRocyxcbiAgICBvbkNhbnZhc0NsaWNrLFxuICAgIHNlbGVjdGlvbnM6IGludGVybmFsU2VsZWN0aW9ucyxcbiAgICBjbGVhclNlbGVjdGlvbnMsXG4gICAgYWRkU2VsZWN0aW9uLFxuICAgIHJlbW92ZVNlbGVjdGlvbixcbiAgICB0b2dnbGVTZWxlY3Rpb24sXG4gICAgc2V0U2VsZWN0aW9uczogc2V0SW50ZXJuYWxTZWxlY3Rpb25zXG4gIH07XG59O1xuY29uc3QgY2FudmFzID0gXCJfY2FudmFzXzY3MHpwXzFcIjtcbmNvbnN0IGNzcyQyID0ge1xuICBjYW52YXNcbn07XG5jb25zdCBHTF9ERUZBVUxUUyA9IHtcbiAgYWxwaGE6IHRydWUsXG4gIGFudGlhbGlhczogdHJ1ZVxufTtcbmNvbnN0IENBTUVSQV9ERUZBVUxUUyA9IHtcbiAgcG9zaXRpb246IFswLCAwLCAxZTNdLFxuICBuZWFyOiA1LFxuICBmYXI6IDVlNCxcbiAgZm92OiAxMFxufTtcbmNvbnN0IEdyYXBoQ2FudmFzID0gZm9yd2FyZFJlZihcbiAgKHtcbiAgICBjYW1lcmFNb2RlID0gXCJwYW5cIixcbiAgICBsYXlvdXRUeXBlID0gXCJmb3JjZURpcmVjdGVkMmRcIixcbiAgICBzaXppbmdUeXBlID0gXCJkZWZhdWx0XCIsXG4gICAgbGFiZWxUeXBlID0gXCJhdXRvXCIsXG4gICAgdGhlbWUgPSBsaWdodFRoZW1lLFxuICAgIGFuaW1hdGVkID0gdHJ1ZSxcbiAgICBkZWZhdWx0Tm9kZVNpemUgPSA3LFxuICAgIG1pbk5vZGVTaXplID0gNSxcbiAgICBtYXhOb2RlU2l6ZSA9IDE1LFxuICAgIGxhc3NvVHlwZSA9IFwibm9uZVwiLFxuICAgIGdsT3B0aW9ucyA9IHt9LFxuICAgIGVkZ2VzLFxuICAgIGNoaWxkcmVuLFxuICAgIG5vZGVzLFxuICAgIG1pbkRpc3RhbmNlLFxuICAgIG1heERpc3RhbmNlLFxuICAgIG9uQ2FudmFzQ2xpY2ssXG4gICAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgICBvbkxhc3NvLFxuICAgIG9uTGFzc29FbmQsXG4gICAgLi4ucmVzdFxuICB9LCByZWYpID0+IHtcbiAgICB2YXIgX2EyLCBfYjI7XG4gICAgY29uc3QgcmVuZGVyZXJSZWYgPSB1c2VSZWYobnVsbCk7XG4gICAgY29uc3QgY29udHJvbHNSZWYgPSB1c2VSZWYobnVsbCk7XG4gICAgY29uc3QgY2FudmFzUmVmID0gdXNlUmVmKG51bGwpO1xuICAgIHVzZUltcGVyYXRpdmVIYW5kbGUocmVmLCAoKSA9PiAoe1xuICAgICAgY2VudGVyR3JhcGg6IChub2RlSWRzLCBvcHRzKSA9PiB7XG4gICAgICAgIHZhciBfYTM7XG4gICAgICAgIHJldHVybiAoX2EzID0gcmVuZGVyZXJSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5jZW50ZXJHcmFwaChub2RlSWRzLCBvcHRzKTtcbiAgICAgIH0sXG4gICAgICBmaXROb2Rlc0luVmlldzogKG5vZGVJZHMsIG9wdHMpID0+IHtcbiAgICAgICAgdmFyIF9hMztcbiAgICAgICAgcmV0dXJuIChfYTMgPSByZW5kZXJlclJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EzLmZpdE5vZGVzSW5WaWV3KG5vZGVJZHMsIG9wdHMpO1xuICAgICAgfSxcbiAgICAgIHpvb21JbjogKCkgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IGNvbnRyb2xzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMuem9vbUluKCk7XG4gICAgICB9LFxuICAgICAgem9vbU91dDogKCkgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IGNvbnRyb2xzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMuem9vbU91dCgpO1xuICAgICAgfSxcbiAgICAgIGRvbGx5SW46IChkaXN0YW5jZSkgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IGNvbnRyb2xzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMuZG9sbHlJbihkaXN0YW5jZSk7XG4gICAgICB9LFxuICAgICAgZG9sbHlPdXQ6IChkaXN0YW5jZSkgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IGNvbnRyb2xzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMuZG9sbHlPdXQoZGlzdGFuY2UpO1xuICAgICAgfSxcbiAgICAgIHBhbkxlZnQ6ICgpID0+IHtcbiAgICAgICAgdmFyIF9hMztcbiAgICAgICAgcmV0dXJuIChfYTMgPSBjb250cm9sc1JlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EzLnBhbkxlZnQoKTtcbiAgICAgIH0sXG4gICAgICBwYW5SaWdodDogKCkgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IGNvbnRyb2xzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMucGFuUmlnaHQoKTtcbiAgICAgIH0sXG4gICAgICBwYW5Eb3duOiAoKSA9PiB7XG4gICAgICAgIHZhciBfYTM7XG4gICAgICAgIHJldHVybiAoX2EzID0gY29udHJvbHNSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5wYW5Eb3duKCk7XG4gICAgICB9LFxuICAgICAgcGFuVXA6ICgpID0+IHtcbiAgICAgICAgdmFyIF9hMztcbiAgICAgICAgcmV0dXJuIChfYTMgPSBjb250cm9sc1JlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EzLnBhblVwKCk7XG4gICAgICB9LFxuICAgICAgcmVzZXRDb250cm9sczogKGFuaW1hdGVkMikgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IGNvbnRyb2xzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMucmVzZXRDb250cm9scyhhbmltYXRlZDIpO1xuICAgICAgfSxcbiAgICAgIGdldENvbnRyb2xzOiAoKSA9PiB7XG4gICAgICAgIHZhciBfYTM7XG4gICAgICAgIHJldHVybiAoX2EzID0gY29udHJvbHNSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMy5jb250cm9scztcbiAgICAgIH0sXG4gICAgICBnZXRHcmFwaDogKCkgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IHJlbmRlcmVyUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMuZ3JhcGg7XG4gICAgICB9LFxuICAgICAgZXhwb3J0Q2FudmFzOiAoKSA9PiB7XG4gICAgICAgIHJlbmRlcmVyUmVmLmN1cnJlbnQucmVuZGVyU2NlbmUoKTtcbiAgICAgICAgcmV0dXJuIGNhbnZhc1JlZi5jdXJyZW50LnRvRGF0YVVSTCgpO1xuICAgICAgfSxcbiAgICAgIGZyZWV6ZTogKCkgPT4ge1xuICAgICAgICB2YXIgX2EzO1xuICAgICAgICByZXR1cm4gKF9hMyA9IGNvbnRyb2xzUmVmLmN1cnJlbnQpID09IG51bGwgPyB2b2lkIDAgOiBfYTMuZnJlZXplKCk7XG4gICAgICB9LFxuICAgICAgdW5GcmVlemU6ICgpID0+IHtcbiAgICAgICAgdmFyIF9hMztcbiAgICAgICAgcmV0dXJuIChfYTMgPSBjb250cm9sc1JlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EzLnVuRnJlZXplKCk7XG4gICAgICB9XG4gICAgfSkpO1xuICAgIGNvbnN0IHsgc2VsZWN0aW9ucywgYWN0aXZlcywgY29sbGFwc2VkTm9kZUlkcyB9ID0gcmVzdDtcbiAgICBjb25zdCBmaW5hbEFuaW1hdGVkID0gZWRnZXMubGVuZ3RoICsgbm9kZXMubGVuZ3RoID4gNDAwID8gZmFsc2UgOiBhbmltYXRlZDtcbiAgICBjb25zdCBnbCA9IHVzZU1lbW8oKCkgPT4gKHsgLi4uZ2xPcHRpb25zLCAuLi5HTF9ERUZBVUxUUyB9KSwgW2dsT3B0aW9uc10pO1xuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3MkMi5jYW52YXMsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgQ2FudmFzLFxuICAgICAge1xuICAgICAgICBsZWdhY3k6IHRydWUsXG4gICAgICAgIGxpbmVhcjogdHJ1ZSxcbiAgICAgICAgcmVmOiBjYW52YXNSZWYsXG4gICAgICAgIGZsYXQ6IHRydWUsXG4gICAgICAgIGdsLFxuICAgICAgICBjYW1lcmE6IENBTUVSQV9ERUZBVUxUUyxcbiAgICAgICAgb25Qb2ludGVyTWlzc2VkOiBvbkNhbnZhc0NsaWNrLFxuICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeHMoXG4gICAgICAgICAgUHJvdmlkZXIsXG4gICAgICAgICAge1xuICAgICAgICAgICAgY3JlYXRlU3RvcmU6ICgpID0+IGNyZWF0ZVN0b3JlKHtcbiAgICAgICAgICAgICAgc2VsZWN0aW9ucyxcbiAgICAgICAgICAgICAgYWN0aXZlcyxcbiAgICAgICAgICAgICAgdGhlbWUsXG4gICAgICAgICAgICAgIGNvbGxhcHNlZE5vZGVJZHNcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICAgICAgKChfYTIgPSB0aGVtZS5jYW52YXMpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuYmFja2dyb3VuZCkgJiYgLyogQF9fUFVSRV9fICovIGpzeChcImNvbG9yXCIsIHsgYXR0YWNoOiBcImJhY2tncm91bmRcIiwgYXJnczogW3RoZW1lLmNhbnZhcy5iYWNrZ3JvdW5kXSB9KSxcbiAgICAgICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcImFtYmllbnRMaWdodFwiLCB7IGludGVuc2l0eTogMSB9KSxcbiAgICAgICAgICAgICAgY2hpbGRyZW4sXG4gICAgICAgICAgICAgICgoX2IyID0gdGhlbWUuY2FudmFzKSA9PSBudWxsID8gdm9pZCAwIDogX2IyLmZvZykgJiYgLyogQF9fUFVSRV9fICovIGpzeChcImZvZ1wiLCB7IGF0dGFjaDogXCJmb2dcIiwgYXJnczogW3RoZW1lLmNhbnZhcy5mb2csIDRlMywgOWUzXSB9KSxcbiAgICAgICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgICAgICAgICBDYW1lcmFDb250cm9scyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBtb2RlOiBjYW1lcmFNb2RlLFxuICAgICAgICAgICAgICAgICAgcmVmOiBjb250cm9sc1JlZixcbiAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZDIsXG4gICAgICAgICAgICAgICAgICBtaW5EaXN0YW5jZSxcbiAgICAgICAgICAgICAgICAgIG1heERpc3RhbmNlLFxuICAgICAgICAgICAgICAgICAgYW5pbWF0ZWQsXG4gICAgICAgICAgICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgICAgICAgICAgICAgTGFzc28sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGxhc3NvVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICBvbkxhc3NvLFxuICAgICAgICAgICAgICAgICAgICAgIG9uTGFzc29FbmQsXG4gICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goU3VzcGVuc2UsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgICAgICAgICAgICAgICAgICBHcmFwaFNjZW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZWY6IHJlbmRlcmVyUmVmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogZGlzYWJsZWQyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlZDogZmluYWxBbmltYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzaXppbmdUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHROb2RlU2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbWluTm9kZVNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG1heE5vZGVTaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5yZXN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgKSB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICBdXG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICB9XG4gICAgKSB9KTtcbiAgfVxuKTtcbmNvbnN0IGNvbnRhaW5lciQxID0gXCJfY29udGFpbmVyXzE1NWw3XzFcIjtcbmNvbnN0IGRpc2FibGVkID0gXCJfZGlzYWJsZWRfMTU1bDdfN1wiO1xuY29uc3QgY29udGVudENvbnRhaW5lciA9IFwiX2NvbnRlbnRDb250YWluZXJfMTU1bDdfMTBcIjtcbmNvbnN0IGNvbnRlbnRJbm5lciA9IFwiX2NvbnRlbnRJbm5lcl8xNTVsN18zNVwiO1xuY29uc3QgY29udGVudCA9IFwiX2NvbnRlbnRfMTU1bDdfMTBcIjtcbmNvbnN0IGNzcyQxID0ge1xuICBjb250YWluZXI6IGNvbnRhaW5lciQxLFxuICBkaXNhYmxlZCxcbiAgY29udGVudENvbnRhaW5lcixcbiAgY29udGVudElubmVyLFxuICBjb250ZW50XG59O1xuY29uc3QgUmFkaWFsU2xpY2UgPSAoe1xuICBsYWJlbCxcbiAgY2VudHJhbEFuZ2xlLFxuICBzdGFydEFuZ2xlLFxuICBlbmRBbmdsZSxcbiAgcG9sYXIsXG4gIHJhZGl1cyxcbiAgY2xhc3NOYW1lLFxuICBpY29uLFxuICBpbm5lclJhZGl1cyxcbiAgc2tldyxcbiAgZGlzYWJsZWQ6IGRpc2FibGVkMixcbiAgb25DbGlja1xufSkgPT4gLyogQF9fUFVSRV9fICovIGpzeChcbiAgXCJkaXZcIixcbiAge1xuICAgIHJvbGU6IFwibWVudWl0ZW1cIixcbiAgICBjbGFzc05hbWU6IGNsYXNzTmFtZXMoY3NzJDEuY29udGFpbmVyLCBjbGFzc05hbWUsIHtcbiAgICAgIFtjc3MkMS5kaXNhYmxlZF06IGRpc2FibGVkMlxuICAgIH0pLFxuICAgIHN0eWxlOiB7XG4gICAgICB3aWR0aDogY2VudHJhbEFuZ2xlID4gOTAgPyBcIjEwMCVcIiA6IFwiNTAlXCIsXG4gICAgICBoZWlnaHQ6IGNlbnRyYWxBbmdsZSA+IDkwID8gXCIxMDAlXCIgOiBcIjUwJVwiLFxuICAgICAgYm90dG9tOiBjZW50cmFsQW5nbGUgPiA5MCA/IFwiNTAlXCIgOiBcImluaXRpYWxcIixcbiAgICAgIHJpZ2h0OiBjZW50cmFsQW5nbGUgPiA5MCA/IFwiNTAlXCIgOiBcImluaXRpYWxcIixcbiAgICAgIHRyYW5zZm9ybTogYHJvdGF0ZSgke3N0YXJ0QW5nbGUgKyBlbmRBbmdsZX1kZWcpIHNrZXcoJHtza2V3fWRlZylgXG4gICAgfSxcbiAgICBvbkNsaWNrOiAoZXZlbnQpID0+IHtcbiAgICAgIGlmICghZGlzYWJsZWQyKSB7XG4gICAgICAgIG9uQ2xpY2soZXZlbnQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICBcImRpdlwiLFxuICAgICAge1xuICAgICAgICBjbGFzc05hbWU6IGNzcyQxLmNvbnRlbnRDb250YWluZXIsXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgdHJhbnNmb3JtOiBgc2tldygkey1za2V3fWRlZykgcm90YXRlKCR7KHBvbGFyID8gOTAgOiBjZW50cmFsQW5nbGUpIC8gMiAtIDkwfWRlZylgXG4gICAgICAgIH0sXG4gICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiBjc3MkMS5jb250ZW50SW5uZXIsXG4gICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICB0b3A6IGBjYWxjKCgoKCR7Y2VudHJhbEFuZ2xlID4gOTAgPyBcIjUwJSArIFwiIDogXCJcIn0ke3JhZGl1c31weCkgLSAke2lubmVyUmFkaXVzfXB4KSAvIDIpIC0gNGVtKWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeHMoXG4gICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGNzcyQxLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogYHJvdGF0ZSgkey1lbmRBbmdsZX1kZWcpYFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGl0bGU6IGxhYmVsLFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAgICAgICBpY29uLFxuICAgICAgICAgICAgICAgICAgbGFiZWxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICApXG4gIH1cbik7XG5mdW5jdGlvbiBjYWxjdWxhdGVSYWRpdXMoaXRlbXMsIHN0YXJ0T2Zmc2V0QW5nbGUpIHtcbiAgY29uc3QgY2VudHJhbEFuZ2xlID0gMzYwIC8gaXRlbXMubGVuZ3RoIHx8IDM2MDtcbiAgY29uc3QgcG9sYXIgPSBjZW50cmFsQW5nbGUgJSAxODAgPT09IDA7XG4gIGNvbnN0IGRlbHRhQW5nbGUgPSA5MCAtIGNlbnRyYWxBbmdsZTtcbiAgY29uc3Qgc3RhcnRBbmdsZSA9IHBvbGFyID8gNDUgOiBzdGFydE9mZnNldEFuZ2xlICsgZGVsdGFBbmdsZSArIGNlbnRyYWxBbmdsZSAvIDI7XG4gIHJldHVybiB7IGNlbnRyYWxBbmdsZSwgcG9sYXIsIHN0YXJ0QW5nbGUsIGRlbHRhQW5nbGUgfTtcbn1cbmNvbnN0IGNvbnRhaW5lciA9IFwiX2NvbnRhaW5lcl94OWh5eF8xXCI7XG5jb25zdCBjc3MgPSB7XG4gIGNvbnRhaW5lclxufTtcbmNvbnN0IFJhZGlhbE1lbnUgPSAoe1xuICBpdGVtcyxcbiAgcmFkaXVzID0gMTc1LFxuICBjbGFzc05hbWUsXG4gIGlubmVyUmFkaXVzID0gMjUsXG4gIHN0YXJ0T2Zmc2V0QW5nbGUgPSAwLFxuICBvbkNsb3NlXG59KSA9PiB7XG4gIGNvbnN0IHsgY2VudHJhbEFuZ2xlLCBwb2xhciwgc3RhcnRBbmdsZSwgZGVsdGFBbmdsZSB9ID0gdXNlTWVtbyhcbiAgICAoKSA9PiBjYWxjdWxhdGVSYWRpdXMoaXRlbXMsIHN0YXJ0T2Zmc2V0QW5nbGUpLFxuICAgIFtpdGVtcywgc3RhcnRPZmZzZXRBbmdsZV1cbiAgKTtcbiAgY29uc3QgdGltZW91dCA9IHVzZVJlZihudWxsKTtcbiAgdXNlTGF5b3V0RWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCB0aW1lciA9IHRpbWVvdXQuY3VycmVudDtcbiAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgfSwgW10pO1xuICBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgXCJkaXZcIixcbiAgICB7XG4gICAgICByb2xlOiBcIm1lbnVcIixcbiAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lcyhjc3MuY29udGFpbmVyLCBjbGFzc05hbWUpLFxuICAgICAgb25Qb2ludGVyRW50ZXI6ICgpID0+IGNsZWFyVGltZW91dCh0aW1lb3V0LmN1cnJlbnQpLFxuICAgICAgb25Qb2ludGVyTGVhdmU6IChldmVudCkgPT4ge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dC5jdXJyZW50KTtcbiAgICAgICAgdGltZW91dC5jdXJyZW50ID0gc2V0VGltZW91dCgoKSA9PiBvbkNsb3NlID09IG51bGwgPyB2b2lkIDAgOiBvbkNsb3NlKGV2ZW50KSwgNTAwKTtcbiAgICAgIH0sXG4gICAgICBjaGlsZHJlbjogaXRlbXMubWFwKChzbGljZSwgaW5kZXgpID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgIFJhZGlhbFNsaWNlLFxuICAgICAgICB7XG4gICAgICAgICAgLi4uc2xpY2UsXG4gICAgICAgICAgcmFkaXVzLFxuICAgICAgICAgIGlubmVyUmFkaXVzLFxuICAgICAgICAgIHN0YXJ0QW5nbGUsXG4gICAgICAgICAgZW5kQW5nbGU6IGNlbnRyYWxBbmdsZSAqIGluZGV4LFxuICAgICAgICAgIHNrZXc6IHBvbGFyID8gMCA6IGRlbHRhQW5nbGUsXG4gICAgICAgICAgcG9sYXIsXG4gICAgICAgICAgY2VudHJhbEFuZ2xlLFxuICAgICAgICAgIG9uQ2xpY2s6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgc2xpY2UgPT0gbnVsbCA/IHZvaWQgMCA6IHNsaWNlLm9uQ2xpY2soZXZlbnQpO1xuICAgICAgICAgICAgb25DbG9zZSA9PSBudWxsID8gdm9pZCAwIDogb25DbG9zZShldmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbmRleFxuICAgICAgKSlcbiAgICB9XG4gICk7XG59O1xuZXhwb3J0IHtcbiAgQXJyb3csXG4gIENhbWVyYUNvbnRyb2xzLFxuICBDYW1lcmFDb250cm9sc0NvbnRleHQsXG4gIENsdXN0ZXIsXG4gIEVkZ2UkMSBhcyBFZGdlLFxuICBFZGdlcyxcbiAgRk9SQ0VfTEFZT1VUUyxcbiAgR3JhcGhDYW52YXMsXG4gIEdyYXBoU2NlbmUsXG4gIEljb24sXG4gIExhYmVsLFxuICBMYXNzbyxcbiAgTGluZSxcbiAgTm9kZSxcbiAgUmFkaWFsTWVudSxcbiAgUmFkaWFsU2xpY2UsXG4gIFJpbmckMSBhcyBSaW5nLFxuICBTcGhlcmUsXG4gIFNwaGVyZVdpdGhJY29uLFxuICBTcGhlcmVXaXRoU3ZnLFxuICBTdmcsXG4gIGFuaW1hdGlvbkNvbmZpZyxcbiAgYXR0cmlidXRlU2l6aW5nLFxuICBidWlsZENsdXN0ZXJHcm91cHMsXG4gIGJ1aWxkR3JhcGgsXG4gIGJ1aWxkTm9kZUVkZ2VzLFxuICBjYWxjTGFiZWxWaXNpYmlsaXR5LFxuICBjYWxjdWxhdGVDbHVzdGVycyxcbiAgY2FsY3VsYXRlRWRnZUN1cnZlT2Zmc2V0LFxuICBjZW50cmFsaXR5U2l6aW5nLFxuICBjaXJjdWxhcjJkLFxuICBjcmVhdGVFbGVtZW50LFxuICBjdXN0b20sXG4gIGRhcmtUaGVtZSxcbiAgZmluZFBhdGgsXG4gIGZvcmNlQXRsYXMyLFxuICBmb3JjZURpcmVjdGVkLFxuICBmb3JjZVJhZGlhbCxcbiAgZ2V0QWRqYWNlbnRzLFxuICBnZXRBcnJvd1NpemUsXG4gIGdldEFycm93VmVjdG9ycyxcbiAgZ2V0Q2xvc2VzdEF4aXMsXG4gIGdldEN1cnZlLFxuICBnZXRDdXJ2ZVBvaW50cyxcbiAgZ2V0RGVncmVlc1RvQ2xvc2VzdDJkQXhpcyxcbiAgZ2V0RXhwYW5kUGF0aCxcbiAgZ2V0TGFiZWxPZmZzZXRCeVR5cGUsXG4gIGdldExheW91dENlbnRlcixcbiAgZ2V0TWlkUG9pbnQsXG4gIGdldE5vZGVEZXB0aCxcbiAgZ2V0VmVjdG9yLFxuICBnZXRWaXNpYmxlRW50aXRpZXMsXG4gIGlzTm9kZUluVmlldyxcbiAgbGF5b3V0UHJvdmlkZXIsXG4gIGxpZ2h0VGhlbWUsXG4gIG5vZGVTaXplUHJvdmlkZXIsXG4gIG5vb3ZlcmxhcCxcbiAgcGFnZVJhbmtTaXppbmcsXG4gIHByZXBhcmVSYXksXG4gIHJlY29tbWVuZExheW91dCxcbiAgdGljayxcbiAgdHJhbnNmb3JtR3JhcGgsXG4gIHVwZGF0ZU5vZGVQb3NpdGlvbixcbiAgdXNlQ2FtZXJhQ29udHJvbHMsXG4gIHVzZUNlbnRlckdyYXBoLFxuICB1c2VDb2xsYXBzZSxcbiAgdXNlRHJhZyxcbiAgdXNlR3JhcGgsXG4gIHVzZUhvdmVySW50ZW50LFxuICB1c2VTZWxlY3Rpb25cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/reagraph/dist/index.js\n");

/***/ })

};
;